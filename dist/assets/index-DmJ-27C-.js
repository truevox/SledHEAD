var L=Object.defineProperty;var O=(f,a,t)=>a in f?L(f,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[a]=t;var o=(f,a,t)=>O(f,typeof a!="symbol"?a+"":a,t);import{P as d}from"./phaser-0RJB29YE.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();class G{static generatePlayerSprite(a,t){const e=a.add.graphics();e.fillStyle(3447003,1),e.fillCircle(8,4,3),e.fillStyle(2899536,1),e.fillRect(6,7,4,4),e.fillStyle(15158332,1),e.fillRect(4,11,8,2),e.fillStyle(12597547,1),e.fillRect(3,12,10,1),e.generateTexture(t,16,16),e.destroy()}static generateTrickFrames(a){for(let t=0;t<48;t++){const e=a.add.graphics(),i=t*7.5*Math.PI/180;e.fillStyle(3447003,1),e.fillCircle(8,4,3),e.fillStyle(2899536,1),e.fillRect(6,7,4,4),e.fillStyle(15158332,1);const s=Math.sin(i)*2;e.fillRect(4,11+s,8,2),e.generateTexture(`trick_frame_${t}`,16,16),e.destroy()}}static generateTerrainTiles(a){for(let r=0;r<10;r++){const n=a.add.graphics(),h=.7+r*.03,l=d.Display.Color.HSVToRGB(.6,.05,h);n.fillStyle(l.color,1),n.fillRect(0,0,32,32);for(let c=0;c<15;c++){const u=Math.random()*32,p=Math.random()*32,m=d.Display.Color.HSVToRGB(.6,.02,h+.1);n.fillStyle(m.color,.5),n.fillCircle(u,p,1)}n.generateTexture(`snow_${r}`,32,32),n.destroy()}const t=a.add.graphics(),e=d.Display.Color.HSVToRGB(.55,.3,.9);t.fillStyle(e.color,.8),t.fillRect(0,0,32,32),t.fillStyle(16777215,.3),t.fillRect(8,8,16,4),t.generateTexture("ice",32,32),t.destroy();const i=a.add.graphics();i.fillStyle(5921370,1),i.fillRect(0,0,32,32),i.fillStyle(3815994,1),i.fillCircle(8,8,6),i.fillCircle(24,20,8),i.generateTexture("rock",32,32),i.destroy();const s=a.add.graphics();s.fillStyle(15267064,1),s.fillTriangle(0,32,32,32,32,0),s.fillStyle(13691120,1),s.fillTriangle(0,32,16,16,32,32),s.generateTexture("ramp",32,32),s.destroy()}static generateTrees(a){for(let t=0;t<3;t++){const e=a.add.graphics();e.fillStyle(6114871,1),e.fillRect(14,24,4,16),e.fillStyle(2969622,1);const i=3+t;for(let s=0;s<i;s++){const r=24-s*6,n=20-s*3;e.fillTriangle(16-n/2,r,16+n/2,r,16,r-10)}e.generateTexture(`tree_${t}`,32,40),e.destroy()}}static generateAnimals(a){const t=a.add.graphics();t.fillStyle(4863784,1),t.fillEllipse(16,12,16,12),t.fillCircle(10,8,5),t.fillCircle(8,6,2),t.fillCircle(12,6,2),t.fillStyle(2891282,1),t.fillCircle(9,8,1),t.generateTexture("animal_bear",32,24),t.destroy();const e=a.add.graphics();e.fillStyle(3447003,1),e.fillCircle(8,6,4),e.fillCircle(6,5,2),e.fillStyle(2719929,1),e.fillTriangle(10,6,14,4,14,8),e.fillTriangle(0,5,4,3,4,7),e.generateTexture("animal_bird",16,12),e.destroy();const i=a.add.graphics();i.fillStyle(13936490,1),i.fillEllipse(16,10,14,10),i.fillCircle(10,8,4),i.fillTriangle(9,5,8,3,10,5),i.fillTriangle(11,5,12,3,10,5),i.fillStyle(9137991,1),i.fillRect(18,12,8,2),i.generateTexture("animal_mountainlion",28,16),i.destroy();const s=a.add.graphics();s.fillStyle(9139029,1),s.fillEllipse(16,14,12,10),s.fillCircle(10,10,4),s.fillStyle(6636321,1),s.strokeRect(8,4,1,4),s.strokeRect(12,4,1,4),s.generateTexture("animal_deer",32,20),s.destroy();const r=a.add.graphics();r.fillStyle(16739125,1),r.fillEllipse(12,10,10,8),r.fillCircle(8,8,3),r.fillTriangle(7,6,6,3,8,6),r.fillTriangle(9,6,10,3,8,6),r.fillStyle(16777215,1),r.fillCircle(8,9,1.5),r.generateTexture("animal_fox",24,16),r.destroy()}static generateUIElements(a){const t=a.add.graphics();t.fillStyle(2899536,1),t.fillRoundedRect(0,0,200,20,5),t.lineStyle(2,3426654,1),t.strokeRoundedRect(0,0,200,20,5),t.generateTexture("ui_stamina_bg",200,20),t.destroy();const e=a.add.graphics();e.fillStyle(2600544,1),e.fillRoundedRect(0,0,200,20,5),e.generateTexture("ui_stamina_fill",200,20),e.destroy();const i=a.add.graphics();i.lineStyle(2,16776960,1),i.strokeCircle(50,50,40),i.strokeRect(48,0,4,100),i.strokeRect(0,48,100,4),i.lineStyle(3,16711680,.5),i.strokeRect(0,50,100,1),i.generateTexture("ui_camera_reticle",100,100),i.destroy()}static generateNPCs(a){const t=a.add.graphics();t.fillStyle(9807270,1),t.fillCircle(16,8,5),t.fillStyle(16503973,1),t.fillCircle(16,10,4),t.fillStyle(9127187,1),t.fillRect(12,14,8,12),t.fillStyle(2899536,1),t.fillRect(12,26,3,6),t.fillRect(17,26,3,6),t.generateTexture("npc_grandpa",32,32),t.destroy();const e=a.add.graphics();e.fillStyle(6636321,1),e.fillCircle(16,8,5),e.fillStyle(16503973,1),e.fillCircle(16,10,4),e.fillStyle(15158332,1),e.fillRect(12,14,8,12),e.fillStyle(3426654,1),e.fillRect(12,26,3,6),e.fillRect(17,26,3,6),e.generateTexture("npc_jake",32,32),e.destroy();const i=a.add.graphics();i.fillStyle(2899536,1),i.fillCircle(16,8,5),i.fillStyle(16503973,1),i.fillCircle(16,10,4),i.fillStyle(9807270,1),i.fillRect(12,14,8,12),i.fillStyle(8359053,1),i.fillRect(12,26,3,6),i.fillRect(17,26,3,6),i.generateTexture("npc_steve",32,32),i.destroy()}static generateAllAssets(a){this.generatePlayerSprite(a,"player"),this.generateTrickFrames(a),this.generateTerrainTiles(a),this.generateTrees(a),this.generateAnimals(a),this.generateUIElements(a),this.generateNPCs(a)}}class F extends d.Scene{constructor(){super({key:"BootScene"})}preload(){const a=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,"Generating Assets...",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5),t=this.add.graphics(),e=this.add.graphics();e.fillStyle(2236962,.8),e.fillRect(240,370,800,50),this.load.on("progress",i=>{t.clear(),t.fillStyle(3447003,1),t.fillRect(250,380,780*i,30),a.setText(`Generating Assets... ${Math.floor(i*100)}%`)}),this.load.on("complete",()=>{t.destroy(),e.destroy(),a.destroy()})}create(){G.generateAllAssets(this),this.cameras.main.fadeIn(1e3,0,0,0);const a=this.add.text(this.cameras.main.width/2,200,"SledHEAD",{fontSize:"96px",color:"#ffffff",fontStyle:"bold",stroke:"#2c3e50",strokeThickness:8}).setOrigin(.5);this.tweens.add({targets:a,scale:{from:1,to:1.05},duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.time.delayedCall(2e3,()=>{this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})})}}const k=class k{constructor(){o(this,"state");this.state=this.getDefaultState(),this.loadState()}static getInstance(){return k.instance||(k.instance=new k),k.instance}getDefaultState(){return{money:200,loan:1e5,stamina:100,maxStamina:100,playerPosition:{x:640,y:600,layer:0},mountainSeed:this.generateSeed(),currentDay:1,upgrades:this.getDefaultUpgrades(),stats:this.getDefaultStats(),newGamePlus:this.getDefaultNewGamePlus()}}getDefaultUpgrades(){return{personal:{rocketSurgery:0,optimalOptics:0,sledDurability:0,fancierFootwear:0,attendLegDay:0,crowdHypeman:0,crowdWeaver:0,weatherWarrior:0},mountain:{skiLifts:0,snowmobileRentals:0,foodStalls:0,groomedTrails:0,firstAidStations:0,scenicOverlooks:0}}}getDefaultStats(){return{totalRuns:0,totalTricks:0,totalPhotos:0,bestTime:0,highestAltitude:0,totalCollisions:0}}getDefaultNewGamePlus(){return{active:!1,bonuses:{speed:0,trickery:0,resilience:0,climb:0,charisma:0,rhythm:0}}}generateSeed(){return Math.random().toString(36).substring(2,15)}getState(){return{...this.state}}setState(a){this.state={...this.state,...a},this.saveState()}getMoney(){return this.state.money}addMoney(a){this.state.money+=a,this.saveState()}spendMoney(a){return this.state.money>=a?(this.state.money-=a,this.saveState(),!0):!1}getLoan(){return this.state.loan}payLoan(a){this.state.loan=Math.max(0,this.state.loan-a),this.saveState()}getStamina(){return this.state.stamina}setStamina(a){this.state.stamina=Math.max(0,Math.min(this.state.maxStamina,a)),this.saveState()}drainStamina(a){this.setStamina(this.state.stamina-a)}restoreStamina(a){this.setStamina(this.state.stamina+a)}getUpgrade(a,t){return this.state.upgrades[a][t]||0}upgradeItem(a,t){const e=this.state.upgrades[a][t]||0;this.state.upgrades[a][t]=Math.min(5,e+1),this.saveState()}incrementStat(a,t=1){this.state.stats[a]+=t,this.saveState()}getStats(){return{...this.state.stats}}newGame(a){const t=this.state.newGamePlus.bonuses;this.state=this.getDefaultState(),a&&(this.state.mountainSeed=a),Object.values(t).some(e=>e>0)&&(this.state.newGamePlus.active=!0,this.state.newGamePlus.bonuses=t),this.saveState()}startNewGamePlus(a){const t=this.state.newGamePlus.bonuses;t[a]+=.1,this.newGame()}saveState(){try{localStorage.setItem("sledhead_save",JSON.stringify(this.state))}catch(a){console.error("Failed to save game state:",a)}}loadState(){try{const a=localStorage.getItem("sledhead_save");if(a){const t=JSON.parse(a);this.state={...this.getDefaultState(),...t}}}catch(a){console.error("Failed to load game state:",a)}}resetState(){this.state=this.getDefaultState(),this.saveState()}};o(k,"instance");let w=k;class v extends d.Scene{constructor(){super({key:"MenuScene"});o(this,"gameStateManager");o(this,"seedInputText","");o(this,"seedInputBox");o(this,"isInputActive",!1);this.gameStateManager=w.getInstance()}create(){var y;const{width:t,height:e}=this.cameras.main,i=this.gameStateManager.getState();this.cameras.main.fadeIn(500,0,0,0);const s=this.add.graphics();s.fillGradientStyle(1981023,1981023,858922,858922,1),s.fillRect(0,0,t,e);const r=this.add.text(t/2,100,"SledHEAD",{fontSize:"84px",color:"#ffffff",fontStyle:"bold",stroke:"#2c3e50",strokeThickness:8}).setOrigin(.5);this.add.text(t/2,180,"Mountain Sledding Management",{fontSize:"24px",color:"#ecf0f1"}).setOrigin(.5),this.tweens.add({targets:r,scale:{from:1,to:1.03},duration:2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"});const n=this.add.graphics();n.fillStyle(3426654,.9),n.fillRoundedRect(t/2-250,240,500,100,10),n.lineStyle(3,3447003,1),n.strokeRoundedRect(t/2-250,240,500,100,10),this.add.text(t/2,260,"Current Mountain Seed:",{fontSize:"18px",color:"#bdc3c7"}).setOrigin(.5);const h=this.add.text(t/2,295,i.mountainSeed,{fontSize:"24px",color:"#3498db",fontStyle:"bold"}).setOrigin(.5),l=this.add.graphics();l.fillStyle(2899536,.9),l.fillRoundedRect(t/2-200,360,400,50,8),l.lineStyle(2,9807270,1),l.strokeRoundedRect(t/2-200,360,400,50,8),this.add.text(t/2-180,365,"Custom Seed:",{fontSize:"16px",color:"#95a5a6"}),this.seedInputBox=this.add.text(t/2-180,385,"",{fontSize:"18px",color:"#ecf0f1"});const c=this.add.text(t/2,420,"Click here to enter custom seed, then press Enter",{fontSize:"14px",color:"#7f8c8d",fontStyle:"italic"}).setOrigin(.5),u=this.add.zone(t/2-200,360,400,50).setOrigin(0,0);u.setInteractive({useHandCursor:!0}),u.on("pointerdown",()=>{this.isInputActive=!0,l.clear(),l.fillStyle(2899536,.9),l.fillRoundedRect(t/2-200,360,400,50,8),l.lineStyle(3,3447003,1),l.strokeRoundedRect(t/2-200,360,400,50,8),c.setColor("#3498db")}),(y=this.input.keyboard)==null||y.on("keydown",g=>{var b,R,M;this.isInputActive&&(g.key==="Enter"?(this.seedInputText.trim()&&(this.gameStateManager.setState({mountainSeed:this.seedInputText.trim()}),h.setText(this.seedInputText.trim()),this.seedInputText="",(b=this.seedInputBox)==null||b.setText("")),this.isInputActive=!1,l.clear(),l.fillStyle(2899536,.9),l.fillRoundedRect(t/2-200,360,400,50,8),l.lineStyle(2,9807270,1),l.strokeRoundedRect(t/2-200,360,400,50,8),c.setColor("#7f8c8d")):g.key==="Backspace"?(this.seedInputText=this.seedInputText.slice(0,-1),(R=this.seedInputBox)==null||R.setText(this.seedInputText)):g.key.length===1&&this.seedInputText.length<20&&(this.seedInputText+=g.key,(M=this.seedInputBox)==null||M.setText(this.seedInputText)))});const p=490,m=70,S=i.stats.totalRuns>0;this.createMenuButton(t/2,p,"New Game",2600544,()=>this.startNewGame()),S&&this.createMenuButton(t/2,p+m,"Continue",2719929,()=>this.continueGame()),this.createMenuButton(t/2,p+(S?m*2:m),"Tutorial",9323693,()=>this.startTutorial()),this.createMenuButton(t/2,p+(S?m*3:m*2),"Settings",9807270,()=>this.openSettings()),this.add.text(t/2,e-30,"v1.0.0 | Made with Phaser 3",{fontSize:"14px",color:"#7f8c8d"}).setOrigin(.5)}createMenuButton(t,e,i,s,r){const l=this.add.graphics();l.fillStyle(s,1),l.fillRoundedRect(t-300/2,e-50/2,300,50,8);const c=this.add.text(t,e,i,{fontSize:"22px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),u=this.add.zone(t,e,300,50);u.setInteractive({useHandCursor:!0}),u.on("pointerover",()=>{l.clear(),l.fillStyle(s,.8),l.fillRoundedRect(t-300/2,e-50/2,300,50,8),l.lineStyle(3,16777215,.5),l.strokeRoundedRect(t-300/2,e-50/2,300,50,8),c.setScale(1.05)}),u.on("pointerout",()=>{l.clear(),l.fillStyle(s,1),l.fillRoundedRect(t-300/2,e-50/2,300,50,8),c.setScale(1)}),u.on("pointerdown",()=>{c.setScale(.95)}),u.on("pointerup",()=>{c.setScale(1.05),r()})}startNewGame(){this.cameras.main.fadeOut(300,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("TutorialScene")})}continueGame(){this.cameras.main.fadeOut(300,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("UphillScene")})}startTutorial(){this.cameras.main.fadeOut(300,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("TutorialScene")})}openSettings(){console.log("Settings not yet implemented")}}class B extends d.Scene{constructor(){super({key:"TutorialScene"});o(this,"player");o(this,"grandpa");o(this,"cursors");o(this,"wasdKeys");o(this,"spaceKey");o(this,"isSleddingMode",!1);o(this,"playerSpeed",150);o(this,"sledSpeed",0);o(this,"completedRuns",0);o(this,"tutorialStep",0);o(this,"dialogueBox");o(this,"dialogueText");o(this,"dialogueVisible",!1);o(this,"hillTop",100);o(this,"hillBottom",500);o(this,"hillCenterX",400);o(this,"SUNSET_COLORS",{coral:16739179,yellow:16767293,blue:9809856})}create(){this.physics.world.setBounds(0,0,800,600),this.createSunsetBackground(),this.createHillTerrain(),this.player=this.physics.add.sprite(this.hillCenterX,this.hillBottom,"player"),this.player.setCollideWorldBounds(!0),this.player.setScale(2),this.grandpa=this.physics.add.sprite(this.hillCenterX-80,this.hillBottom,"npc_grandpa"),this.grandpa.setScale(2),this.cameras.main.setBounds(0,0,800,600),this.cameras.main.startFollow(this.player,!0,.1,.1),this.cursors=this.input.keyboard.createCursorKeys(),this.wasdKeys=this.input.keyboard.addKeys({W:d.Input.Keyboard.KeyCodes.W,A:d.Input.Keyboard.KeyCodes.A,S:d.Input.Keyboard.KeyCodes.S,D:d.Input.Keyboard.KeyCodes.D}),this.spaceKey=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.SPACE),this.createDialogueBox(),this.cameras.main.fadeIn(1e3,0,0,0),this.time.delayedCall(1e3,()=>{this.showDialogue("Welcome, kiddo! Let's teach you how to sled."),this.tutorialStep=1}),this.addDecorativeTrees()}update(){this.isSleddingMode?this.updateSleddingMode():this.updateWalkingMode(),this.checkTutorialProgress()}createSunsetBackground(){const t=this.add.graphics();for(let e=0;e<600;e++){const i=e/600;if(i<.3){const s=i/.3,r=d.Display.Color.Interpolate.ColorWithColor(d.Display.Color.IntegerToColor(this.SUNSET_COLORS.blue),d.Display.Color.IntegerToColor(this.SUNSET_COLORS.coral),100,s*100);t.fillStyle(r.color,1)}else if(i<.6){const s=(i-.3)/.3,r=d.Display.Color.Interpolate.ColorWithColor(d.Display.Color.IntegerToColor(this.SUNSET_COLORS.coral),d.Display.Color.IntegerToColor(this.SUNSET_COLORS.yellow),100,s*100);t.fillStyle(r.color,1)}else{const s=(i-.6)/.4,r=d.Display.Color.IntegerToColor(this.SUNSET_COLORS.yellow),n=d.Display.Color.IntegerToColor(16777215),h=d.Display.Color.Interpolate.ColorWithColor(r,n,100,s*100);t.fillStyle(h.color,1)}t.fillRect(0,e,800,1)}}createHillTerrain(){const t=this.add.graphics(),e=[];for(let i=0;i<=800;i+=10){const s=Math.abs(i-this.hillCenterX),r=Math.pow(1-s/400,2)*300,n=this.hillBottom-r;e.push(new d.Math.Vector2(i,n))}for(let i=0;i<e.length-1;i++){const s=e[i],r=e[i+1],h=.7+(1-(s.y-this.hillTop)/(this.hillBottom-this.hillTop))*.3,l=d.Display.Color.HSVToRGB(.6,.1,h);t.fillStyle(l.color,1),t.fillTriangle(s.x,s.y,r.x,r.y,r.x,600),t.fillTriangle(s.x,s.y,s.x,600,r.x,600)}for(let i=0;i<100;i++){const s=Math.random()*800,r=Math.abs(s-this.hillCenterX),n=Math.pow(1-r/400,2)*300,h=this.hillBottom-n,l=h+Math.random()*(600-h);t.fillStyle(16777215,.6+Math.random()*.4),t.fillCircle(s,l,1+Math.random()*2)}}addDecorativeTrees(){[{x:100,y:400},{x:150,y:450},{x:650,y:400},{x:700,y:450},{x:50,y:500},{x:750,y:500}].forEach(e=>{const i=Math.floor(Math.random()*3),s=this.add.sprite(e.x,e.y,`tree_${i}`);s.setScale(1.5),s.setAlpha(.7)})}createDialogueBox(){this.dialogueBox=this.add.container(400,550);const r=this.add.graphics();r.fillStyle(2899536,.9),r.fillRoundedRect(-600/2,-100/2,600,100,10),r.lineStyle(3,16777215,1),r.strokeRoundedRect(-600/2,-100/2,600,100,10);const n=this.add.text(-600/2+20,-100/2+10,"Grandpa:",{fontSize:"18px",color:"#ffd93d",fontStyle:"bold"});this.dialogueText=this.add.text(-600/2+20,-100/2+35,"",{fontSize:"16px",color:"#ffffff",wordWrap:{width:560}}),this.dialogueBox.add([r,n,this.dialogueText]),this.dialogueBox.setVisible(!1),this.dialogueBox.setDepth(100)}showDialogue(t){this.dialogueText.setText(t),this.dialogueBox.setVisible(!0),this.dialogueVisible=!0,this.time.delayedCall(5e3,()=>{this.hideDialogue()})}hideDialogue(){this.dialogueBox.setVisible(!1),this.dialogueVisible=!1}updateWalkingMode(){let t=0,e=0;this.wasdKeys.W.isDown||this.cursors.up.isDown?e=-this.playerSpeed:(this.wasdKeys.S.isDown||this.cursors.down.isDown)&&(e=this.playerSpeed),this.wasdKeys.A.isDown||this.cursors.left.isDown?t=-this.playerSpeed:(this.wasdKeys.D.isDown||this.cursors.right.isDown)&&(t=this.playerSpeed),t!==0&&e!==0&&(t*=.707,e*=.707),this.player.setVelocity(t,e),d.Input.Keyboard.JustDown(this.spaceKey)&&this.isNearTop()&&this.startSleddingMode()}updateSleddingMode(){this.sledSpeed+=2,this.sledSpeed=Math.min(this.sledSpeed,400);let t=0;this.wasdKeys.A.isDown||this.cursors.left.isDown?t=-200:(this.wasdKeys.D.isDown||this.cursors.right.isDown)&&(t=200),this.player.setVelocity(t,this.sledSpeed),this.player.setAngle(15),this.player.y>=this.hillBottom-20&&this.endSleddingMode()}startSleddingMode(){this.isSleddingMode=!0,this.sledSpeed=50,this.showDialogue("Great! Now steer with A and D!")}endSleddingMode(){this.isSleddingMode=!1,this.sledSpeed=0,this.player.setVelocity(0,0),this.player.setAngle(0),this.completedRuns++,this.completedRuns===1?this.time.delayedCall(1e3,()=>{this.showDialogue("Great! Now walk back up and try again."),this.tutorialStep=5}):this.completedRuns>=2&&this.time.delayedCall(1e3,()=>{this.showDialogue("You're a natural! Ready for the big mountain?"),this.tutorialStep=6,this.time.delayedCall(3e3,()=>{this.completeTutorial()})})}checkTutorialProgress(){this.tutorialStep===1&&!this.dialogueVisible&&(this.showDialogue("Use WASD to walk around. White snow is uphill, darker snow is downhill."),this.tutorialStep=2),this.tutorialStep===2&&this.hasPlayerMoved()&&!this.dialogueVisible&&this.time.delayedCall(2e3,()=>{this.showDialogue("Walk to the top of the hill first."),this.tutorialStep=3}),this.tutorialStep===3&&this.isNearTop()&&!this.dialogueVisible&&(this.showDialogue("Press SPACE to start sledding down!"),this.tutorialStep=4)}hasPlayerMoved(){return Math.abs(this.player.x-this.hillCenterX)>20||Math.abs(this.player.y-this.hillBottom)>20}isNearTop(){return this.player.y<this.hillTop+50}completeTutorial(){this.cameras.main.fadeOut(1500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})}}class I{constructor(a){o(this,"seed");o(this,"layers",[]);o(this,"NUM_LAYERS",10);o(this,"BASE_CIRCUMFERENCE",2e3);o(this,"LAYER_HEIGHT",200);this.seed=a,this.generateLayers()}seededRandom(a,t,e){const i=this.stringToNumber(this.seed),s=Math.sin(a*12.9898+t*78.233+e*45.543+i)*43758.5453;return s-Math.floor(s)}stringToNumber(a){let t=0;for(let e=0;e<a.length;e++)t=(t<<5)-t+a.charCodeAt(e),t|=0;return t}generateLayers(){for(let a=0;a<this.NUM_LAYERS;a++){const t=this.BASE_CIRCUMFERENCE*(1-a/this.NUM_LAYERS*.7),e={index:a,circumference:Math.floor(t),heightRange:{min:a*this.LAYER_HEIGHT,max:(a+1)*this.LAYER_HEIGHT},terrain:this.generateTerrainForLayer(a,Math.floor(t))};this.layers.push(e)}}generateTerrainForLayer(a,t){const i=Math.ceil(t/32),s=Math.ceil(this.LAYER_HEIGHT/32),r=[];for(let n=0;n<s;n++){const h=[];for(let l=0;l<i;l++){const c=this.generateTile(l,n,a);h.push(c)}r.push(h)}return this.addRamps(r,a),this.addObstacles(r,a),r}generateTile(a,t,e){const i=this.seededRandom(a,t,e),s=e*this.LAYER_HEIGHT+t*32,r=e*.05,n=(this.NUM_LAYERS-e)*.02;let h="snow";i<n?h="rock":i<n+r&&(h="ice");const l=Math.floor(e/this.NUM_LAYERS*9);return{type:h,altitude:s,color:l,variant:Math.floor(this.seededRandom(a+100,t+100,e)*3)}}addRamps(a,t){const e=a[0].length,i=a.length;for(let s=10;s<e;s+=Math.floor(50+this.seededRandom(s,0,t)*50)){const r=Math.floor(this.seededRandom(s,1,t)*(i-3))+1;for(let n=0;n<3&&s+n<e;n++)for(let h=0;h<2&&r+h<i;h++)a[r+h][s+n].type="ramp"}}addObstacles(a,t){const e=a[0].length,i=a.length,s=Math.floor((this.NUM_LAYERS-t)*5);for(let n=0;n<s;n++){const h=Math.floor(this.seededRandom(n,0,t)*e),l=Math.floor(this.seededRandom(n,1,t)*i);a[l]&&a[l][h]&&a[l][h].type==="snow"&&(a[l][h].type="tree")}const r=Math.floor(t*3);for(let n=0;n<r;n++){const h=Math.floor(this.seededRandom(n+1e3,0,t)*e),l=Math.floor(this.seededRandom(n+1e3,1,t)*i);a[l]&&a[l][h]&&a[l][h].type==="snow"&&(a[l][h].type="obstacle")}}getLayers(){return this.layers}getLayer(a){return this.layers[a]}getTileAt(a,t,e){const i=this.layers[e];if(!i)return;const s=32,r=Math.floor(a/s),n=Math.floor(t/s),h=(r%i.terrain[0].length+i.terrain[0].length)%i.terrain[0].length;if(n>=0&&n<i.terrain.length)return i.terrain[n][h]}transitionToLayer(a,t,e,i){const s=this.layers[e],r=this.layers[i];if(!s||!r)return{x:a,y:t};const n=r.circumference/s.circumference,h=a*n;let l=t;return i>e?l=r.heightRange.min+10:l=r.heightRange.max-10,{x:h,y:l}}getLayerIndexForY(a){for(let t=0;t<this.layers.length;t++){const e=this.layers[t];if(a>=e.heightRange.min&&a<=e.heightRange.max)return t}return a<0?0:this.layers.length-1}}class H extends d.Scene{constructor(){super({key:"UphillScene"});o(this,"mountainGenerator");o(this,"gameState");o(this,"player");o(this,"playerX",0);o(this,"playerY",0);o(this,"currentLayer",0);o(this,"cursors");o(this,"wasdKeys");o(this,"eKey");o(this,"hKey");o(this,"spaceKey");o(this,"worldContainer");o(this,"terrainTiles",[]);o(this,"obstacles",[]);o(this,"stamina",100);o(this,"staminaDrainRate",.1);o(this,"lastMovementTime",0);o(this,"staminaBar");o(this,"staminaText");o(this,"moneyText");o(this,"altitudeText");o(this,"instructionText");o(this,"animals",[]);o(this,"animalSprites",new Map);o(this,"cameraReticle");o(this,"reticleAngle",0);o(this,"reticleAltitudeLine",50);o(this,"photoResultText");o(this,"photographedAnimals",new Map);o(this,"TILE_SIZE",32);o(this,"MOVE_SPEED",3);o(this,"CAMERA_SMOOTHNESS",.1);o(this,"ANIMAL_SPAWN_MIN",5e3);o(this,"ANIMAL_SPAWN_MAX",1e4)}init(){this.gameState=w.getInstance();const t=this.gameState.getState();this.playerX=t.playerPosition.x,this.playerY=t.playerPosition.y,this.currentLayer=t.playerPosition.layer,this.stamina=t.stamina,this.photographedAnimals.clear(),this.animals=[],this.animalSprites.clear()}create(){const t=this.gameState.getState();this.mountainGenerator=new I(t.mountainSeed),this.worldContainer=this.add.container(0,0),this.createTerrain(),this.player=this.add.sprite(this.cameras.main.width/2,this.cameras.main.height/2,"player"),this.player.setScale(2),this.player.setDepth(100),this.setupInput(),this.createUI(),this.cameras.main.fadeIn(500,0,0,0),this.scheduleNextAnimalSpawn(),this.updateUI()}setupInput(){this.wasdKeys={W:this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.W),A:this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.A),S:this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.S),D:this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.D)},this.cursors=this.input.keyboard.createCursorKeys(),this.eKey=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.E),this.hKey=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.H),this.spaceKey=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.SPACE),this.eKey.on("down",()=>this.startDownhillRun()),this.hKey.on("down",()=>this.returnToHouse()),this.spaceKey.on("down",()=>this.takePhoto())}createUI(){const t=this.add.sprite(this.cameras.main.width/2,30,"ui_stamina_bg");t.setScrollFactor(0),t.setDepth(200),this.staminaBar=this.add.graphics(),this.staminaBar.setScrollFactor(0),this.staminaBar.setDepth(201),this.staminaText=this.add.text(this.cameras.main.width/2,30,"Stamina: 100",{fontSize:"16px",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:3}),this.staminaText.setOrigin(.5),this.staminaText.setScrollFactor(0),this.staminaText.setDepth(202),this.moneyText=this.add.text(20,20,`Money: $${this.gameState.getMoney()}`,{fontSize:"20px",color:"#2ecc71",fontStyle:"bold",stroke:"#000000",strokeThickness:3}),this.moneyText.setScrollFactor(0),this.moneyText.setDepth(200),this.altitudeText=this.add.text(20,60,`Altitude: ${Math.floor(this.playerY)}m | Layer: ${this.currentLayer}`,{fontSize:"18px",color:"#3498db",fontStyle:"bold",stroke:"#000000",strokeThickness:3}),this.altitudeText.setScrollFactor(0),this.altitudeText.setDepth(200),this.instructionText=this.add.text(this.cameras.main.width/2,this.cameras.main.height-30,"WASD: Move | Arrows: Camera | SPACE: Photo | E: Start Run | H: Return Home",{fontSize:"16px",color:"#ecf0f1",stroke:"#000000",strokeThickness:3}),this.instructionText.setOrigin(.5),this.instructionText.setScrollFactor(0),this.instructionText.setDepth(200),this.cameraReticle=this.add.sprite(this.cameras.main.width/2,this.cameras.main.height/2,"ui_camera_reticle"),this.cameraReticle.setScrollFactor(0),this.cameraReticle.setDepth(250),this.cameraReticle.setVisible(!1),this.cameraReticle.setAlpha(.7),this.photoResultText=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2+100,"",{fontSize:"24px",color:"#f39c12",fontStyle:"bold",stroke:"#000000",strokeThickness:4,align:"center"}),this.photoResultText.setOrigin(.5),this.photoResultText.setScrollFactor(0),this.photoResultText.setDepth(260),this.photoResultText.setVisible(!1)}createTerrain(){this.terrainTiles.forEach(i=>i.destroy()),this.obstacles.forEach(i=>i.destroy()),this.terrainTiles=[],this.obstacles=[];const t=this.mountainGenerator.getLayer(this.currentLayer);if(!t)return;const e=t.terrain;for(let i=0;i<e.length;i++)for(let s=0;s<e[0].length;s++){const r=e[i][s],n=s*this.TILE_SIZE,h=i*this.TILE_SIZE;let l="";switch(r.type){case"snow":l=`snow_${r.color}`;break;case"ice":l="ice";break;case"rock":l="rock";break;case"ramp":l="ramp";break;case"tree":l=`tree_${r.variant}`;break;case"obstacle":l="rock";break}if(l){const c=this.add.sprite(n,h,l);c.setOrigin(0,0),r.type==="tree"?(c.setDepth(50),this.obstacles.push(c)):r.type==="obstacle"?(c.setDepth(40),this.obstacles.push(c)):c.setDepth(0),this.worldContainer.add(c),this.terrainTiles.push(c)}}}updateTerrain(){const t=this.mountainGenerator.getLayerIndexForY(this.playerY);t!==this.currentLayer&&(this.currentLayer=t,this.createTerrain());const e=this.mountainGenerator.getLayer(this.currentLayer);if(!e)return;const i=e.circumference;this.playerX<0?this.playerX+=i:this.playerX>=i&&(this.playerX-=i);const s=this.cameras.main.width/2,r=this.cameras.main.height/2,n=s-this.playerX,h=r-this.playerY;this.worldContainer.x+=(n-this.worldContainer.x)*this.CAMERA_SMOOTHNESS,this.worldContainer.y+=(h-this.worldContainer.y)*this.CAMERA_SMOOTHNESS}handleMovement(t){let e=!1,i=0,s=0;if(this.wasdKeys.W.isDown?(s=-this.MOVE_SPEED,e=!0):this.wasdKeys.S.isDown&&(s=this.MOVE_SPEED,e=!0),this.wasdKeys.A.isDown?(i=-this.MOVE_SPEED,e=!0):this.wasdKeys.D.isDown&&(i=this.MOVE_SPEED,e=!0),e){this.playerX+=i,this.playerY+=s;const r=1-this.gameState.getUpgrade("personal","attendLegDay")*.15,n=this.gameState.getState().newGamePlus.active?this.gameState.getState().newGamePlus.bonuses.climb:0,h=this.staminaDrainRate*r*(1-n);this.stamina=Math.max(0,this.stamina-h),this.lastMovementTime=this.time.now,this.stamina<=0&&this.outOfStamina()}this.cursors.left.isDown?this.reticleAngle-=2:this.cursors.right.isDown&&(this.reticleAngle+=2),this.cursors.up.isDown?this.reticleAltitudeLine=Math.max(0,this.reticleAltitudeLine-1):this.cursors.down.isDown&&(this.reticleAltitudeLine=Math.min(100,this.reticleAltitudeLine+1)),this.cameraReticle.setAngle(this.reticleAngle)}scheduleNextAnimalSpawn(){const t=d.Math.Between(this.ANIMAL_SPAWN_MIN,this.ANIMAL_SPAWN_MAX);this.time.delayedCall(t,()=>{this.spawnAnimal(),this.scheduleNextAnimalSpawn()})}spawnAnimal(){if(!this.mountainGenerator.getLayer(this.currentLayer))return;const e=["bear","bird","mountainlion","deer","fox"],i={deer:1,fox:.8,bird:.7,bear:.5,mountainlion:.3},s=d.Utils.Array.GetRandom(e),r=i[s],n=Math.random()*Math.PI*2,h=200+Math.random()*300,l=Math.cos(n)*h,c=Math.sin(n)*h,u={type:s,position:{x:this.playerX+l,y:this.playerY+c},altitude:this.playerY+c,moving:Math.random()>.5,speed:.5+Math.random()*1.5,photographed:0,rarity:r};this.animals.push(u);const p=this.add.sprite(u.position.x,u.position.y,`animal_${s}`);p.setScale(2),p.setDepth(60),this.worldContainer.add(p),this.animalSprites.set(u,p),this.time.delayedCall(15e3,()=>{this.removeAnimal(u)})}removeAnimal(t){const e=this.animals.indexOf(t);e>-1&&this.animals.splice(e,1);const i=this.animalSprites.get(t);i&&(i.destroy(),this.animalSprites.delete(t))}updateAnimals(t){this.animals.forEach(e=>{if(e.moving){const i=Math.random()*Math.PI*2;e.position.x+=Math.cos(i)*e.speed,e.position.y+=Math.sin(i)*e.speed,e.altitude=e.position.y;const s=this.animalSprites.get(e);s&&(s.x=e.position.x,s.y=e.position.y,Math.abs(Math.cos(i))>.5&&s.setFlipX(Math.cos(i)<0))}})}takePhoto(){if(this.animals.length===0){this.showPhotoResult("No animals in range!",0);return}this.cameraReticle.setVisible(!0);const t=this.cameras.main.width/2,e=this.cameras.main.height/2,i=40;let s=null;for(let r=0;r<this.animals.length;r++){const n=this.animals[r],h=this.animalSprites.get(n);if(!h)continue;const l=h.x+this.worldContainer.x,c=h.y+this.worldContainer.y,u=l-t,p=c-e,m=Math.sqrt(u*u+p*p);if(m<i*2){const S=1-m/(i*2),y=this.playerY+(this.reticleAltitudeLine-50)*10,g=Math.abs(n.altitude-y),b=Math.max(0,1-g/100),R=n.moving?1.5:1,M=1+(1-n.rarity),x=S*b*R*M;(!s||x>s.score)&&(s={animal:n,score:x})}}if(s){const r=s.animal,n=50,h=1+(1-r.rarity)*2,l=s.score,c=this.photographedAnimals.get(r.type)||0,u=Math.max(.2,1-c*.3);this.photographedAnimals.set(r.type,c+1);const p=Math.floor(n*h*l*u);this.gameState.addMoney(p),this.gameState.incrementStat("totalPhotos",1);const m=s.score>.8?"Excellent":s.score>.5?"Good":"Fair";this.showPhotoResult(`${m} photo of ${r.type}!
+$${p}
(${c>0?"Repeat -"+Math.floor((1-u)*100)+"%":"First photo!"})`,p),r.photographed++,this.time.delayedCall(500,()=>{this.removeAnimal(r)})}else this.showPhotoResult("No animal in frame!",0);this.time.delayedCall(1e3,()=>{this.cameraReticle.setVisible(!1)})}showPhotoResult(t,e){this.photoResultText.setText(t),this.photoResultText.setVisible(!0),e>0?this.photoResultText.setColor("#2ecc71"):this.photoResultText.setColor("#e74c3c"),this.time.delayedCall(2e3,()=>{this.tweens.add({targets:this.photoResultText,alpha:0,duration:500,onComplete:()=>{this.photoResultText.setVisible(!1),this.photoResultText.setAlpha(1)}})})}updateUI(){this.staminaBar.clear();const t=200,e=20,i=this.cameras.main.width/2-t/2,s=20,r=this.stamina/100*t;let n=2600544;this.stamina<30?n=15158332:this.stamina<60&&(n=15965202),this.staminaBar.fillStyle(n,1),this.staminaBar.fillRoundedRect(i,s,r,e,5),this.staminaText.setText(`Stamina: ${Math.floor(this.stamina)}`),this.moneyText.setText(`Money: $${this.gameState.getMoney()}`),this.altitudeText.setText(`Altitude: ${Math.floor(this.playerY)}m | Layer: ${this.currentLayer}`)}outOfStamina(){this.gameState.setState({playerPosition:{x:this.playerX,y:this.playerY,layer:this.currentLayer},stamina:0});const t=Math.floor(this.gameState.getMoney()*.1);this.gameState.spendMoney(t);const e=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,`Out of Stamina!
Lost $${t}
Returning home...`,{fontSize:"32px",color:"#e74c3c",fontStyle:"bold",stroke:"#000000",strokeThickness:6,align:"center"});e.setOrigin(.5),e.setScrollFactor(0),e.setDepth(300),this.time.delayedCall(2e3,()=>{this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("HouseScene")})})}startDownhillRun(){this.gameState.setState({playerPosition:{x:this.playerX,y:this.playerY,layer:this.currentLayer},stamina:this.stamina});const t=this.gameState.getStats();this.playerY>t.highestAltitude&&this.gameState.incrementStat("highestAltitude",this.playerY-t.highestAltitude),this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("DownhillScene")})}returnToHouse(){this.gameState.setState({playerPosition:{x:this.playerX,y:this.playerY,layer:this.currentLayer},stamina:this.stamina}),this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("HouseScene")})}update(t,e){this.handleMovement(e),this.updateTerrain(),this.updateAnimals(e),this.updateUI(),t-this.lastMovementTime>1e3&&this.stamina<100&&(this.stamina=Math.min(100,this.stamina+.05))}}const _=[{name:"Parachute",input:["UP","DOWN"],value:50,description:"Hold sled overhead like a parachute",emoji:"ðŸª‚",animationFrames:[0,1,2]},{name:"Air Brake",input:["UP","UP"],value:40,description:"Use sled as air brake",emoji:"ðŸ›‘",animationFrames:[3,4,5]},{name:"Sled Flip Back",input:["DOWN","LEFT"],value:80,description:"Full backward flip",emoji:"ðŸ”„",animationFrames:[6,7,8]},{name:"Sled Flip Front",input:["DOWN","RIGHT"],value:80,description:"Forward flip with rotation",emoji:"ðŸ”„",animationFrames:[9,10,11]},{name:"Helicopter Spin Left",input:["LEFT","LEFT"],value:60,description:"Spin horizontally left",emoji:"ðŸš",animationFrames:[12,13,14]},{name:"Helicopter Spin Right",input:["RIGHT","RIGHT"],value:60,description:"Spin horizontally right",emoji:"ðŸš",animationFrames:[15,16,17]},{name:"Superman",input:["DOWN","DOWN"],value:70,description:"Extend arms like Superman",emoji:"ðŸ¦¸",animationFrames:[18,19,20]},{name:"Sky Dive Roll Right",input:["UP","RIGHT"],value:90,description:"Roll right in mid-air",emoji:"ðŸŒªï¸",animationFrames:[21,22,23]},{name:"Sky Dive Roll Left",input:["UP","LEFT"],value:90,description:"Roll left in mid-air",emoji:"ðŸŒªï¸",animationFrames:[24,25,26]},{name:"Ghost Rider",input:["LEFT","RIGHT"],value:100,description:"Push sled away and grab back",emoji:"ðŸ‘»",animationFrames:[27,28,29]},{name:"Toboggan Toss",input:["RIGHT","LEFT"],value:100,description:"360Â° spin and land back on sled",emoji:"ðŸŽ¿",animationFrames:[30,31,32]},{name:"Corkscrew Right",input:["RIGHT","DOWN"],value:110,description:"Diagonal barrel roll right",emoji:"ðŸŒ€",animationFrames:[33,34,35]},{name:"Corkscrew Left",input:["LEFT","DOWN"],value:110,description:"Diagonal barrel roll left",emoji:"ðŸŒ€",animationFrames:[36,37,38]},{name:"Falling Star",input:["DOWN","UP"],value:85,description:"Star pose in mid-air",emoji:"âœ¨",animationFrames:[39,40,41]},{name:"Orbit Spin Clockwise",input:["RIGHT","UP"],value:120,description:"360Â° clockwise orbit",emoji:"ðŸŒ",animationFrames:[42,43,44]},{name:"Orbit Spin Counterwise",input:["LEFT","UP"],value:120,description:"360Â° counterclockwise orbit",emoji:"ðŸŒ",animationFrames:[45,46,47]}],E={personal:{rocketSurgery:[100,250,500,1e3,2e3],optimalOptics:[150,300,600,1200,2400],sledDurability:[200,400,800,1600,3200],fancierFootwear:[100,200,400,800,1600],attendLegDay:[150,300,600,1200,2400],crowdHypeman:[300,600,1200,2400,4800],crowdWeaver:[250,500,1e3,2e3,4e3],weatherWarrior:[400,800,1600,3200,6400]},mountain:{skiLifts:[500,1e3,2e3,4e3,8e3],snowmobileRentals:[800,1600,3200,6400,12800],foodStalls:[300,600,1200,2400,4800],groomedTrails:[400,800,1600,3200,6400],firstAidStations:[600,1200,2400,4800,9600],scenicOverlooks:[350,700,1400,2800,5600]}};class W{constructor(a){o(this,"scene");o(this,"inputQueue",[]);o(this,"maxQueueSize",2);o(this,"lastInputTime",0);o(this,"inputTimeout",1e3);o(this,"comboCount",0);o(this,"comboMultiplier",1);o(this,"maxComboMultiplier",5);o(this,"lastTrickTime",0);o(this,"comboTimeout",2e3);o(this,"feedbackText");o(this,"comboText");o(this,"currentTrick");o(this,"trickInProgress",!1);this.scene=a,this.setupFeedbackDisplay()}setupFeedbackDisplay(){this.feedbackText=this.scene.add.text(this.scene.cameras.main.width/2,200,"",{fontSize:"48px",color:"#FFD700",stroke:"#000000",strokeThickness:6,fontStyle:"bold"}).setOrigin(.5).setDepth(1e3),this.comboText=this.scene.add.text(this.scene.cameras.main.width/2,260,"",{fontSize:"32px",color:"#FF6B6B",stroke:"#000000",strokeThickness:4,fontStyle:"bold"}).setOrigin(.5).setDepth(1e3)}addInput(a){const t=Date.now();t-this.lastInputTime>this.inputTimeout&&(this.inputQueue=[]),this.lastInputTime=t,this.inputQueue.push(a),this.inputQueue.length>this.maxQueueSize&&this.inputQueue.shift(),this.tryMatchTrick()}tryMatchTrick(){if(this.inputQueue.length<2)return null;for(const a of _)if(this.matchesInput(a.input,this.inputQueue))return this.currentTrick=a,this.trickInProgress=!0,this.showTrickFeedback(a,!1),a;return null}matchesInput(a,t){if(a.length!==t.length)return!1;for(let e=0;e<a.length;e++)if(a[e]!==t[e])return!1;return!0}completeTrick(){if(!this.currentTrick)return null;const a=Date.now();a-this.lastTrickTime<this.comboTimeout?(this.comboCount++,this.comboMultiplier=Math.min(this.maxComboMultiplier,1+this.comboCount*.5)):(this.comboCount=1,this.comboMultiplier=1),this.lastTrickTime=a;const t={name:this.currentTrick.name,emoji:this.currentTrick.emoji,value:this.currentTrick.value,multiplier:this.comboMultiplier};return this.showTrickFeedback(this.currentTrick,!0),this.updateComboDisplay(),this.currentTrick=void 0,this.trickInProgress=!1,this.inputQueue=[],t}failTrick(){this.currentTrick&&this.showFailFeedback(),this.currentTrick=void 0,this.trickInProgress=!1,this.inputQueue=[],this.comboCount=0,this.comboMultiplier=1,this.lastTrickTime=0,this.updateComboDisplay()}reset(){this.inputQueue=[],this.currentTrick=void 0,this.trickInProgress=!1,this.comboCount=0,this.comboMultiplier=1,this.lastTrickTime=0,this.lastInputTime=0,this.feedbackText&&this.feedbackText.setText(""),this.comboText&&this.comboText.setText("")}showTrickFeedback(a,t){if(!this.feedbackText)return;const e=t?`${a.emoji} ${a.name}! +$${Math.floor(a.value*this.comboMultiplier)}`:`${a.emoji} ${a.name}`;this.feedbackText.setText(e),this.feedbackText.setAlpha(1),this.scene.tweens.add({targets:this.feedbackText,y:this.feedbackText.y-50,alpha:0,duration:2e3,ease:"Power2",onComplete:()=>{this.feedbackText&&(this.feedbackText.y+=50)}})}showFailFeedback(){this.feedbackText&&(this.feedbackText.setText("ðŸ’¥ FAILED!"),this.feedbackText.setColor("#FF0000"),this.feedbackText.setAlpha(1),this.scene.tweens.add({targets:this.feedbackText,alpha:0,duration:1e3,ease:"Power2",onComplete:()=>{this.feedbackText&&this.feedbackText.setColor("#FFD700")}}))}updateComboDisplay(){this.comboText&&(this.comboCount>1?(this.comboText.setText(`COMBO x${this.comboMultiplier.toFixed(1)}`),this.comboText.setAlpha(1),this.scene.tweens.add({targets:this.comboText,scale:{from:1.2,to:1},duration:300,ease:"Back.easeOut"})):this.comboText.setText(""))}update(){const a=Date.now();this.comboCount>0&&a-this.lastTrickTime>this.comboTimeout&&(this.comboCount=0,this.comboMultiplier=1,this.comboText&&this.scene.tweens.add({targets:this.comboText,alpha:0,duration:500,onComplete:()=>{this.comboText&&this.comboText.setText("")}}))}getCurrentTrick(){return this.currentTrick}isTrickInProgress(){return this.trickInProgress}getComboMultiplier(){return this.comboMultiplier}getComboCount(){return this.comboCount}destroy(){this.feedbackText&&this.feedbackText.destroy(),this.comboText&&this.comboText.destroy()}}class N extends d.Scene{constructor(){super({key:"DownhillScene"});o(this,"mountainGenerator");o(this,"trickSystem");o(this,"gameStateManager");o(this,"player");o(this,"playerVelocityX",0);o(this,"playerVelocityY",0);o(this,"playerSpeed",0);o(this,"isJumping",!1);o(this,"isOnGround",!0);o(this,"canJump",!0);o(this,"GRAVITY",.5);o(this,"MAX_SPEED",15);o(this,"ACCELERATION",.3);o(this,"STEERING_SPEED",5);o(this,"JUMP_POWER",-15);o(this,"FRICTION",.98);o(this,"terrainGraphics");o(this,"obstacleSprites",[]);o(this,"worldStartY",2e3);o(this,"currentLayer",9);o(this,"startTime",0);o(this,"currentTime",0);o(this,"moneyEarned",0);o(this,"tricksLanded",0);o(this,"collisions",0);o(this,"gates",[]);o(this,"gatesPassed",0);o(this,"runEnded",!1);o(this,"hudGraphics");o(this,"speedText");o(this,"altitudeText");o(this,"moneyText");o(this,"timeText");o(this,"cursors");o(this,"spaceKey");o(this,"currentDurability",100);o(this,"maxDurability",100)}create(){this.gameStateManager=w.getInstance();const t=this.gameStateManager.getState();this.mountainGenerator=new I(t.mountainSeed),this.trickSystem=new W(this),this.createPlayer(),this.terrainGraphics=this.add.graphics(),this.setupCamera(),this.createGates(),this.cursors=this.input.keyboard.createCursorKeys(),this.spaceKey=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.SPACE),this.createHUD();const e=this.gameStateManager.getUpgrade("personal","sledDurability");this.maxDurability=100+e*50,this.currentDurability=this.maxDurability,this.startTime=Date.now(),this.cameras.main.fadeIn(500,0,0,0)}createPlayer(){this.player=this.add.rectangle(200,this.worldStartY,32,32,3447003),this.player.setStrokeStyle(2,2899536),this.playerVelocityX=0,this.playerVelocityY=0,this.playerSpeed=0}setupCamera(){this.cameras.main.setBounds(0,0,2e3,2e3),this.cameras.main.startFollow(this.player,!0,.1,.1),this.cameras.main.setFollowOffset(-300,0)}createGates(){for(let t=1800;t>200;t-=300)this.gates.push({x:1e3,y:t,passed:!1})}createHUD(){this.hudGraphics=this.add.graphics(),this.hudGraphics.setScrollFactor(0),this.hudGraphics.setDepth(999),this.hudGraphics.fillStyle(0,.5),this.hudGraphics.fillRect(10,10,300,150),this.speedText=this.add.text(20,20,"Speed: 0 mph",{fontSize:"20px",color:"#ffffff"}).setScrollFactor(0).setDepth(1e3),this.altitudeText=this.add.text(20,50,"Altitude: 2000 ft",{fontSize:"20px",color:"#ffffff"}).setScrollFactor(0).setDepth(1e3),this.moneyText=this.add.text(20,80,"Earned: $0",{fontSize:"20px",color:"#FFD700"}).setScrollFactor(0).setDepth(1e3),this.timeText=this.add.text(20,110,"Time: 0.0s",{fontSize:"20px",color:"#ffffff"}).setScrollFactor(0).setDepth(1e3),this.add.text(20,140,"Durability:",{fontSize:"18px",color:"#ffffff"}).setScrollFactor(0).setDepth(1e3)}update(t,e){if(this.runEnded)return;this.trickSystem.update(),this.currentTime=Date.now()-this.startTime,this.handleInput(),this.applyPhysics(),this.player.x+=this.playerVelocityX,this.player.y+=this.playerVelocityY;const i=this.mountainGenerator.getLayer(this.currentLayer);i&&this.player.x>i.circumference?this.player.x=0:this.player.x<0&&(this.player.x=i?i.circumference:2e3),this.checkGroundCollision(),this.checkObstacleCollision(),this.checkGates(),this.updateHUD(),this.renderTerrain(),this.player.y<=50&&this.endRun();const s=this.mountainGenerator.getLayerIndexForY(this.player.y);s!==this.currentLayer&&(this.currentLayer=s)}handleInput(){this.cursors.left.isDown&&(this.isJumping?this.trickSystem.addInput("LEFT"):this.playerVelocityX-=this.STEERING_SPEED*.1),this.cursors.right.isDown&&(this.isJumping?this.trickSystem.addInput("RIGHT"):this.playerVelocityX+=this.STEERING_SPEED*.1),d.Input.Keyboard.JustDown(this.spaceKey)&&this.canJump&&this.isOnGround&&this.jump(),this.isJumping&&(d.Input.Keyboard.JustDown(this.cursors.up)&&this.trickSystem.addInput("UP"),d.Input.Keyboard.JustDown(this.cursors.down)&&this.trickSystem.addInput("DOWN"))}applyPhysics(){if(this.playerVelocityY+=this.GRAVITY,!this.isJumping&&this.isOnGround){const e=this.getTileAtPlayer(),i=this.ACCELERATION;this.playerSpeed+=i;const r=1+this.gameStateManager.getUpgrade("personal","rocketSurgery")*.1;this.playerSpeed=Math.min(this.MAX_SPEED*r,this.playerSpeed),this.playerVelocityY=Math.max(this.playerVelocityY,this.playerSpeed*.5),e&&e.type==="ice"&&(this.playerSpeed*=1.1)}this.playerVelocityX*=this.FRICTION,this.playerVelocityX=Math.max(-this.STEERING_SPEED,Math.min(this.STEERING_SPEED,this.playerVelocityX));const t=this.playerVelocityX*.1;this.player.setRotation(t)}jump(){this.playerVelocityY=this.JUMP_POWER,this.isJumping=!0,this.isOnGround=!1,this.canJump=!1;const t=this.gameStateManager.getUpgrade("personal","attendLegDay");this.playerVelocityY*=1+t*.1}checkGroundCollision(){const t=this.getTileAtPlayer();if(!t)return;const e=Math.floor(this.player.y/32)*32;this.player.y+16>=e&&this.playerVelocityY>0?(this.isJumping&&this.land(t),this.isOnGround=!0,this.canJump=!0,this.player.y=e-16,this.playerVelocityY=0):this.isOnGround=!1}land(t){if(this.trickSystem.isTrickInProgress()){const e=this.trickSystem.completeTrick();if(e){const i=Math.floor(e.value*e.multiplier),s=this.gameStateManager.getUpgrade("personal","crowdHypeman"),r=Math.floor(i*(1+s*.15));this.moneyEarned+=r,this.tricksLanded++}}this.isJumping=!1,this.trickSystem.reset()}checkObstacleCollision(){const t=this.getTileAtPlayer();t&&(t.type==="tree"||t.type==="obstacle"||t.type==="rock")&&this.crash()}crash(){const t=Math.floor(this.playerSpeed*5);this.currentDurability-=t,this.collisions++,this.trickSystem.isTrickInProgress()&&this.trickSystem.failTrick(),this.playerSpeed*=.5,this.playerVelocityY*=.5,this.cameras.main.shake(200,.01);const e=this.player.fillColor;this.player.setFillStyle(16711680),this.time.delayedCall(200,()=>{this.player.setFillStyle(e)}),this.currentDurability<=0&&this.sledDestroyed()}sledDestroyed(){this.moneyEarned=Math.floor(this.moneyEarned*.5),this.endRun()}checkGates(){for(const t of this.gates)if(!t.passed&&Math.abs(this.player.y-t.y)<50&&Math.abs(this.player.x-t.x)<100){t.passed=!0,this.gatesPassed++;const e=50;this.moneyEarned+=e,this.showGatePassedFeedback()}}showGatePassedFeedback(){const t=this.add.text(this.cameras.main.width/2,150,"ðŸšª Gate! +$50",{fontSize:"32px",color:"#00ff00",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setScrollFactor(0).setDepth(1e3);this.tweens.add({targets:t,alpha:0,duration:1500,onComplete:()=>t.destroy()})}getTileAtPlayer(){return this.mountainGenerator.getTileAt(this.player.x,this.player.y,this.currentLayer)}renderTerrain(){this.terrainGraphics.clear(),this.obstacleSprites.forEach(c=>c.destroy()),this.obstacleSprites=[];const t=this.cameras.main,e={x:t.scrollX,y:t.scrollY,width:t.width,height:t.height};if(!this.mountainGenerator.getLayer(this.currentLayer))return;const s=32,r=Math.floor(e.x/s),n=Math.ceil((e.x+e.width)/s),h=Math.floor(e.y/s),l=Math.ceil((e.y+e.height)/s);for(let c=h;c<=l;c++)for(let u=r;u<=n;u++){const p=this.mountainGenerator.getTileAt(u*s,c*s,this.currentLayer);if(!p)continue;const m=u*s,S=c*s;let y=16777215;switch(p.type){case"ice":y=8900331;break;case"rock":y=8421504;break;case"tree":y=2263842;break;case"ramp":y=16776960;break;case"obstacle":y=9127187;break}if(this.terrainGraphics.fillStyle(y,1),this.terrainGraphics.fillRect(m,S,s,s),p.type==="tree"||p.type==="obstacle"||p.type==="rock"){const g=this.add.rectangle(m+16,S+16,s,s,y);g.setStrokeStyle(2,0),this.obstacleSprites.push(g)}}this.gates.forEach(c=>{if(Math.abs(c.y-this.player.y)<t.height){const u=c.passed?65280:16711680;this.terrainGraphics.fillStyle(u,.5),this.terrainGraphics.fillRect(c.x-50,c.y-5,100,10)}})}updateHUD(){const t=Math.floor(this.playerSpeed*10);this.speedText.setText(`Speed: ${t} mph`);const e=Math.floor(this.player.y);this.altitudeText.setText(`Altitude: ${e} ft`),this.moneyText.setText(`Earned: $${this.moneyEarned}`);const i=(this.currentTime/1e3).toFixed(1);this.timeText.setText(`Time: ${i}s`),this.hudGraphics.clear(),this.hudGraphics.fillStyle(0,.5),this.hudGraphics.fillRect(10,10,300,180);const s=this.currentDurability/this.maxDurability,r=280*s,n=s>.5?65280:s>.25?16776960:16711680;this.hudGraphics.fillStyle(3355443,1),this.hudGraphics.fillRect(20,165,280,20),this.hudGraphics.fillStyle(n,1),this.hudGraphics.fillRect(20,165,r,20)}endRun(){if(this.runEnded)return;this.runEnded=!0,this.gameStateManager.addMoney(this.moneyEarned),this.gameStateManager.incrementStat("totalRuns",1),this.gameStateManager.incrementStat("totalTricks",this.tricksLanded),this.gameStateManager.incrementStat("totalCollisions",this.collisions);const t=this.gameStateManager.getStats();(this.currentTime<t.bestTime||t.bestTime===0)&&this.gameStateManager.incrementStat("bestTime",this.currentTime-t.bestTime),this.showRunSummary()}showRunSummary(){const t=this.cameras.main;this.add.rectangle(t.scrollX+t.width/2,t.scrollY+t.height/2,t.width,t.height,0,.8).setDepth(2e3),this.add.rectangle(t.scrollX+t.width/2,t.scrollY+t.height/2,600,500,2899536).setDepth(2001).setStrokeStyle(4,16777215),this.add.text(t.scrollX+t.width/2,t.scrollY+t.height/2-200,"RUN COMPLETE!",{fontSize:"48px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5).setDepth(2002);const e=[`Time: ${(this.currentTime/1e3).toFixed(1)}s`,`Money Earned: $${this.moneyEarned}`,`Tricks Landed: ${this.tricksLanded}`,`Gates Passed: ${this.gatesPassed}/${this.gates.length}`,`Collisions: ${this.collisions}`,`Final Speed: ${Math.floor(this.playerSpeed*10)} mph`];let i=-100;e.forEach(r=>{this.add.text(t.scrollX+t.width/2,t.scrollY+t.height/2+i,r,{fontSize:"24px",color:"#ecf0f1"}).setOrigin(.5).setDepth(2002),i+=40});const s=this.add.text(t.scrollX+t.width/2,t.scrollY+t.height/2+200,"Press SPACE to continue",{fontSize:"24px",color:"#FFD700"}).setOrigin(.5).setDepth(2002);this.tweens.add({targets:s,alpha:{from:1,to:.5},duration:800,yoyo:!0,repeat:-1}),this.input.keyboard.once("keydown-SPACE",()=>{this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.get("HouseScene")?this.scene.start("HouseScene"):this.scene.start("MenuScene")})})}shutdown(){this.trickSystem&&this.trickSystem.destroy(),this.obstacleSprites.forEach(t=>t.destroy()),this.obstacleSprites=[]}}const K=[{key:"rocketSurgery",label:"Rocket Surgery",description:"Boosts top speed & acceleration for faster downhill runs.",icon:"ðŸš€"},{key:"optimalOptics",label:"Optimal Optics",description:"Frees focus & boosts fan engagement for easier weaving.",icon:"ðŸ“¸"},{key:"sledDurability",label:"Sled Durability",description:"Reinforce your sled to withstand bigger impacts.",icon:"ðŸ›·"},{key:"fancierFootwear",label:"Fancier Footwear",description:"Less time climbing, more time sledding.",icon:"ðŸ‘¢"},{key:"attendLegDay",label:"Attend Leg Day",description:"Increase your max stamina for longer uphill pushes.",icon:"ðŸ‹ï¸"},{key:"crowdHypeman",label:"Crowd Hypeman",description:"Perform tricks near fans for boosts.",icon:"ðŸ“£"},{key:"crowdWeaver",label:"Crowd Weaver",description:"Crowds move aside more often.",icon:"ðŸ§"},{key:"weatherWarrior",label:"Weather Warrior",description:"Storms & blizzards barely slow you down.",icon:"ðŸŒ¨ï¸"}],U=[{key:"skiLifts",label:"High-Speed Ski Lift",description:"Ride lifts faster & attract more visitors.",icon:"ðŸŽ¿"},{key:"snowmobileRentals",label:"Snowmobile Rentals",description:"Rent them out or ride them yourself.",icon:"ðŸï¸"},{key:"foodStalls",label:"Food Stalls",description:"Restore stamina and make money.",icon:"ðŸ”"},{key:"groomedTrails",label:"Groomed Trails",description:"Smoothed paths with boosty sections.",icon:"ðŸ¥¾"},{key:"firstAidStations",label:"First-Aid Stations",description:"Heal and reduce collision penalties.",icon:"â›‘ï¸"},{key:"scenicOverlooks",label:"Scenic Overlooks",description:"Lure tourists or use as shortcuts.",icon:"ðŸ“·"}];class Y extends d.Scene{constructor(){super({key:"HouseScene"});o(this,"gameStateManager");o(this,"moneyText");o(this,"loanText");o(this,"staminaText");o(this,"tooltipBg");o(this,"tooltipText");o(this,"upgradeElements",new Map);this.gameStateManager=w.getInstance()}create(){const{width:t,height:e}=this.cameras.main;this.cameras.main.fadeIn(500,0,0,0);const i=this.add.graphics();i.fillGradientStyle(3426654,3426654,2899536,2899536,1),i.fillRect(0,0,t,e),this.add.text(t/2,30,"Lodge & Upgrades",{fontSize:"42px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.createStatsPanel(30,70);const s=180;this.createUpgradeSection(30,s,"Personal Upgrades",K,"personal"),this.createUpgradeSection(660,s,"Mountain Upgrades",U,"mountain"),this.createActionButtons(t,e),this.tooltipBg=this.add.graphics(),this.tooltipBg.setDepth(1e3),this.tooltipBg.setVisible(!1),this.tooltipText=this.add.text(0,0,"",{fontSize:"14px",color:"#ffffff",wordWrap:{width:250},padding:{x:10,y:8}}),this.tooltipText.setDepth(1001),this.tooltipText.setVisible(!1),this.createGameStats(t/2,e-130)}createStatsPanel(t,e){const i=this.gameStateManager.getState(),s=this.add.graphics();s.fillStyle(2899536,.95),s.fillRoundedRect(t,e,1220,80,10),s.lineStyle(2,3447003,.8),s.strokeRoundedRect(t,e,1220,80,10),this.add.text(t+20,e+15,"ðŸ’° Money:",{fontSize:"20px",color:"#f39c12",fontStyle:"bold"}),this.moneyText=this.add.text(t+20,e+45,`$${i.money.toFixed(2)}`,{fontSize:"24px",color:"#f1c40f",fontStyle:"bold"}),this.add.text(t+320,e+15,"ðŸ¦ Loan:",{fontSize:"20px",color:"#e74c3c",fontStyle:"bold"}),this.loanText=this.add.text(t+320,e+45,`$${i.loan.toFixed(2)}`,{fontSize:"24px",color:"#c0392b",fontStyle:"bold"}),this.add.text(t+620,e+15,"âš¡ Stamina:",{fontSize:"20px",color:"#2ecc71",fontStyle:"bold"}),this.staminaText=this.add.text(t+620,e+45,`${i.stamina}/${i.maxStamina}`,{fontSize:"24px",color:"#27ae60",fontStyle:"bold"}),this.add.text(t+920,e+15,"ðŸ“… Day:",{fontSize:"20px",color:"#9b59b6",fontStyle:"bold"}),this.add.text(t+920,e+45,`${i.currentDay}`,{fontSize:"24px",color:"#8e44ad",fontStyle:"bold"})}createUpgradeSection(t,e,i,s,r){this.add.text(t+300,e,i,{fontSize:"26px",color:"#ecf0f1",fontStyle:"bold"}).setOrigin(.5,0);const n=this.add.graphics();n.fillStyle(2899536,.7),n.fillRoundedRect(t,e+35,600,420,10),n.lineStyle(2,3426654,1),n.strokeRoundedRect(t,e+35,600,420,10),s.forEach((h,l)=>{const c=e+50+l*52;this.createUpgradeItem(t+10,c,h,r)})}createUpgradeItem(t,e,i,s){const r=this.gameStateManager.getState(),n=this.gameStateManager.getUpgrade(s,i.key),h=E[s][i.key]||[],l=h.length,c=n<l?h[n]:0,u=r.money>=c,p=n>=l,m=this.add.graphics(),S=p?2600544:u?3426654:2899536;m.fillStyle(S,.8),m.fillRoundedRect(t,e,580,45,6),this.add.text(t+10,e+12,i.icon,{fontSize:"24px"}),this.add.text(t+50,e+12,i.label,{fontSize:"16px",color:"#ecf0f1",fontStyle:"bold"});const y=this.add.text(t+300,e+12,`Lv ${n}/${l}`,{fontSize:"16px",color:"#95a5a6"}),g=this.add.text(t+410,e+12,p?"MAX":`$${c}`,{fontSize:"16px",color:p?"#2ecc71":u?"#f1c40f":"#e74c3c",fontStyle:"bold"});if(!p){const x=t+490,C=e+5,T=this.add.graphics(),P=u?2600544:8359053;T.fillStyle(P,1),T.fillRoundedRect(x,C,80,35,5);const A=this.add.text(x+80/2,C+35/2,"BUY",{fontSize:"14px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),D=this.add.zone(x,C,80,35).setOrigin(0,0);D.setInteractive({useHandCursor:u}),this.upgradeElements.set(`${s}_${i.key}`,{button:T,zone:D,levelText:y,costText:g}),u&&(D.on("pointerover",()=>{T.clear(),T.fillStyle(3066993,1),T.fillRoundedRect(x,C,80,35,5),A.setScale(1.1)}),D.on("pointerout",()=>{T.clear(),T.fillStyle(2600544,1),T.fillRoundedRect(x,C,80,35,5),A.setScale(1)}),D.on("pointerdown",()=>{this.purchaseUpgrade(s,i.key)}))}const b=this.add.zone(t,e,400,45).setOrigin(0,0);b.setInteractive(),b.on("pointerover",()=>{this.showTooltip(i.description,b.x+10,b.y+50)}),b.on("pointerout",()=>{this.hideTooltip()})}purchaseUpgrade(t,e){const i=this.gameStateManager.getUpgrade(t,e),r=(E[t][e]||[])[i];this.gameStateManager.spendMoney(r)&&(this.gameStateManager.upgradeItem(t,e),this.updateStatsDisplay(),this.refreshUpgradeButtons(),this.cameras.main.flash(200,46,204,113,!1))}updateStatsDisplay(){var e,i,s;const t=this.gameStateManager.getState();(e=this.moneyText)==null||e.setText(`$${t.money.toFixed(2)}`),(i=this.loanText)==null||i.setText(`$${t.loan.toFixed(2)}`),(s=this.staminaText)==null||s.setText(`${t.stamina}/${t.maxStamina}`)}refreshUpgradeButtons(){this.scene.restart()}createActionButtons(t,e){const i=e-55,s=this.gameStateManager.getState(),r=s.money>=1e3&&s.loan>0;this.createActionButton(200,i,"Pay Loan ($1000)",r?15158332:8359053,r,()=>this.payLoan()),this.createActionButton(t/2,i,"Start Run â›·ï¸",3066993,!0,()=>this.startRun()),this.createActionButton(t-200,i,"Back to Menu",9807270,!0,()=>this.backToMenu())}createActionButton(t,e,i,s,r,n){const c=this.add.graphics();c.fillStyle(s,1),c.fillRoundedRect(t-200/2,e-45/2,200,45,8);const u=this.add.text(t,e,i,{fontSize:"18px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5);if(r){const p=this.add.zone(t,e,200,45);p.setInteractive({useHandCursor:!0}),p.on("pointerover",()=>{c.clear(),c.fillStyle(s,.8),c.fillRoundedRect(t-200/2,e-45/2,200,45,8),c.lineStyle(3,16777215,.5),c.strokeRoundedRect(t-200/2,e-45/2,200,45,8),u.setScale(1.05)}),p.on("pointerout",()=>{c.clear(),c.fillStyle(s,1),c.fillRoundedRect(t-200/2,e-45/2,200,45,8),u.setScale(1)}),p.on("pointerdown",()=>{u.setScale(.95)}),p.on("pointerup",()=>{u.setScale(1.05),n()})}}payLoan(){this.gameStateManager.spendMoney(1e3)&&(this.gameStateManager.payLoan(1e3),this.updateStatsDisplay(),this.cameras.main.flash(200,46,204,113,!1),this.scene.restart())}startRun(){this.cameras.main.fadeOut(300,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("UphillScene")})}backToMenu(){this.cameras.main.fadeOut(300,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})}createGameStats(t,e){const i=this.gameStateManager.getStats(),s=this.add.graphics();s.fillStyle(2899536,.9),s.fillRoundedRect(t-350,e,700,50,8);const r=[`Runs: ${i.totalRuns}`,`Tricks: ${i.totalTricks}`,`Photos: ${i.totalPhotos}`,`Best Time: ${i.bestTime>0?i.bestTime.toFixed(1)+"s":"N/A"}`,`Peak Alt: ${i.highestAltitude.toFixed(0)}m`].join("  |  ");this.add.text(t,e+25,r,{fontSize:"16px",color:"#bdc3c7"}).setOrigin(.5)}showTooltip(t,e,i){if(!this.tooltipBg||!this.tooltipText)return;this.tooltipText.setText(t);const s=this.tooltipText.getBounds();this.tooltipBg.clear(),this.tooltipBg.fillStyle(2899536,.95),this.tooltipBg.fillRoundedRect(e-5,i-5,s.width+20,s.height+16,6),this.tooltipBg.lineStyle(2,3447003,1),this.tooltipBg.strokeRoundedRect(e-5,i-5,s.width+20,s.height+16,6),this.tooltipText.setPosition(e+5,i+3),this.tooltipBg.setVisible(!0),this.tooltipText.setVisible(!0)}hideTooltip(){var t,e;(t=this.tooltipBg)==null||t.setVisible(!1),(e=this.tooltipText)==null||e.setVisible(!1)}}const $={type:d.AUTO,width:1280,height:720,parent:"game-container",backgroundColor:"#2d3436",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[F,v,B,H,N,Y],pixelArt:!0,antialias:!1,scale:{mode:d.Scale.FIT,autoCenter:d.Scale.CENTER_BOTH}};new d.Game($);
//# sourceMappingURL=index-DmJ-27C-.js.map
