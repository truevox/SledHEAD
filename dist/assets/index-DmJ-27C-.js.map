{"version":3,"file":"index-DmJ-27C-.js","sources":["../../src/utils/ProceduralArt.ts","../../src/scenes/BootScene.ts","../../src/utils/GameStateManager.ts","../../src/scenes/MenuScene.ts","../../src/scenes/TutorialScene.ts","../../src/systems/MountainGenerator.ts","../../src/scenes/UphillScene.ts","../../src/types/index.ts","../../src/systems/TrickSystem.ts","../../src/scenes/DownhillScene.ts","../../src/scenes/HouseScene.ts","../../src/main.ts"],"sourcesContent":["import Phaser from 'phaser';\n\nexport class ProceduralArt {\n  /**\n   * Generates a player sprite programmatically\n   */\n  static generatePlayerSprite(scene: Phaser.Scene, key: string): void {\n    const graphics = scene.add.graphics();\n\n    // Player body (simple stick figure on sled)\n    graphics.fillStyle(0x3498db, 1); // Blue jacket\n    graphics.fillCircle(8, 4, 3); // Head\n\n    graphics.fillStyle(0x2c3e50, 1); // Dark pants\n    graphics.fillRect(6, 7, 4, 4); // Body\n\n    // Sled\n    graphics.fillStyle(0xe74c3c, 1); // Red sled\n    graphics.fillRect(4, 11, 8, 2);\n    graphics.fillStyle(0xc0392b, 1);\n    graphics.fillRect(3, 12, 10, 1); // Runners\n\n    graphics.generateTexture(key, 16, 16);\n    graphics.destroy();\n  }\n\n  /**\n   * Generates trick animation frames\n   */\n  static generateTrickFrames(scene: Phaser.Scene): void {\n    // Generate 48 frames for all tricks (16 tricks * 3 frames each)\n    for (let i = 0; i < 48; i++) {\n      const graphics = scene.add.graphics();\n      const angle = (i * 7.5) * Math.PI / 180; // Rotation for animation\n\n      // Note: Phaser's Graphics doesn't support transform save/restore\n      // We'll render frames without rotation for simplicity\n\n      // Player\n      graphics.fillStyle(0x3498db, 1);\n      graphics.fillCircle(8, 4, 3);\n      graphics.fillStyle(0x2c3e50, 1);\n      graphics.fillRect(6, 7, 4, 4);\n\n      // Sled (position varies by trick)\n      graphics.fillStyle(0xe74c3c, 1);\n      const sledOffset = Math.sin(angle) * 2;\n      graphics.fillRect(4, 11 + sledOffset, 8, 2);\n\n      graphics.generateTexture(`trick_frame_${i}`, 16, 16);\n      graphics.destroy();\n    }\n  }\n\n  /**\n   * Generates terrain tiles\n   */\n  static generateTerrainTiles(scene: Phaser.Scene): void {\n    // Snow tile (various shades based on altitude)\n    for (let shade = 0; shade < 10; shade++) {\n      const graphics = scene.add.graphics();\n      const brightness = 0.7 + (shade * 0.03); // Lighter at higher altitudes\n      const snowColor = Phaser.Display.Color.HSVToRGB(0.6, 0.05, brightness);\n\n      graphics.fillStyle(snowColor.color, 1);\n      graphics.fillRect(0, 0, 32, 32);\n\n      // Add some texture\n      for (let i = 0; i < 15; i++) {\n        const x = Math.random() * 32;\n        const y = Math.random() * 32;\n        const sparkleColor = Phaser.Display.Color.HSVToRGB(0.6, 0.02, brightness + 0.1);\n        graphics.fillStyle(sparkleColor.color, 0.5);\n        graphics.fillCircle(x, y, 1);\n      }\n\n      graphics.generateTexture(`snow_${shade}`, 32, 32);\n      graphics.destroy();\n    }\n\n    // Ice tile\n    const iceGraphics = scene.add.graphics();\n    const iceColor = Phaser.Display.Color.HSVToRGB(0.55, 0.3, 0.9);\n    iceGraphics.fillStyle(iceColor.color, 0.8);\n    iceGraphics.fillRect(0, 0, 32, 32);\n    // Shine effect\n    iceGraphics.fillStyle(0xffffff, 0.3);\n    iceGraphics.fillRect(8, 8, 16, 4);\n    iceGraphics.generateTexture('ice', 32, 32);\n    iceGraphics.destroy();\n\n    // Rock tile\n    const rockGraphics = scene.add.graphics();\n    rockGraphics.fillStyle(0x5a5a5a, 1);\n    rockGraphics.fillRect(0, 0, 32, 32);\n    rockGraphics.fillStyle(0x3a3a3a, 1);\n    rockGraphics.fillCircle(8, 8, 6);\n    rockGraphics.fillCircle(24, 20, 8);\n    rockGraphics.generateTexture('rock', 32, 32);\n    rockGraphics.destroy();\n\n    // Ramp tile\n    const rampGraphics = scene.add.graphics();\n    rampGraphics.fillStyle(0xe8f4f8, 1);\n    rampGraphics.fillTriangle(0, 32, 32, 32, 32, 0);\n    rampGraphics.fillStyle(0xd0e8f0, 1);\n    rampGraphics.fillTriangle(0, 32, 16, 16, 32, 32);\n    rampGraphics.generateTexture('ramp', 32, 32);\n    rampGraphics.destroy();\n  }\n\n  /**\n   * Generates tree sprites\n   */\n  static generateTrees(scene: Phaser.Scene): void {\n    for (let variant = 0; variant < 3; variant++) {\n      const graphics = scene.add.graphics();\n\n      // Trunk\n      graphics.fillStyle(0x5d4e37, 1);\n      graphics.fillRect(14, 24, 4, 16);\n\n      // Pine foliage\n      graphics.fillStyle(0x2d5016, 1);\n      const layers = 3 + variant;\n      for (let i = 0; i < layers; i++) {\n        const y = 24 - (i * 6);\n        const size = 20 - (i * 3);\n        graphics.fillTriangle(16 - size/2, y, 16 + size/2, y, 16, y - 10);\n      }\n\n      graphics.generateTexture(`tree_${variant}`, 32, 40);\n      graphics.destroy();\n    }\n  }\n\n  /**\n   * Generates animal sprites\n   */\n  static generateAnimals(scene: Phaser.Scene): void {\n    // Bear\n    const bearGraphics = scene.add.graphics();\n    bearGraphics.fillStyle(0x4a3728, 1);\n    bearGraphics.fillEllipse(16, 12, 16, 12); // Body\n    bearGraphics.fillCircle(10, 8, 5); // Head\n    bearGraphics.fillCircle(8, 6, 2); // Ear\n    bearGraphics.fillCircle(12, 6, 2); // Ear\n    bearGraphics.fillStyle(0x2c1e12, 1);\n    bearGraphics.fillCircle(9, 8, 1); // Eye\n    bearGraphics.generateTexture('animal_bear', 32, 24);\n    bearGraphics.destroy();\n\n    // Bird\n    const birdGraphics = scene.add.graphics();\n    birdGraphics.fillStyle(0x3498db, 1);\n    birdGraphics.fillCircle(8, 6, 4); // Body\n    birdGraphics.fillCircle(6, 5, 2); // Head\n    birdGraphics.fillStyle(0x2980b9, 1);\n    birdGraphics.fillTriangle(10, 6, 14, 4, 14, 8); // Wing\n    birdGraphics.fillTriangle(0, 5, 4, 3, 4, 7); // Wing\n    birdGraphics.generateTexture('animal_bird', 16, 12);\n    birdGraphics.destroy();\n\n    // Mountain Lion\n    const lionGraphics = scene.add.graphics();\n    lionGraphics.fillStyle(0xd4a76a, 1);\n    lionGraphics.fillEllipse(16, 10, 14, 10); // Body\n    lionGraphics.fillCircle(10, 8, 4); // Head\n    lionGraphics.fillTriangle(9, 5, 8, 3, 10, 5); // Ear\n    lionGraphics.fillTriangle(11, 5, 12, 3, 10, 5); // Ear\n    lionGraphics.fillStyle(0x8b6f47, 1);\n    lionGraphics.fillRect(18, 12, 8, 2); // Tail\n    lionGraphics.generateTexture('animal_mountainlion', 28, 16);\n    lionGraphics.destroy();\n\n    // Deer\n    const deerGraphics = scene.add.graphics();\n    deerGraphics.fillStyle(0x8b7355, 1);\n    deerGraphics.fillEllipse(16, 14, 12, 10); // Body\n    deerGraphics.fillCircle(10, 10, 4); // Head\n    deerGraphics.fillStyle(0x654321, 1);\n    // Antlers\n    deerGraphics.strokeRect(8, 4, 1, 4);\n    deerGraphics.strokeRect(12, 4, 1, 4);\n    deerGraphics.generateTexture('animal_deer', 32, 20);\n    deerGraphics.destroy();\n\n    // Fox\n    const foxGraphics = scene.add.graphics();\n    foxGraphics.fillStyle(0xff6b35, 1);\n    foxGraphics.fillEllipse(12, 10, 10, 8); // Body\n    foxGraphics.fillCircle(8, 8, 3); // Head\n    foxGraphics.fillTriangle(7, 6, 6, 3, 8, 6); // Ear\n    foxGraphics.fillTriangle(9, 6, 10, 3, 8, 6); // Ear\n    foxGraphics.fillStyle(0xffffff, 1);\n    foxGraphics.fillCircle(8, 9, 1.5); // Snout\n    foxGraphics.generateTexture('animal_fox', 24, 16);\n    foxGraphics.destroy();\n  }\n\n  /**\n   * Generates UI elements\n   */\n  static generateUIElements(scene: Phaser.Scene): void {\n    // Stamina bar background\n    const staminaBgGraphics = scene.add.graphics();\n    staminaBgGraphics.fillStyle(0x2c3e50, 1);\n    staminaBgGraphics.fillRoundedRect(0, 0, 200, 20, 5);\n    staminaBgGraphics.lineStyle(2, 0x34495e, 1);\n    staminaBgGraphics.strokeRoundedRect(0, 0, 200, 20, 5);\n    staminaBgGraphics.generateTexture('ui_stamina_bg', 200, 20);\n    staminaBgGraphics.destroy();\n\n    // Stamina bar fill\n    const staminaFillGraphics = scene.add.graphics();\n    staminaFillGraphics.fillStyle(0x27ae60, 1);\n    staminaFillGraphics.fillRoundedRect(0, 0, 200, 20, 5);\n    staminaFillGraphics.generateTexture('ui_stamina_fill', 200, 20);\n    staminaFillGraphics.destroy();\n\n    // Camera reticle for photography\n    const reticleGraphics = scene.add.graphics();\n    reticleGraphics.lineStyle(2, 0xffff00, 1);\n    reticleGraphics.strokeCircle(50, 50, 40);\n    reticleGraphics.strokeRect(48, 0, 4, 100);\n    reticleGraphics.strokeRect(0, 48, 100, 4);\n    reticleGraphics.lineStyle(3, 0xff0000, 0.5);\n    reticleGraphics.strokeRect(0, 50, 100, 1); // Altitude line\n    reticleGraphics.generateTexture('ui_camera_reticle', 100, 100);\n    reticleGraphics.destroy();\n  }\n\n  /**\n   * Generates NPC sprites\n   */\n  static generateNPCs(scene: Phaser.Scene): void {\n    // Grandpa\n    const grandpaGraphics = scene.add.graphics();\n    grandpaGraphics.fillStyle(0x95a5a6, 1); // Gray hair\n    grandpaGraphics.fillCircle(16, 8, 5); // Head\n    grandpaGraphics.fillStyle(0xfbd4a5, 1); // Skin\n    grandpaGraphics.fillCircle(16, 10, 4); // Face\n    grandpaGraphics.fillStyle(0x8b4513, 1); // Brown coat\n    grandpaGraphics.fillRect(12, 14, 8, 12); // Body\n    grandpaGraphics.fillStyle(0x2c3e50, 1);\n    grandpaGraphics.fillRect(12, 26, 3, 6); // Legs\n    grandpaGraphics.fillRect(17, 26, 3, 6);\n    grandpaGraphics.generateTexture('npc_grandpa', 32, 32);\n    grandpaGraphics.destroy();\n\n    // Jake (trick master)\n    const jakeGraphics = scene.add.graphics();\n    jakeGraphics.fillStyle(0x654321, 1); // Brown hair\n    jakeGraphics.fillCircle(16, 8, 5);\n    jakeGraphics.fillStyle(0xfbd4a5, 1);\n    jakeGraphics.fillCircle(16, 10, 4);\n    jakeGraphics.fillStyle(0xe74c3c, 1); // Red jacket\n    jakeGraphics.fillRect(12, 14, 8, 12);\n    jakeGraphics.fillStyle(0x34495e, 1);\n    jakeGraphics.fillRect(12, 26, 3, 6);\n    jakeGraphics.fillRect(17, 26, 3, 6);\n    jakeGraphics.generateTexture('npc_jake', 32, 32);\n    jakeGraphics.destroy();\n\n    // Steve (sled tech)\n    const steveGraphics = scene.add.graphics();\n    steveGraphics.fillStyle(0x2c3e50, 1); // Dark hair\n    steveGraphics.fillCircle(16, 8, 5);\n    steveGraphics.fillStyle(0xfbd4a5, 1);\n    steveGraphics.fillCircle(16, 10, 4);\n    steveGraphics.fillStyle(0x95a5a6, 1); // Gray overalls\n    steveGraphics.fillRect(12, 14, 8, 12);\n    steveGraphics.fillStyle(0x7f8c8d, 1);\n    steveGraphics.fillRect(12, 26, 3, 6);\n    steveGraphics.fillRect(17, 26, 3, 6);\n    steveGraphics.generateTexture('npc_steve', 32, 32);\n    steveGraphics.destroy();\n  }\n\n  /**\n   * Generates all procedural assets\n   */\n  static generateAllAssets(scene: Phaser.Scene): void {\n    this.generatePlayerSprite(scene, 'player');\n    this.generateTrickFrames(scene);\n    this.generateTerrainTiles(scene);\n    this.generateTrees(scene);\n    this.generateAnimals(scene);\n    this.generateUIElements(scene);\n    this.generateNPCs(scene);\n  }\n}\n","import Phaser from 'phaser';\nimport { ProceduralArt } from '../utils/ProceduralArt';\n\nexport class BootScene extends Phaser.Scene {\n  constructor() {\n    super({ key: 'BootScene' });\n  }\n\n  preload(): void {\n    // Create loading text\n    const loadingText = this.add.text(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      'Generating Assets...',\n      {\n        fontSize: '32px',\n        color: '#ffffff',\n      }\n    ).setOrigin(0.5);\n\n    // Loading progress bar\n    const progressBar = this.add.graphics();\n    const progressBox = this.add.graphics();\n    progressBox.fillStyle(0x222222, 0.8);\n    progressBox.fillRect(240, 370, 800, 50);\n\n    this.load.on('progress', (value: number) => {\n      progressBar.clear();\n      progressBar.fillStyle(0x3498db, 1);\n      progressBar.fillRect(250, 380, 780 * value, 30);\n      loadingText.setText(`Generating Assets... ${Math.floor(value * 100)}%`);\n    });\n\n    this.load.on('complete', () => {\n      progressBar.destroy();\n      progressBox.destroy();\n      loadingText.destroy();\n    });\n  }\n\n  create(): void {\n    // Generate all procedural art\n    ProceduralArt.generateAllAssets(this);\n\n    // Add title screen elements\n    this.cameras.main.fadeIn(1000, 0, 0, 0);\n\n    const title = this.add.text(\n      this.cameras.main.width / 2,\n      200,\n      'SledHEAD',\n      {\n        fontSize: '96px',\n        color: '#ffffff',\n        fontStyle: 'bold',\n        stroke: '#2c3e50',\n        strokeThickness: 8,\n      }\n    ).setOrigin(0.5);\n\n    // Pulsing animation for title\n    this.tweens.add({\n      targets: title,\n      scale: { from: 1, to: 1.05 },\n      duration: 1500,\n      yoyo: true,\n      repeat: -1,\n      ease: 'Sine.easeInOut',\n    });\n\n    // Wait 2 seconds then transition to menu\n    this.time.delayedCall(2000, () => {\n      this.cameras.main.fadeOut(500, 0, 0, 0);\n      this.cameras.main.once('camerafadeoutcomplete', () => {\n        this.scene.start('MenuScene');\n      });\n    });\n  }\n}\n","import { GameState, UpgradeState, GameStats, NewGamePlusState } from '../types';\n\nexport class GameStateManager {\n  private static instance: GameStateManager;\n  private state: GameState;\n\n  private constructor() {\n    this.state = this.getDefaultState();\n    this.loadState();\n  }\n\n  static getInstance(): GameStateManager {\n    if (!GameStateManager.instance) {\n      GameStateManager.instance = new GameStateManager();\n    }\n    return GameStateManager.instance;\n  }\n\n  private getDefaultState(): GameState {\n    return {\n      money: 200,\n      loan: 100000,\n      stamina: 100,\n      maxStamina: 100,\n      playerPosition: { x: 640, y: 600, layer: 0 },\n      mountainSeed: this.generateSeed(),\n      currentDay: 1,\n      upgrades: this.getDefaultUpgrades(),\n      stats: this.getDefaultStats(),\n      newGamePlus: this.getDefaultNewGamePlus(),\n    };\n  }\n\n  private getDefaultUpgrades(): UpgradeState {\n    return {\n      personal: {\n        rocketSurgery: 0,\n        optimalOptics: 0,\n        sledDurability: 0,\n        fancierFootwear: 0,\n        attendLegDay: 0,\n        crowdHypeman: 0,\n        crowdWeaver: 0,\n        weatherWarrior: 0,\n      },\n      mountain: {\n        skiLifts: 0,\n        snowmobileRentals: 0,\n        foodStalls: 0,\n        groomedTrails: 0,\n        firstAidStations: 0,\n        scenicOverlooks: 0,\n      },\n    };\n  }\n\n  private getDefaultStats(): GameStats {\n    return {\n      totalRuns: 0,\n      totalTricks: 0,\n      totalPhotos: 0,\n      bestTime: 0,\n      highestAltitude: 0,\n      totalCollisions: 0,\n    };\n  }\n\n  private getDefaultNewGamePlus(): NewGamePlusState {\n    return {\n      active: false,\n      bonuses: {\n        speed: 0,\n        trickery: 0,\n        resilience: 0,\n        climb: 0,\n        charisma: 0,\n        rhythm: 0,\n      },\n    };\n  }\n\n  private generateSeed(): string {\n    return Math.random().toString(36).substring(2, 15);\n  }\n\n  getState(): GameState {\n    return { ...this.state };\n  }\n\n  setState(newState: Partial<GameState>): void {\n    this.state = { ...this.state, ...newState };\n    this.saveState();\n  }\n\n  getMoney(): number {\n    return this.state.money;\n  }\n\n  addMoney(amount: number): void {\n    this.state.money += amount;\n    this.saveState();\n  }\n\n  spendMoney(amount: number): boolean {\n    if (this.state.money >= amount) {\n      this.state.money -= amount;\n      this.saveState();\n      return true;\n    }\n    return false;\n  }\n\n  getLoan(): number {\n    return this.state.loan;\n  }\n\n  payLoan(amount: number): void {\n    this.state.loan = Math.max(0, this.state.loan - amount);\n    this.saveState();\n  }\n\n  getStamina(): number {\n    return this.state.stamina;\n  }\n\n  setStamina(value: number): void {\n    this.state.stamina = Math.max(0, Math.min(this.state.maxStamina, value));\n    this.saveState();\n  }\n\n  drainStamina(amount: number): void {\n    this.setStamina(this.state.stamina - amount);\n  }\n\n  restoreStamina(amount: number): void {\n    this.setStamina(this.state.stamina + amount);\n  }\n\n  getUpgrade(category: 'personal' | 'mountain', name: string): number {\n    return (this.state.upgrades[category] as any)[name] || 0;\n  }\n\n  upgradeItem(category: 'personal' | 'mountain', name: string): void {\n    const current = (this.state.upgrades[category] as any)[name] || 0;\n    (this.state.upgrades[category] as any)[name] = Math.min(5, current + 1);\n    this.saveState();\n  }\n\n  incrementStat(stat: keyof GameStats, amount: number = 1): void {\n    (this.state.stats[stat] as number) += amount;\n    this.saveState();\n  }\n\n  getStats(): GameStats {\n    return { ...this.state.stats };\n  }\n\n  newGame(seed?: string): void {\n    const ngpBonuses = this.state.newGamePlus.bonuses;\n    this.state = this.getDefaultState();\n    if (seed) {\n      this.state.mountainSeed = seed;\n    }\n    // Preserve NewGame+ bonuses if active\n    if (Object.values(ngpBonuses).some(v => v > 0)) {\n      this.state.newGamePlus.active = true;\n      this.state.newGamePlus.bonuses = ngpBonuses;\n    }\n    this.saveState();\n  }\n\n  startNewGamePlus(bonusChoice: keyof NewGamePlusState['bonuses']): void {\n    const ngpBonuses = this.state.newGamePlus.bonuses;\n    ngpBonuses[bonusChoice] += 0.1; // 10% bonus per completion\n    this.newGame();\n  }\n\n  private saveState(): void {\n    try {\n      localStorage.setItem('sledhead_save', JSON.stringify(this.state));\n    } catch (e) {\n      console.error('Failed to save game state:', e);\n    }\n  }\n\n  private loadState(): void {\n    try {\n      const saved = localStorage.getItem('sledhead_save');\n      if (saved) {\n        const loaded = JSON.parse(saved);\n        // Merge with defaults to handle version updates\n        this.state = { ...this.getDefaultState(), ...loaded };\n      }\n    } catch (e) {\n      console.error('Failed to load game state:', e);\n    }\n  }\n\n  resetState(): void {\n    this.state = this.getDefaultState();\n    this.saveState();\n  }\n}\n","import Phaser from 'phaser';\nimport { GameStateManager } from '../utils/GameStateManager';\n\nexport class MenuScene extends Phaser.Scene {\n  private gameStateManager: GameStateManager;\n  private seedInputText: string = '';\n  private seedInputBox?: Phaser.GameObjects.Text;\n  private isInputActive: boolean = false;\n\n  constructor() {\n    super({ key: 'MenuScene' });\n    this.gameStateManager = GameStateManager.getInstance();\n  }\n\n  create(): void {\n    const { width, height } = this.cameras.main;\n    const state = this.gameStateManager.getState();\n\n    // Fade in\n    this.cameras.main.fadeIn(500, 0, 0, 0);\n\n    // Background gradient\n    const bg = this.add.graphics();\n    bg.fillGradientStyle(0x1e3a5f, 0x1e3a5f, 0x0d1b2a, 0x0d1b2a, 1);\n    bg.fillRect(0, 0, width, height);\n\n    // Title\n    const title = this.add.text(width / 2, 100, 'SledHEAD', {\n      fontSize: '84px',\n      color: '#ffffff',\n      fontStyle: 'bold',\n      stroke: '#2c3e50',\n      strokeThickness: 8,\n    }).setOrigin(0.5);\n\n    // Subtitle\n    this.add.text(width / 2, 180, 'Mountain Sledding Management', {\n      fontSize: '24px',\n      color: '#ecf0f1',\n    }).setOrigin(0.5);\n\n    // Title animation\n    this.tweens.add({\n      targets: title,\n      scale: { from: 1, to: 1.03 },\n      duration: 2000,\n      yoyo: true,\n      repeat: -1,\n      ease: 'Sine.easeInOut',\n    });\n\n    // Mountain seed display\n    const seedBox = this.add.graphics();\n    seedBox.fillStyle(0x34495e, 0.9);\n    seedBox.fillRoundedRect(width / 2 - 250, 240, 500, 100, 10);\n    seedBox.lineStyle(3, 0x3498db, 1);\n    seedBox.strokeRoundedRect(width / 2 - 250, 240, 500, 100, 10);\n\n    this.add.text(width / 2, 260, 'Current Mountain Seed:', {\n      fontSize: '18px',\n      color: '#bdc3c7',\n    }).setOrigin(0.5);\n\n    const seedText = this.add.text(width / 2, 295, state.mountainSeed, {\n      fontSize: '24px',\n      color: '#3498db',\n      fontStyle: 'bold',\n    }).setOrigin(0.5);\n\n    // Custom seed input section\n    const inputBoxBg = this.add.graphics();\n    inputBoxBg.fillStyle(0x2c3e50, 0.9);\n    inputBoxBg.fillRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n    inputBoxBg.lineStyle(2, 0x95a5a6, 1);\n    inputBoxBg.strokeRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n\n    this.add.text(width / 2 - 180, 365, 'Custom Seed:', {\n      fontSize: '16px',\n      color: '#95a5a6',\n    });\n\n    this.seedInputBox = this.add.text(width / 2 - 180, 385, '', {\n      fontSize: '18px',\n      color: '#ecf0f1',\n    });\n\n    // Input hint\n    const inputHint = this.add.text(width / 2, 420, 'Click here to enter custom seed, then press Enter', {\n      fontSize: '14px',\n      color: '#7f8c8d',\n      fontStyle: 'italic',\n    }).setOrigin(0.5);\n\n    // Make input interactive\n    const inputZone = this.add.zone(width / 2 - 200, 360, 400, 50).setOrigin(0, 0);\n    inputZone.setInteractive({ useHandCursor: true });\n\n    inputZone.on('pointerdown', () => {\n      this.isInputActive = true;\n      inputBoxBg.clear();\n      inputBoxBg.fillStyle(0x2c3e50, 0.9);\n      inputBoxBg.fillRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n      inputBoxBg.lineStyle(3, 0x3498db, 1);\n      inputBoxBg.strokeRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n      inputHint.setColor('#3498db');\n    });\n\n    // Keyboard input\n    this.input.keyboard?.on('keydown', (event: KeyboardEvent) => {\n      if (this.isInputActive) {\n        if (event.key === 'Enter') {\n          if (this.seedInputText.trim()) {\n            this.gameStateManager.setState({ mountainSeed: this.seedInputText.trim() });\n            seedText.setText(this.seedInputText.trim());\n            this.seedInputText = '';\n            this.seedInputBox?.setText('');\n          }\n          this.isInputActive = false;\n          inputBoxBg.clear();\n          inputBoxBg.fillStyle(0x2c3e50, 0.9);\n          inputBoxBg.fillRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n          inputBoxBg.lineStyle(2, 0x95a5a6, 1);\n          inputBoxBg.strokeRoundedRect(width / 2 - 200, 360, 400, 50, 8);\n          inputHint.setColor('#7f8c8d');\n        } else if (event.key === 'Backspace') {\n          this.seedInputText = this.seedInputText.slice(0, -1);\n          this.seedInputBox?.setText(this.seedInputText);\n        } else if (event.key.length === 1 && this.seedInputText.length < 20) {\n          this.seedInputText += event.key;\n          this.seedInputBox?.setText(this.seedInputText);\n        }\n      }\n    });\n\n    // Menu buttons\n    const buttonY = 490;\n    const buttonSpacing = 70;\n\n    // Check if there's a saved game (not first time)\n    const hasSavedGame = state.stats.totalRuns > 0;\n\n    // New Game button\n    this.createMenuButton(\n      width / 2,\n      buttonY,\n      'New Game',\n      0x27ae60,\n      () => this.startNewGame()\n    );\n\n    // Continue button (only if saved game exists)\n    if (hasSavedGame) {\n      this.createMenuButton(\n        width / 2,\n        buttonY + buttonSpacing,\n        'Continue',\n        0x2980b9,\n        () => this.continueGame()\n      );\n    }\n\n    // Tutorial button\n    this.createMenuButton(\n      width / 2,\n      buttonY + (hasSavedGame ? buttonSpacing * 2 : buttonSpacing),\n      'Tutorial',\n      0x8e44ad,\n      () => this.startTutorial()\n    );\n\n    // Settings button\n    this.createMenuButton(\n      width / 2,\n      buttonY + (hasSavedGame ? buttonSpacing * 3 : buttonSpacing * 2),\n      'Settings',\n      0x95a5a6,\n      () => this.openSettings()\n    );\n\n    // Footer info\n    this.add.text(width / 2, height - 30, 'v1.0.0 | Made with Phaser 3', {\n      fontSize: '14px',\n      color: '#7f8c8d',\n    }).setOrigin(0.5);\n  }\n\n  private createMenuButton(\n    x: number,\n    y: number,\n    text: string,\n    color: number,\n    callback: () => void\n  ): void {\n    const buttonWidth = 300;\n    const buttonHeight = 50;\n\n    const button = this.add.graphics();\n    button.fillStyle(color, 1);\n    button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n\n    const buttonText = this.add.text(x, y, text, {\n      fontSize: '22px',\n      color: '#ffffff',\n      fontStyle: 'bold',\n    }).setOrigin(0.5);\n\n    // Make interactive\n    const zone = this.add.zone(x, y, buttonWidth, buttonHeight);\n    zone.setInteractive({ useHandCursor: true });\n\n    zone.on('pointerover', () => {\n      button.clear();\n      button.fillStyle(color, 0.8);\n      button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n      button.lineStyle(3, 0xffffff, 0.5);\n      button.strokeRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n      buttonText.setScale(1.05);\n    });\n\n    zone.on('pointerout', () => {\n      button.clear();\n      button.fillStyle(color, 1);\n      button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n      buttonText.setScale(1);\n    });\n\n    zone.on('pointerdown', () => {\n      buttonText.setScale(0.95);\n    });\n\n    zone.on('pointerup', () => {\n      buttonText.setScale(1.05);\n      callback();\n    });\n  }\n\n  private startNewGame(): void {\n    this.cameras.main.fadeOut(300, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('TutorialScene');\n    });\n  }\n\n  private continueGame(): void {\n    this.cameras.main.fadeOut(300, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('UphillScene');\n    });\n  }\n\n  private startTutorial(): void {\n    this.cameras.main.fadeOut(300, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('TutorialScene');\n    });\n  }\n\n  private openSettings(): void {\n    // TODO: Implement settings scene\n    console.log('Settings not yet implemented');\n  }\n}\n","import Phaser from 'phaser';\n\nexport class TutorialScene extends Phaser.Scene {\n  private player!: Phaser.Physics.Arcade.Sprite;\n  private grandpa!: Phaser.Physics.Arcade.Sprite;\n  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys;\n  private wasdKeys!: {\n    W: Phaser.Input.Keyboard.Key;\n    A: Phaser.Input.Keyboard.Key;\n    S: Phaser.Input.Keyboard.Key;\n    D: Phaser.Input.Keyboard.Key;\n  };\n  private spaceKey!: Phaser.Input.Keyboard.Key;\n\n  private isSleddingMode: boolean = false;\n  private playerSpeed: number = 150;\n  private sledSpeed: number = 0;\n  private completedRuns: number = 0;\n  private tutorialStep: number = 0;\n\n  private dialogueBox!: Phaser.GameObjects.Container;\n  private dialogueText!: Phaser.GameObjects.Text;\n  private dialogueVisible: boolean = false;\n\n  private hillTop: number = 100;\n  private hillBottom: number = 500;\n  private hillCenterX: number = 400;\n\n  // Sunset color palette\n  private readonly SUNSET_COLORS = {\n    coral: 0xff6b6b,\n    yellow: 0xffd93d,\n    blue: 0x95afc0,\n  };\n\n  constructor() {\n    super({ key: 'TutorialScene' });\n  }\n\n  create(): void {\n    // Set world bounds for the small tutorial hill\n    this.physics.world.setBounds(0, 0, 800, 600);\n\n    // Create beautiful sunset sky gradient\n    this.createSunsetBackground();\n\n    // Create the tutorial hill terrain\n    this.createHillTerrain();\n\n    // Create player sprite at bottom of hill\n    this.player = this.physics.add.sprite(this.hillCenterX, this.hillBottom, 'player');\n    this.player.setCollideWorldBounds(true);\n    this.player.setScale(2);\n\n    // Create Grandpa NPC at starting position\n    this.grandpa = this.physics.add.sprite(this.hillCenterX - 80, this.hillBottom, 'npc_grandpa');\n    this.grandpa.setScale(2);\n\n    // Setup camera\n    this.cameras.main.setBounds(0, 0, 800, 600);\n    this.cameras.main.startFollow(this.player, true, 0.1, 0.1);\n\n    // Setup input controls\n    this.cursors = this.input.keyboard!.createCursorKeys();\n    this.wasdKeys = this.input.keyboard!.addKeys({\n      W: Phaser.Input.Keyboard.KeyCodes.W,\n      A: Phaser.Input.Keyboard.KeyCodes.A,\n      S: Phaser.Input.Keyboard.KeyCodes.S,\n      D: Phaser.Input.Keyboard.KeyCodes.D,\n    }) as any;\n    this.spaceKey = this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n\n    // Create dialogue UI\n    this.createDialogueBox();\n\n    // Start tutorial sequence\n    this.cameras.main.fadeIn(1000, 0, 0, 0);\n    this.time.delayedCall(1000, () => {\n      this.showDialogue(\"Welcome, kiddo! Let's teach you how to sled.\");\n      this.tutorialStep = 1;\n    });\n\n    // Add some decorative trees\n    this.addDecorativeTrees();\n  }\n\n  update(): void {\n    if (this.isSleddingMode) {\n      this.updateSleddingMode();\n    } else {\n      this.updateWalkingMode();\n    }\n\n    this.checkTutorialProgress();\n  }\n\n  private createSunsetBackground(): void {\n    // Create gradient background with sunset colors\n    const graphics = this.add.graphics();\n\n    // Sky gradient from top to bottom\n    for (let y = 0; y < 600; y++) {\n      const percent = y / 600;\n\n      // Interpolate between sunset colors\n      if (percent < 0.3) {\n        // Blue to Coral transition (top)\n        const localPercent = percent / 0.3;\n        const colorObj = Phaser.Display.Color.Interpolate.ColorWithColor(\n          Phaser.Display.Color.IntegerToColor(this.SUNSET_COLORS.blue),\n          Phaser.Display.Color.IntegerToColor(this.SUNSET_COLORS.coral),\n          100,\n          localPercent * 100\n        );\n        graphics.fillStyle(colorObj.color, 1);\n      } else if (percent < 0.6) {\n        // Coral to Yellow transition (middle)\n        const localPercent = (percent - 0.3) / 0.3;\n        const colorObj = Phaser.Display.Color.Interpolate.ColorWithColor(\n          Phaser.Display.Color.IntegerToColor(this.SUNSET_COLORS.coral),\n          Phaser.Display.Color.IntegerToColor(this.SUNSET_COLORS.yellow),\n          100,\n          localPercent * 100\n        );\n        graphics.fillStyle(colorObj.color, 1);\n      } else {\n        // Yellow fading to white at horizon (bottom)\n        const localPercent = (percent - 0.6) / 0.4;\n        const yellowColor = Phaser.Display.Color.IntegerToColor(this.SUNSET_COLORS.yellow);\n        const white = Phaser.Display.Color.IntegerToColor(0xffffff);\n        const colorObj = Phaser.Display.Color.Interpolate.ColorWithColor(\n          yellowColor,\n          white,\n          100,\n          localPercent * 100\n        );\n        graphics.fillStyle(colorObj.color, 1);\n      }\n\n      graphics.fillRect(0, y, 800, 1);\n    }\n  }\n\n  private createHillTerrain(): void {\n    const graphics = this.add.graphics();\n\n    // Create hill shape with snow gradient\n    const hillPoints: Phaser.Math.Vector2[] = [];\n\n    // Generate smooth hill curve\n    for (let x = 0; x <= 800; x += 10) {\n      const centerDistance = Math.abs(x - this.hillCenterX);\n      const hillHeight = Math.pow((1 - centerDistance / 400), 2) * 300;\n      const y = this.hillBottom - hillHeight;\n      hillPoints.push(new Phaser.Math.Vector2(x, y));\n    }\n\n    // Draw snow terrain with gradient (lighter at top, darker at bottom)\n    for (let i = 0; i < hillPoints.length - 1; i++) {\n      const point = hillPoints[i];\n      const nextPoint = hillPoints[i + 1];\n\n      // Calculate altitude-based color (lighter = higher)\n      const altitude = 1 - ((point.y - this.hillTop) / (this.hillBottom - this.hillTop));\n      const brightness = 0.7 + (altitude * 0.3);\n      const snowColor = Phaser.Display.Color.HSVToRGB(0.6, 0.1, brightness);\n\n      graphics.fillStyle(snowColor.color, 1);\n      graphics.fillTriangle(\n        point.x, point.y,\n        nextPoint.x, nextPoint.y,\n        nextPoint.x, 600\n      );\n      graphics.fillTriangle(\n        point.x, point.y,\n        point.x, 600,\n        nextPoint.x, 600\n      );\n    }\n\n    // Add sparkles to snow\n    for (let i = 0; i < 100; i++) {\n      const x = Math.random() * 800;\n      const centerDistance = Math.abs(x - this.hillCenterX);\n      const hillHeight = Math.pow((1 - centerDistance / 400), 2) * 300;\n      const minY = this.hillBottom - hillHeight;\n      const y = minY + Math.random() * (600 - minY);\n\n      graphics.fillStyle(0xffffff, 0.6 + Math.random() * 0.4);\n      graphics.fillCircle(x, y, 1 + Math.random() * 2);\n    }\n  }\n\n  private addDecorativeTrees(): void {\n    // Add a few trees around the hill for atmosphere\n    const treePositions = [\n      { x: 100, y: 400 },\n      { x: 150, y: 450 },\n      { x: 650, y: 400 },\n      { x: 700, y: 450 },\n      { x: 50, y: 500 },\n      { x: 750, y: 500 },\n    ];\n\n    treePositions.forEach(pos => {\n      const variant = Math.floor(Math.random() * 3);\n      const tree = this.add.sprite(pos.x, pos.y, `tree_${variant}`);\n      tree.setScale(1.5);\n      tree.setAlpha(0.7);\n    });\n  }\n\n  private createDialogueBox(): void {\n    const boxWidth = 600;\n    const boxHeight = 100;\n    const boxX = 400;\n    const boxY = 550;\n\n    // Create dialogue container\n    this.dialogueBox = this.add.container(boxX, boxY);\n\n    // Background box\n    const bg = this.add.graphics();\n    bg.fillStyle(0x2c3e50, 0.9);\n    bg.fillRoundedRect(-boxWidth / 2, -boxHeight / 2, boxWidth, boxHeight, 10);\n    bg.lineStyle(3, 0xffffff, 1);\n    bg.strokeRoundedRect(-boxWidth / 2, -boxHeight / 2, boxWidth, boxHeight, 10);\n\n    // Grandpa name label\n    const nameLabel = this.add.text(-boxWidth / 2 + 20, -boxHeight / 2 + 10, 'Grandpa:', {\n      fontSize: '18px',\n      color: '#ffd93d',\n      fontStyle: 'bold',\n    });\n\n    // Dialogue text\n    this.dialogueText = this.add.text(-boxWidth / 2 + 20, -boxHeight / 2 + 35, '', {\n      fontSize: '16px',\n      color: '#ffffff',\n      wordWrap: { width: boxWidth - 40 },\n    });\n\n    this.dialogueBox.add([bg, nameLabel, this.dialogueText]);\n    this.dialogueBox.setVisible(false);\n    this.dialogueBox.setDepth(100);\n  }\n\n  private showDialogue(message: string): void {\n    this.dialogueText.setText(message);\n    this.dialogueBox.setVisible(true);\n    this.dialogueVisible = true;\n\n    // Auto-hide after 5 seconds\n    this.time.delayedCall(5000, () => {\n      this.hideDialogue();\n    });\n  }\n\n  private hideDialogue(): void {\n    this.dialogueBox.setVisible(false);\n    this.dialogueVisible = false;\n  }\n\n  private updateWalkingMode(): void {\n    // WASD movement for walking uphill\n    let velocityX = 0;\n    let velocityY = 0;\n\n    if (this.wasdKeys.W.isDown || this.cursors.up!.isDown) {\n      velocityY = -this.playerSpeed;\n    } else if (this.wasdKeys.S.isDown || this.cursors.down!.isDown) {\n      velocityY = this.playerSpeed;\n    }\n\n    if (this.wasdKeys.A.isDown || this.cursors.left!.isDown) {\n      velocityX = -this.playerSpeed;\n    } else if (this.wasdKeys.D.isDown || this.cursors.right!.isDown) {\n      velocityX = this.playerSpeed;\n    }\n\n    // Normalize diagonal movement\n    if (velocityX !== 0 && velocityY !== 0) {\n      velocityX *= 0.707;\n      velocityY *= 0.707;\n    }\n\n    this.player.setVelocity(velocityX, velocityY);\n\n    // Check if player pressed SPACE at the top\n    if (Phaser.Input.Keyboard.JustDown(this.spaceKey) && this.isNearTop()) {\n      this.startSleddingMode();\n    }\n  }\n\n  private updateSleddingMode(): void {\n    // Automatic downward sledding\n    this.sledSpeed += 2; // Acceleration\n    this.sledSpeed = Math.min(this.sledSpeed, 400); // Max speed\n\n    // Steer left/right while sledding\n    let velocityX = 0;\n\n    if (this.wasdKeys.A.isDown || this.cursors.left!.isDown) {\n      velocityX = -200;\n    } else if (this.wasdKeys.D.isDown || this.cursors.right!.isDown) {\n      velocityX = 200;\n    }\n\n    this.player.setVelocity(velocityX, this.sledSpeed);\n\n    // Rotate player sprite to show sledding\n    this.player.setAngle(15);\n\n    // Check if reached bottom\n    if (this.player.y >= this.hillBottom - 20) {\n      this.endSleddingMode();\n    }\n  }\n\n  private startSleddingMode(): void {\n    this.isSleddingMode = true;\n    this.sledSpeed = 50;\n    this.showDialogue(\"Great! Now steer with A and D!\");\n  }\n\n  private endSleddingMode(): void {\n    this.isSleddingMode = false;\n    this.sledSpeed = 0;\n    this.player.setVelocity(0, 0);\n    this.player.setAngle(0);\n    this.completedRuns++;\n\n    if (this.completedRuns === 1) {\n      this.time.delayedCall(1000, () => {\n        this.showDialogue(\"Great! Now walk back up and try again.\");\n        this.tutorialStep = 5;\n      });\n    } else if (this.completedRuns >= 2) {\n      this.time.delayedCall(1000, () => {\n        this.showDialogue(\"You're a natural! Ready for the big mountain?\");\n        this.tutorialStep = 6;\n\n        // Complete tutorial after a moment\n        this.time.delayedCall(3000, () => {\n          this.completeTutorial();\n        });\n      });\n    }\n  }\n\n  private checkTutorialProgress(): void {\n    // Progress tutorial steps based on player actions\n    if (this.tutorialStep === 1 && !this.dialogueVisible) {\n      this.showDialogue(\"Use WASD to walk around. White snow is uphill, darker snow is downhill.\");\n      this.tutorialStep = 2;\n    }\n\n    if (this.tutorialStep === 2 && this.hasPlayerMoved() && !this.dialogueVisible) {\n      this.time.delayedCall(2000, () => {\n        this.showDialogue(\"Walk to the top of the hill first.\");\n        this.tutorialStep = 3;\n      });\n    }\n\n    if (this.tutorialStep === 3 && this.isNearTop() && !this.dialogueVisible) {\n      this.showDialogue(\"Press SPACE to start sledding down!\");\n      this.tutorialStep = 4;\n    }\n  }\n\n  private hasPlayerMoved(): boolean {\n    return Math.abs(this.player.x - this.hillCenterX) > 20 ||\n           Math.abs(this.player.y - this.hillBottom) > 20;\n  }\n\n  private isNearTop(): boolean {\n    return this.player.y < this.hillTop + 50;\n  }\n\n  private completeTutorial(): void {\n    // Fade out and transition to menu/house scene\n    this.cameras.main.fadeOut(1500, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      // Transition to HouseScene (or MenuScene if HouseScene doesn't exist)\n      this.scene.start('MenuScene');\n    });\n  }\n}\n","import { MountainLayer, TerrainTile } from '../types';\n\nexport class MountainGenerator {\n  private seed: string;\n  private layers: MountainLayer[] = [];\n  private readonly NUM_LAYERS = 10;\n  private readonly BASE_CIRCUMFERENCE = 2000;\n  private readonly LAYER_HEIGHT = 200;\n\n  constructor(seed: string) {\n    this.seed = seed;\n    this.generateLayers();\n  }\n\n  private seededRandom(x: number, y: number, layer: number): number {\n    const seedNum = this.stringToNumber(this.seed);\n    const n = Math.sin(x * 12.9898 + y * 78.233 + layer * 45.543 + seedNum) * 43758.5453;\n    return n - Math.floor(n);\n  }\n\n  private stringToNumber(str: string): number {\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n      hash = ((hash << 5) - hash) + str.charCodeAt(i);\n      hash |= 0;\n    }\n    return hash;\n  }\n\n  private generateLayers(): void {\n    for (let i = 0; i < this.NUM_LAYERS; i++) {\n      const circumference = this.BASE_CIRCUMFERENCE * (1 - (i / this.NUM_LAYERS) * 0.7);\n      const layer: MountainLayer = {\n        index: i,\n        circumference: Math.floor(circumference),\n        heightRange: {\n          min: i * this.LAYER_HEIGHT,\n          max: (i + 1) * this.LAYER_HEIGHT,\n        },\n        terrain: this.generateTerrainForLayer(i, Math.floor(circumference)),\n      };\n      this.layers.push(layer);\n    }\n  }\n\n  private generateTerrainForLayer(layerIndex: number, circumference: number): TerrainTile[][] {\n    const tileSize = 32;\n    const width = Math.ceil(circumference / tileSize);\n    const height = Math.ceil(this.LAYER_HEIGHT / tileSize);\n    const terrain: TerrainTile[][] = [];\n\n    for (let y = 0; y < height; y++) {\n      const row: TerrainTile[] = [];\n      for (let x = 0; x < width; x++) {\n        const tile = this.generateTile(x, y, layerIndex);\n        row.push(tile);\n      }\n      terrain.push(row);\n    }\n\n    // Add ramps strategically\n    this.addRamps(terrain, layerIndex);\n    // Add obstacles\n    this.addObstacles(terrain, layerIndex);\n\n    return terrain;\n  }\n\n  private generateTile(x: number, y: number, layer: number): TerrainTile {\n    const rand = this.seededRandom(x, y, layer);\n    const altitude = layer * this.LAYER_HEIGHT + (y * 32);\n\n    // Higher layers have more ice, lower layers have more rock\n    const iceChance = layer * 0.05;\n    const rockChance = (this.NUM_LAYERS - layer) * 0.02;\n\n    let type: TerrainTile['type'] = 'snow';\n    if (rand < rockChance) {\n      type = 'rock';\n    } else if (rand < rockChance + iceChance) {\n      type = 'ice';\n    }\n\n    // Snow color varies by altitude (lighter = higher)\n    const colorVariant = Math.floor((layer / this.NUM_LAYERS) * 9);\n\n    return {\n      type,\n      altitude,\n      color: colorVariant,\n      variant: Math.floor(this.seededRandom(x + 100, y + 100, layer) * 3),\n    };\n  }\n\n  private addRamps(terrain: TerrainTile[][], layer: number): void {\n    const width = terrain[0].length;\n    const height = terrain.length;\n\n    // Add ramps every 50-100 tiles horizontally\n    for (let x = 10; x < width; x += Math.floor(50 + this.seededRandom(x, 0, layer) * 50)) {\n      const y = Math.floor(this.seededRandom(x, 1, layer) * (height - 3)) + 1;\n\n      // Create a small ramp\n      for (let i = 0; i < 3 && x + i < width; i++) {\n        for (let j = 0; j < 2 && y + j < height; j++) {\n          terrain[y + j][x + i].type = 'ramp';\n        }\n      }\n    }\n  }\n\n  private addObstacles(terrain: TerrainTile[][], layer: number): void {\n    const width = terrain[0].length;\n    const height = terrain.length;\n\n    // Add trees (more at lower layers)\n    const treeCount = Math.floor((this.NUM_LAYERS - layer) * 5);\n    for (let i = 0; i < treeCount; i++) {\n      const x = Math.floor(this.seededRandom(i, 0, layer) * width);\n      const y = Math.floor(this.seededRandom(i, 1, layer) * height);\n\n      if (terrain[y] && terrain[y][x] && terrain[y][x].type === 'snow') {\n        terrain[y][x].type = 'tree';\n      }\n    }\n\n    // Add rocks\n    const rockCount = Math.floor(layer * 3);\n    for (let i = 0; i < rockCount; i++) {\n      const x = Math.floor(this.seededRandom(i + 1000, 0, layer) * width);\n      const y = Math.floor(this.seededRandom(i + 1000, 1, layer) * height);\n\n      if (terrain[y] && terrain[y][x] && terrain[y][x].type === 'snow') {\n        terrain[y][x].type = 'obstacle';\n      }\n    }\n  }\n\n  getLayers(): MountainLayer[] {\n    return this.layers;\n  }\n\n  getLayer(index: number): MountainLayer | undefined {\n    return this.layers[index];\n  }\n\n  getTileAt(x: number, y: number, layer: number): TerrainTile | undefined {\n    const currentLayer = this.layers[layer];\n    if (!currentLayer) return undefined;\n\n    const tileSize = 32;\n    const tileX = Math.floor(x / tileSize);\n    const tileY = Math.floor(y / tileSize);\n\n    // Handle horizontal wrapping\n    const wrappedX = ((tileX % currentLayer.terrain[0].length) + currentLayer.terrain[0].length) % currentLayer.terrain[0].length;\n\n    if (tileY >= 0 && tileY < currentLayer.terrain.length) {\n      return currentLayer.terrain[tileY][wrappedX];\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Transition player position between layers\n   */\n  transitionToLayer(currentX: number, currentY: number, currentLayer: number, newLayer: number): { x: number; y: number } {\n    const oldLayer = this.layers[currentLayer];\n    const targetLayer = this.layers[newLayer];\n\n    if (!oldLayer || !targetLayer) {\n      return { x: currentX, y: currentY };\n    }\n\n    // Scale horizontal position based on circumference change\n    const scaleFactor = targetLayer.circumference / oldLayer.circumference;\n    const newX = currentX * scaleFactor;\n\n    // Position at appropriate boundary of new layer\n    let newY = currentY;\n    if (newLayer > currentLayer) {\n      // Moving up: place at bottom of new layer\n      newY = targetLayer.heightRange.min + 10;\n    } else {\n      // Moving down: place at top of new layer\n      newY = targetLayer.heightRange.max - 10;\n    }\n\n    return { x: newX, y: newY };\n  }\n\n  /**\n   * Get the current layer index based on y position\n   */\n  getLayerIndexForY(y: number): number {\n    for (let i = 0; i < this.layers.length; i++) {\n      const layer = this.layers[i];\n      if (y >= layer.heightRange.min && y <= layer.heightRange.max) {\n        return i;\n      }\n    }\n    // Clamp to valid range\n    if (y < 0) return 0;\n    return this.layers.length - 1;\n  }\n}\n","import Phaser from 'phaser';\nimport { MountainGenerator } from '../systems/MountainGenerator';\nimport { GameStateManager } from '../utils/GameStateManager';\nimport { Animal } from '../types';\n\nexport class UphillScene extends Phaser.Scene {\n  private mountainGenerator!: MountainGenerator;\n  private gameState!: GameStateManager;\n\n  // Player\n  private player!: Phaser.GameObjects.Sprite;\n  private playerX: number = 0;\n  private playerY: number = 0;\n  private currentLayer: number = 0;\n\n  // Movement\n  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys;\n  private wasdKeys!: {\n    W: Phaser.Input.Keyboard.Key;\n    A: Phaser.Input.Keyboard.Key;\n    S: Phaser.Input.Keyboard.Key;\n    D: Phaser.Input.Keyboard.Key;\n  };\n  private eKey!: Phaser.Input.Keyboard.Key;\n  private hKey!: Phaser.Input.Keyboard.Key;\n  private spaceKey!: Phaser.Input.Keyboard.Key;\n\n  // World\n  private worldContainer!: Phaser.GameObjects.Container;\n  private terrainTiles: Phaser.GameObjects.Sprite[] = [];\n  private obstacles: Phaser.GameObjects.Sprite[] = [];\n\n  // Stamina\n  private stamina: number = 100;\n  private staminaDrainRate: number = 0.1;\n  private lastMovementTime: number = 0;\n  private staminaBar!: Phaser.GameObjects.Graphics;\n  private staminaText!: Phaser.GameObjects.Text;\n\n  // UI\n  private moneyText!: Phaser.GameObjects.Text;\n  private altitudeText!: Phaser.GameObjects.Text;\n  private instructionText!: Phaser.GameObjects.Text;\n\n  // Wildlife Photography\n  private animals: Animal[] = [];\n  private animalSprites: Map<Animal, Phaser.GameObjects.Sprite> = new Map();\n  private cameraReticle!: Phaser.GameObjects.Sprite;\n  private reticleAngle: number = 0;\n  private reticleAltitudeLine: number = 50; // Vertical position on reticle\n  private photoResultText!: Phaser.GameObjects.Text;\n  private photographedAnimals: Map<string, number> = new Map(); // Track repeat photos\n\n  // Constants\n  private readonly TILE_SIZE = 32;\n  private readonly MOVE_SPEED = 3;\n  private readonly CAMERA_SMOOTHNESS = 0.1;\n  private readonly ANIMAL_SPAWN_MIN = 5000;\n  private readonly ANIMAL_SPAWN_MAX = 10000;\n\n  constructor() {\n    super({ key: 'UphillScene' });\n  }\n\n  init(): void {\n    this.gameState = GameStateManager.getInstance();\n    const state = this.gameState.getState();\n\n    // Initialize player position from game state\n    this.playerX = state.playerPosition.x;\n    this.playerY = state.playerPosition.y;\n    this.currentLayer = state.playerPosition.layer;\n    this.stamina = state.stamina;\n\n    // Reset photography tracking\n    this.photographedAnimals.clear();\n    this.animals = [];\n    this.animalSprites.clear();\n  }\n\n  create(): void {\n    // Create mountain from seed\n    const state = this.gameState.getState();\n    this.mountainGenerator = new MountainGenerator(state.mountainSeed);\n\n    // Create world container for scrolling\n    this.worldContainer = this.add.container(0, 0);\n\n    // Create terrain\n    this.createTerrain();\n\n    // Create player sprite\n    this.player = this.add.sprite(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      'player'\n    );\n    this.player.setScale(2);\n    this.player.setDepth(100);\n\n    // Setup input\n    this.setupInput();\n\n    // Create UI\n    this.createUI();\n\n    // Setup camera\n    this.cameras.main.fadeIn(500, 0, 0, 0);\n\n    // Start animal spawning\n    this.scheduleNextAnimalSpawn();\n\n    // Update initial UI\n    this.updateUI();\n  }\n\n  private setupInput(): void {\n    // WASD for movement\n    this.wasdKeys = {\n      W: this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.W),\n      A: this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.A),\n      S: this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.S),\n      D: this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.D),\n    };\n\n    // Arrow keys for camera reticle\n    this.cursors = this.input.keyboard!.createCursorKeys();\n\n    // Action keys\n    this.eKey = this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.E);\n    this.hKey = this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.H);\n    this.spaceKey = this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n\n    // Key press events\n    this.eKey.on('down', () => this.startDownhillRun());\n    this.hKey.on('down', () => this.returnToHouse());\n    this.spaceKey.on('down', () => this.takePhoto());\n  }\n\n  private createUI(): void {\n    // Stamina bar background\n    const staminaBg = this.add.sprite(\n      this.cameras.main.width / 2,\n      30,\n      'ui_stamina_bg'\n    );\n    staminaBg.setScrollFactor(0);\n    staminaBg.setDepth(200);\n\n    // Stamina bar fill (we'll use graphics for dynamic sizing)\n    this.staminaBar = this.add.graphics();\n    this.staminaBar.setScrollFactor(0);\n    this.staminaBar.setDepth(201);\n\n    // Stamina text\n    this.staminaText = this.add.text(\n      this.cameras.main.width / 2,\n      30,\n      'Stamina: 100',\n      {\n        fontSize: '16px',\n        color: '#ffffff',\n        fontStyle: 'bold',\n        stroke: '#000000',\n        strokeThickness: 3,\n      }\n    );\n    this.staminaText.setOrigin(0.5);\n    this.staminaText.setScrollFactor(0);\n    this.staminaText.setDepth(202);\n\n    // Money display\n    this.moneyText = this.add.text(\n      20,\n      20,\n      `Money: $${this.gameState.getMoney()}`,\n      {\n        fontSize: '20px',\n        color: '#2ecc71',\n        fontStyle: 'bold',\n        stroke: '#000000',\n        strokeThickness: 3,\n      }\n    );\n    this.moneyText.setScrollFactor(0);\n    this.moneyText.setDepth(200);\n\n    // Altitude indicator\n    this.altitudeText = this.add.text(\n      20,\n      60,\n      `Altitude: ${Math.floor(this.playerY)}m | Layer: ${this.currentLayer}`,\n      {\n        fontSize: '18px',\n        color: '#3498db',\n        fontStyle: 'bold',\n        stroke: '#000000',\n        strokeThickness: 3,\n      }\n    );\n    this.altitudeText.setScrollFactor(0);\n    this.altitudeText.setDepth(200);\n\n    // Instructions\n    this.instructionText = this.add.text(\n      this.cameras.main.width / 2,\n      this.cameras.main.height - 30,\n      'WASD: Move | Arrows: Camera | SPACE: Photo | E: Start Run | H: Return Home',\n      {\n        fontSize: '16px',\n        color: '#ecf0f1',\n        stroke: '#000000',\n        strokeThickness: 3,\n      }\n    );\n    this.instructionText.setOrigin(0.5);\n    this.instructionText.setScrollFactor(0);\n    this.instructionText.setDepth(200);\n\n    // Camera reticle (hidden by default)\n    this.cameraReticle = this.add.sprite(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      'ui_camera_reticle'\n    );\n    this.cameraReticle.setScrollFactor(0);\n    this.cameraReticle.setDepth(250);\n    this.cameraReticle.setVisible(false);\n    this.cameraReticle.setAlpha(0.7);\n\n    // Photo result text\n    this.photoResultText = this.add.text(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2 + 100,\n      '',\n      {\n        fontSize: '24px',\n        color: '#f39c12',\n        fontStyle: 'bold',\n        stroke: '#000000',\n        strokeThickness: 4,\n        align: 'center',\n      }\n    );\n    this.photoResultText.setOrigin(0.5);\n    this.photoResultText.setScrollFactor(0);\n    this.photoResultText.setDepth(260);\n    this.photoResultText.setVisible(false);\n  }\n\n  private createTerrain(): void {\n    // Clear existing terrain\n    this.terrainTiles.forEach(tile => tile.destroy());\n    this.obstacles.forEach(obs => obs.destroy());\n    this.terrainTiles = [];\n    this.obstacles = [];\n\n    const layer = this.mountainGenerator.getLayer(this.currentLayer);\n    if (!layer) return;\n\n    const terrain = layer.terrain;\n\n    for (let ty = 0; ty < terrain.length; ty++) {\n      for (let tx = 0; tx < terrain[0].length; tx++) {\n        const tile = terrain[ty][tx];\n\n        // Calculate world position with wrapping\n        const worldX = tx * this.TILE_SIZE;\n        const worldY = ty * this.TILE_SIZE;\n\n        // Create tile sprite based on type\n        let tileKey = '';\n        switch (tile.type) {\n          case 'snow':\n            tileKey = `snow_${tile.color}`;\n            break;\n          case 'ice':\n            tileKey = 'ice';\n            break;\n          case 'rock':\n            tileKey = 'rock';\n            break;\n          case 'ramp':\n            tileKey = 'ramp';\n            break;\n          case 'tree':\n            tileKey = `tree_${tile.variant}`;\n            break;\n          case 'obstacle':\n            tileKey = 'rock';\n            break;\n        }\n\n        if (tileKey) {\n          const tileSprite = this.add.sprite(worldX, worldY, tileKey);\n          tileSprite.setOrigin(0, 0);\n\n          if (tile.type === 'tree') {\n            tileSprite.setDepth(50);\n            this.obstacles.push(tileSprite);\n          } else if (tile.type === 'obstacle') {\n            tileSprite.setDepth(40);\n            this.obstacles.push(tileSprite);\n          } else {\n            tileSprite.setDepth(0);\n          }\n\n          this.worldContainer.add(tileSprite);\n          this.terrainTiles.push(tileSprite);\n        }\n      }\n    }\n  }\n\n  private updateTerrain(): void {\n    // Update terrain tiles for current layer\n    const newLayer = this.mountainGenerator.getLayerIndexForY(this.playerY);\n\n    if (newLayer !== this.currentLayer) {\n      this.currentLayer = newLayer;\n      this.createTerrain();\n    }\n\n    // Handle horizontal wrapping\n    const layer = this.mountainGenerator.getLayer(this.currentLayer);\n    if (!layer) return;\n\n    const circumference = layer.circumference;\n\n    // Wrap player X position\n    if (this.playerX < 0) {\n      this.playerX += circumference;\n    } else if (this.playerX >= circumference) {\n      this.playerX -= circumference;\n    }\n\n    // Update world container position for scrolling\n    const centerX = this.cameras.main.width / 2;\n    const centerY = this.cameras.main.height / 2;\n\n    // Smooth camera following\n    const targetX = centerX - this.playerX;\n    const targetY = centerY - this.playerY;\n\n    this.worldContainer.x += (targetX - this.worldContainer.x) * this.CAMERA_SMOOTHNESS;\n    this.worldContainer.y += (targetY - this.worldContainer.y) * this.CAMERA_SMOOTHNESS;\n  }\n\n  private handleMovement(_delta: number): void {\n    let moving = false;\n    let dx = 0;\n    let dy = 0;\n\n    // WASD movement\n    if (this.wasdKeys.W.isDown) {\n      dy = -this.MOVE_SPEED;\n      moving = true;\n    } else if (this.wasdKeys.S.isDown) {\n      dy = this.MOVE_SPEED;\n      moving = true;\n    }\n\n    if (this.wasdKeys.A.isDown) {\n      dx = -this.MOVE_SPEED;\n      moving = true;\n    } else if (this.wasdKeys.D.isDown) {\n      dx = this.MOVE_SPEED;\n      moving = true;\n    }\n\n    // Apply movement\n    if (moving) {\n      this.playerX += dx;\n      this.playerY += dy;\n\n      // Drain stamina\n      const staminaMultiplier = 1 - (this.gameState.getUpgrade('personal', 'attendLegDay') * 0.15);\n      const ngpBonus = this.gameState.getState().newGamePlus.active\n        ? this.gameState.getState().newGamePlus.bonuses.climb\n        : 0;\n      const finalDrain = this.staminaDrainRate * staminaMultiplier * (1 - ngpBonus);\n\n      this.stamina = Math.max(0, this.stamina - finalDrain);\n      this.lastMovementTime = this.time.now;\n\n      // Check stamina depletion\n      if (this.stamina <= 0) {\n        this.outOfStamina();\n      }\n    }\n\n    // Camera reticle control\n    if (this.cursors.left!.isDown) {\n      this.reticleAngle -= 2;\n    } else if (this.cursors.right!.isDown) {\n      this.reticleAngle += 2;\n    }\n\n    if (this.cursors.up!.isDown) {\n      this.reticleAltitudeLine = Math.max(0, this.reticleAltitudeLine - 1);\n    } else if (this.cursors.down!.isDown) {\n      this.reticleAltitudeLine = Math.min(100, this.reticleAltitudeLine + 1);\n    }\n\n    // Update reticle rotation\n    this.cameraReticle.setAngle(this.reticleAngle);\n  }\n\n  private scheduleNextAnimalSpawn(): void {\n    const delay = Phaser.Math.Between(this.ANIMAL_SPAWN_MIN, this.ANIMAL_SPAWN_MAX);\n    this.time.delayedCall(delay, () => {\n      this.spawnAnimal();\n      this.scheduleNextAnimalSpawn();\n    });\n  }\n\n  private spawnAnimal(): void {\n    const layer = this.mountainGenerator.getLayer(this.currentLayer);\n    if (!layer) return;\n\n    const types: Animal['type'][] = ['bear', 'bird', 'mountainlion', 'deer', 'fox'];\n    const rarities: Record<Animal['type'], number> = {\n      'deer': 1.0,\n      'fox': 0.8,\n      'bird': 0.7,\n      'bear': 0.5,\n      'mountainlion': 0.3,\n    };\n\n    const type = Phaser.Utils.Array.GetRandom(types);\n    const rarity = rarities[type];\n\n    // Random position around player\n    const angle = Math.random() * Math.PI * 2;\n    const distance = 200 + Math.random() * 300;\n    const offsetX = Math.cos(angle) * distance;\n    const offsetY = Math.sin(angle) * distance;\n\n    const animal: Animal = {\n      type,\n      position: {\n        x: this.playerX + offsetX,\n        y: this.playerY + offsetY,\n      },\n      altitude: this.playerY + offsetY,\n      moving: Math.random() > 0.5,\n      speed: 0.5 + Math.random() * 1.5,\n      photographed: 0,\n      rarity,\n    };\n\n    this.animals.push(animal);\n\n    // Create sprite\n    const sprite = this.add.sprite(\n      animal.position.x,\n      animal.position.y,\n      `animal_${type}`\n    );\n    sprite.setScale(2);\n    sprite.setDepth(60);\n    this.worldContainer.add(sprite);\n    this.animalSprites.set(animal, sprite);\n\n    // Remove animal after 15 seconds\n    this.time.delayedCall(15000, () => {\n      this.removeAnimal(animal);\n    });\n  }\n\n  private removeAnimal(animal: Animal): void {\n    const index = this.animals.indexOf(animal);\n    if (index > -1) {\n      this.animals.splice(index, 1);\n    }\n\n    const sprite = this.animalSprites.get(animal);\n    if (sprite) {\n      sprite.destroy();\n      this.animalSprites.delete(animal);\n    }\n  }\n\n  private updateAnimals(_delta: number): void {\n    this.animals.forEach(animal => {\n      if (animal.moving) {\n        // Simple random movement\n        const moveAngle = Math.random() * Math.PI * 2;\n        animal.position.x += Math.cos(moveAngle) * animal.speed;\n        animal.position.y += Math.sin(moveAngle) * animal.speed;\n        animal.altitude = animal.position.y;\n\n        // Update sprite position\n        const sprite = this.animalSprites.get(animal);\n        if (sprite) {\n          sprite.x = animal.position.x;\n          sprite.y = animal.position.y;\n\n          // Flip sprite based on movement direction\n          if (Math.abs(Math.cos(moveAngle)) > 0.5) {\n            sprite.setFlipX(Math.cos(moveAngle) < 0);\n          }\n        }\n      }\n    });\n  }\n\n  private takePhoto(): void {\n    if (this.animals.length === 0) {\n      this.showPhotoResult('No animals in range!', 0);\n      return;\n    }\n\n    // Show camera reticle briefly\n    this.cameraReticle.setVisible(true);\n\n    // Check if any animal is in camera view\n    const centerX = this.cameras.main.width / 2;\n    const centerY = this.cameras.main.height / 2;\n    const reticleRadius = 40;\n\n    let bestMatch: { animal: Animal; score: number } | null = null;\n\n    for (let i = 0; i < this.animals.length; i++) {\n      const animal = this.animals[i];\n      const sprite = this.animalSprites.get(animal);\n      if (!sprite) continue;\n\n      // Convert animal world position to screen position\n      const screenX = sprite.x + this.worldContainer.x;\n      const screenY = sprite.y + this.worldContainer.y;\n\n      // Check if in reticle range\n      const dx = screenX - centerX;\n      const dy = screenY - centerY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      if (distance < reticleRadius * 2) {\n        // Calculate score based on various factors\n        const centeringScore = 1 - (distance / (reticleRadius * 2));\n\n        // Altitude match (reticleAltitudeLine is 0-100, map to screen height)\n        const targetAltitude = this.playerY + ((this.reticleAltitudeLine - 50) * 10);\n        const altitudeDiff = Math.abs(animal.altitude - targetAltitude);\n        const altitudeScore = Math.max(0, 1 - (altitudeDiff / 100));\n\n        // Movement bonus (moving animals are worth more)\n        const movementBonus = animal.moving ? 1.5 : 1.0;\n\n        // Rarity multiplier\n        const rarityBonus = 1 + (1 - animal.rarity);\n\n        const totalScore = centeringScore * altitudeScore * movementBonus * rarityBonus;\n\n        if (!bestMatch || totalScore > bestMatch.score) {\n          bestMatch = { animal, score: totalScore };\n        }\n      }\n    }\n\n    if (bestMatch) {\n      const animal = bestMatch.animal;\n\n      // Calculate earnings\n      const baseValue = 50;\n      const rarityMultiplier = 1 + (1 - animal.rarity) * 2; // Rarer = more money\n      const scoreMultiplier = bestMatch.score;\n\n      // Repeat penalty\n      const timesPhotographed = this.photographedAnimals.get(animal.type) || 0;\n      const repeatPenalty = Math.max(0.2, 1 - (timesPhotographed * 0.3));\n      this.photographedAnimals.set(animal.type, timesPhotographed + 1);\n\n      const earnings = Math.floor(baseValue * rarityMultiplier * scoreMultiplier * repeatPenalty);\n\n      // Add money and update stats\n      this.gameState.addMoney(earnings);\n      this.gameState.incrementStat('totalPhotos', 1);\n\n      // Show result\n      const quality = bestMatch.score > 0.8 ? 'Excellent' : bestMatch.score > 0.5 ? 'Good' : 'Fair';\n      this.showPhotoResult(\n        `${quality} photo of ${animal.type}!\\n+$${earnings}\\n(${timesPhotographed > 0 ? 'Repeat -' + Math.floor((1 - repeatPenalty) * 100) + '%' : 'First photo!'})`,\n        earnings\n      );\n\n      // Mark animal as photographed\n      animal.photographed++;\n\n      // Remove animal after being photographed\n      this.time.delayedCall(500, () => {\n        this.removeAnimal(animal);\n      });\n    } else {\n      this.showPhotoResult('No animal in frame!', 0);\n    }\n\n    // Hide reticle after delay\n    this.time.delayedCall(1000, () => {\n      this.cameraReticle.setVisible(false);\n    });\n  }\n\n  private showPhotoResult(message: string, earnings: number): void {\n    this.photoResultText.setText(message);\n    this.photoResultText.setVisible(true);\n\n    if (earnings > 0) {\n      this.photoResultText.setColor('#2ecc71'); // Green for success\n    } else {\n      this.photoResultText.setColor('#e74c3c'); // Red for failure\n    }\n\n    // Fade out after 2 seconds\n    this.time.delayedCall(2000, () => {\n      this.tweens.add({\n        targets: this.photoResultText,\n        alpha: 0,\n        duration: 500,\n        onComplete: () => {\n          this.photoResultText.setVisible(false);\n          this.photoResultText.setAlpha(1);\n        },\n      });\n    });\n  }\n\n  private updateUI(): void {\n    // Update stamina bar\n    this.staminaBar.clear();\n    const barWidth = 200;\n    const barHeight = 20;\n    const barX = this.cameras.main.width / 2 - barWidth / 2;\n    const barY = 20;\n\n    const fillWidth = (this.stamina / 100) * barWidth;\n\n    // Color based on stamina level\n    let color = 0x27ae60; // Green\n    if (this.stamina < 30) {\n      color = 0xe74c3c; // Red\n    } else if (this.stamina < 60) {\n      color = 0xf39c12; // Orange\n    }\n\n    this.staminaBar.fillStyle(color, 1);\n    this.staminaBar.fillRoundedRect(barX, barY, fillWidth, barHeight, 5);\n\n    this.staminaText.setText(`Stamina: ${Math.floor(this.stamina)}`);\n\n    // Update money\n    this.moneyText.setText(`Money: $${this.gameState.getMoney()}`);\n\n    // Update altitude\n    this.altitudeText.setText(`Altitude: ${Math.floor(this.playerY)}m | Layer: ${this.currentLayer}`);\n  }\n\n  private outOfStamina(): void {\n    // Save position\n    this.gameState.setState({\n      playerPosition: {\n        x: this.playerX,\n        y: this.playerY,\n        layer: this.currentLayer,\n      },\n      stamina: 0,\n    });\n\n    // Apply penalty (lose some money)\n    const penalty = Math.floor(this.gameState.getMoney() * 0.1); // 10% penalty\n    this.gameState.spendMoney(penalty);\n\n    // Show message\n    const messageText = this.add.text(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      `Out of Stamina!\\nLost $${penalty}\\nReturning home...`,\n      {\n        fontSize: '32px',\n        color: '#e74c3c',\n        fontStyle: 'bold',\n        stroke: '#000000',\n        strokeThickness: 6,\n        align: 'center',\n      }\n    );\n    messageText.setOrigin(0.5);\n    messageText.setScrollFactor(0);\n    messageText.setDepth(300);\n\n    // Transition to house\n    this.time.delayedCall(2000, () => {\n      this.cameras.main.fadeOut(500, 0, 0, 0);\n      this.cameras.main.once('camerafadeoutcomplete', () => {\n        this.scene.start('HouseScene');\n      });\n    });\n  }\n\n  private startDownhillRun(): void {\n    // Save position\n    this.gameState.setState({\n      playerPosition: {\n        x: this.playerX,\n        y: this.playerY,\n        layer: this.currentLayer,\n      },\n      stamina: this.stamina,\n    });\n\n    // Update highest altitude stat\n    const stats = this.gameState.getStats();\n    if (this.playerY > stats.highestAltitude) {\n      this.gameState.incrementStat('highestAltitude', this.playerY - stats.highestAltitude);\n    }\n\n    // Transition to downhill scene\n    this.cameras.main.fadeOut(500, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('DownhillScene');\n    });\n  }\n\n  private returnToHouse(): void {\n    // Save position and stamina\n    this.gameState.setState({\n      playerPosition: {\n        x: this.playerX,\n        y: this.playerY,\n        layer: this.currentLayer,\n      },\n      stamina: this.stamina,\n    });\n\n    // Transition to house\n    this.cameras.main.fadeOut(500, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('HouseScene');\n    });\n  }\n\n  update(time: number, delta: number): void {\n    // Handle movement\n    this.handleMovement(delta);\n\n    // Update terrain scrolling\n    this.updateTerrain();\n\n    // Update animals\n    this.updateAnimals(delta);\n\n    // Update UI\n    this.updateUI();\n\n    // Regenerate stamina when not moving (slowly)\n    if (time - this.lastMovementTime > 1000 && this.stamina < 100) {\n      const regenRate = 0.05; // Slower than drain\n      this.stamina = Math.min(100, this.stamina + regenRate);\n    }\n  }\n}\n","export interface GameState {\n  money: number;\n  loan: number;\n  stamina: number;\n  maxStamina: number;\n  playerPosition: { x: number; y: number; layer: number };\n  mountainSeed: string;\n  currentDay: number;\n  upgrades: UpgradeState;\n  stats: GameStats;\n  newGamePlus: NewGamePlusState;\n}\n\nexport interface UpgradeState {\n  personal: {\n    rocketSurgery: number;\n    optimalOptics: number;\n    sledDurability: number;\n    fancierFootwear: number;\n    attendLegDay: number;\n    crowdHypeman: number;\n    crowdWeaver: number;\n    weatherWarrior: number;\n  };\n  mountain: {\n    skiLifts: number;\n    snowmobileRentals: number;\n    foodStalls: number;\n    groomedTrails: number;\n    firstAidStations: number;\n    scenicOverlooks: number;\n  };\n}\n\nexport interface GameStats {\n  totalRuns: number;\n  totalTricks: number;\n  totalPhotos: number;\n  bestTime: number;\n  highestAltitude: number;\n  totalCollisions: number;\n}\n\nexport interface NewGamePlusState {\n  active: boolean;\n  bonuses: {\n    speed: number;\n    trickery: number;\n    resilience: number;\n    climb: number;\n    charisma: number;\n    rhythm: number;\n  };\n}\n\nexport interface MountainLayer {\n  index: number;\n  circumference: number;\n  heightRange: { min: number; max: number };\n  terrain: TerrainTile[][];\n}\n\nexport interface TerrainTile {\n  type: 'snow' | 'ice' | 'rock' | 'tree' | 'ramp' | 'obstacle';\n  altitude: number;\n  color: number;\n  variant: number;\n}\n\nexport interface Trick {\n  name: string;\n  input: string[];\n  value: number;\n  description: string;\n  emoji: string;\n  animationFrames: number[];\n}\n\nexport interface Animal {\n  type: 'bear' | 'bird' | 'mountainlion' | 'deer' | 'fox';\n  position: { x: number; y: number };\n  altitude: number;\n  moving: boolean;\n  speed: number;\n  photographed: number;\n  rarity: number;\n}\n\nexport interface PhotoResult {\n  success: boolean;\n  animal: Animal;\n  altitudeMatch: number;\n  centering: number;\n  movementBonus: number;\n  repeatPenalty: number;\n  totalEarnings: number;\n}\n\nexport const TRICKS: Trick[] = [\n  { name: 'Parachute', input: ['UP', 'DOWN'], value: 50, description: 'Hold sled overhead like a parachute', emoji: '', animationFrames: [0, 1, 2] },\n  { name: 'Air Brake', input: ['UP', 'UP'], value: 40, description: 'Use sled as air brake', emoji: '', animationFrames: [3, 4, 5] },\n  { name: 'Sled Flip Back', input: ['DOWN', 'LEFT'], value: 80, description: 'Full backward flip', emoji: '', animationFrames: [6, 7, 8] },\n  { name: 'Sled Flip Front', input: ['DOWN', 'RIGHT'], value: 80, description: 'Forward flip with rotation', emoji: '', animationFrames: [9, 10, 11] },\n  { name: 'Helicopter Spin Left', input: ['LEFT', 'LEFT'], value: 60, description: 'Spin horizontally left', emoji: '', animationFrames: [12, 13, 14] },\n  { name: 'Helicopter Spin Right', input: ['RIGHT', 'RIGHT'], value: 60, description: 'Spin horizontally right', emoji: '', animationFrames: [15, 16, 17] },\n  { name: 'Superman', input: ['DOWN', 'DOWN'], value: 70, description: 'Extend arms like Superman', emoji: '', animationFrames: [18, 19, 20] },\n  { name: 'Sky Dive Roll Right', input: ['UP', 'RIGHT'], value: 90, description: 'Roll right in mid-air', emoji: '', animationFrames: [21, 22, 23] },\n  { name: 'Sky Dive Roll Left', input: ['UP', 'LEFT'], value: 90, description: 'Roll left in mid-air', emoji: '', animationFrames: [24, 25, 26] },\n  { name: 'Ghost Rider', input: ['LEFT', 'RIGHT'], value: 100, description: 'Push sled away and grab back', emoji: '', animationFrames: [27, 28, 29] },\n  { name: 'Toboggan Toss', input: ['RIGHT', 'LEFT'], value: 100, description: '360 spin and land back on sled', emoji: '', animationFrames: [30, 31, 32] },\n  { name: 'Corkscrew Right', input: ['RIGHT', 'DOWN'], value: 110, description: 'Diagonal barrel roll right', emoji: '', animationFrames: [33, 34, 35] },\n  { name: 'Corkscrew Left', input: ['LEFT', 'DOWN'], value: 110, description: 'Diagonal barrel roll left', emoji: '', animationFrames: [36, 37, 38] },\n  { name: 'Falling Star', input: ['DOWN', 'UP'], value: 85, description: 'Star pose in mid-air', emoji: '', animationFrames: [39, 40, 41] },\n  { name: 'Orbit Spin Clockwise', input: ['RIGHT', 'UP'], value: 120, description: '360 clockwise orbit', emoji: '', animationFrames: [42, 43, 44] },\n  { name: 'Orbit Spin Counterwise', input: ['LEFT', 'UP'], value: 120, description: '360 counterclockwise orbit', emoji: '', animationFrames: [45, 46, 47] },\n];\n\nexport const UPGRADE_COSTS = {\n  personal: {\n    rocketSurgery: [100, 250, 500, 1000, 2000],\n    optimalOptics: [150, 300, 600, 1200, 2400],\n    sledDurability: [200, 400, 800, 1600, 3200],\n    fancierFootwear: [100, 200, 400, 800, 1600],\n    attendLegDay: [150, 300, 600, 1200, 2400],\n    crowdHypeman: [300, 600, 1200, 2400, 4800],\n    crowdWeaver: [250, 500, 1000, 2000, 4000],\n    weatherWarrior: [400, 800, 1600, 3200, 6400],\n  },\n  mountain: {\n    skiLifts: [500, 1000, 2000, 4000, 8000],\n    snowmobileRentals: [800, 1600, 3200, 6400, 12800],\n    foodStalls: [300, 600, 1200, 2400, 4800],\n    groomedTrails: [400, 800, 1600, 3200, 6400],\n    firstAidStations: [600, 1200, 2400, 4800, 9600],\n    scenicOverlooks: [350, 700, 1400, 2800, 5600],\n  },\n};\n","import Phaser from 'phaser';\nimport { Trick, TRICKS } from '../types';\n\ninterface TrickFeedback {\n  name: string;\n  emoji: string;\n  value: number;\n  multiplier: number;\n}\n\nexport class TrickSystem {\n  private scene: Phaser.Scene;\n  private inputQueue: string[] = [];\n  private maxQueueSize: number = 2;\n  private lastInputTime: number = 0;\n  private inputTimeout: number = 1000; // ms between inputs before queue resets\n\n  // Combo system\n  private comboCount: number = 0;\n  private comboMultiplier: number = 1;\n  private maxComboMultiplier: number = 5;\n  private lastTrickTime: number = 0;\n  private comboTimeout: number = 2000; // ms to maintain combo\n\n  // Visual feedback\n  private feedbackText?: Phaser.GameObjects.Text;\n  private comboText?: Phaser.GameObjects.Text;\n\n  // Trick tracking\n  private currentTrick?: Trick;\n  private trickInProgress: boolean = false;\n\n  constructor(scene: Phaser.Scene) {\n    this.scene = scene;\n    this.setupFeedbackDisplay();\n  }\n\n  private setupFeedbackDisplay(): void {\n    // Create text objects for visual feedback\n    this.feedbackText = this.scene.add.text(\n      this.scene.cameras.main.width / 2,\n      200,\n      '',\n      {\n        fontSize: '48px',\n        color: '#FFD700',\n        stroke: '#000000',\n        strokeThickness: 6,\n        fontStyle: 'bold',\n      }\n    ).setOrigin(0.5).setDepth(1000);\n\n    this.comboText = this.scene.add.text(\n      this.scene.cameras.main.width / 2,\n      260,\n      '',\n      {\n        fontSize: '32px',\n        color: '#FF6B6B',\n        stroke: '#000000',\n        strokeThickness: 4,\n        fontStyle: 'bold',\n      }\n    ).setOrigin(0.5).setDepth(1000);\n  }\n\n  /**\n   * Add an input to the queue (called when arrow key is pressed during jump)\n   */\n  addInput(direction: string): void {\n    const currentTime = Date.now();\n\n    // Reset queue if too much time has passed\n    if (currentTime - this.lastInputTime > this.inputTimeout) {\n      this.inputQueue = [];\n    }\n\n    this.lastInputTime = currentTime;\n    this.inputQueue.push(direction);\n\n    // Keep queue at max size\n    if (this.inputQueue.length > this.maxQueueSize) {\n      this.inputQueue.shift();\n    }\n\n    // Try to match trick after each input\n    this.tryMatchTrick();\n  }\n\n  /**\n   * Try to match the current input queue against known tricks\n   */\n  private tryMatchTrick(): Trick | null {\n    if (this.inputQueue.length < 2) {\n      return null;\n    }\n\n    // Look for a matching trick\n    for (const trick of TRICKS) {\n      if (this.matchesInput(trick.input, this.inputQueue)) {\n        this.currentTrick = trick;\n        this.trickInProgress = true;\n        this.showTrickFeedback(trick, false);\n        return trick;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Check if input sequence matches trick requirement\n   */\n  private matchesInput(trickInput: string[], queueInput: string[]): boolean {\n    if (trickInput.length !== queueInput.length) {\n      return false;\n    }\n\n    for (let i = 0; i < trickInput.length; i++) {\n      if (trickInput[i] !== queueInput[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Complete the current trick (called when landing successfully)\n   */\n  completeTrick(): TrickFeedback | null {\n    if (!this.currentTrick) {\n      return null;\n    }\n\n    const currentTime = Date.now();\n\n    // Check if we're maintaining combo\n    if (currentTime - this.lastTrickTime < this.comboTimeout) {\n      this.comboCount++;\n      this.comboMultiplier = Math.min(\n        this.maxComboMultiplier,\n        1 + (this.comboCount * 0.5)\n      );\n    } else {\n      // Combo broken, reset\n      this.comboCount = 1;\n      this.comboMultiplier = 1;\n    }\n\n    this.lastTrickTime = currentTime;\n\n    const feedback: TrickFeedback = {\n      name: this.currentTrick.name,\n      emoji: this.currentTrick.emoji,\n      value: this.currentTrick.value,\n      multiplier: this.comboMultiplier,\n    };\n\n    this.showTrickFeedback(this.currentTrick, true);\n    this.updateComboDisplay();\n\n    // Reset trick state\n    this.currentTrick = undefined;\n    this.trickInProgress = false;\n    this.inputQueue = [];\n\n    return feedback;\n  }\n\n  /**\n   * Fail the current trick (called when crashing)\n   */\n  failTrick(): void {\n    if (this.currentTrick) {\n      this.showFailFeedback();\n    }\n\n    // Reset everything\n    this.currentTrick = undefined;\n    this.trickInProgress = false;\n    this.inputQueue = [];\n    this.comboCount = 0;\n    this.comboMultiplier = 1;\n    this.lastTrickTime = 0;\n    this.updateComboDisplay();\n  }\n\n  /**\n   * Reset the trick system\n   */\n  reset(): void {\n    this.inputQueue = [];\n    this.currentTrick = undefined;\n    this.trickInProgress = false;\n    this.comboCount = 0;\n    this.comboMultiplier = 1;\n    this.lastTrickTime = 0;\n    this.lastInputTime = 0;\n\n    if (this.feedbackText) {\n      this.feedbackText.setText('');\n    }\n    if (this.comboText) {\n      this.comboText.setText('');\n    }\n  }\n\n  /**\n   * Show visual feedback for trick\n   */\n  private showTrickFeedback(trick: Trick, completed: boolean): void {\n    if (!this.feedbackText) return;\n\n    const text = completed\n      ? `${trick.emoji} ${trick.name}! +$${Math.floor(trick.value * this.comboMultiplier)}`\n      : `${trick.emoji} ${trick.name}`;\n\n    this.feedbackText.setText(text);\n    this.feedbackText.setAlpha(1);\n\n    // Animate the text\n    this.scene.tweens.add({\n      targets: this.feedbackText,\n      y: this.feedbackText.y - 50,\n      alpha: 0,\n      duration: 2000,\n      ease: 'Power2',\n      onComplete: () => {\n        if (this.feedbackText) {\n          this.feedbackText.y += 50; // Reset position\n        }\n      }\n    });\n  }\n\n  /**\n   * Show failure feedback\n   */\n  private showFailFeedback(): void {\n    if (!this.feedbackText) return;\n\n    this.feedbackText.setText(' FAILED!');\n    this.feedbackText.setColor('#FF0000');\n    this.feedbackText.setAlpha(1);\n\n    this.scene.tweens.add({\n      targets: this.feedbackText,\n      alpha: 0,\n      duration: 1000,\n      ease: 'Power2',\n      onComplete: () => {\n        if (this.feedbackText) {\n          this.feedbackText.setColor('#FFD700');\n        }\n      }\n    });\n  }\n\n  /**\n   * Update combo display\n   */\n  private updateComboDisplay(): void {\n    if (!this.comboText) return;\n\n    if (this.comboCount > 1) {\n      this.comboText.setText(`COMBO x${this.comboMultiplier.toFixed(1)}`);\n      this.comboText.setAlpha(1);\n\n      // Pulse effect\n      this.scene.tweens.add({\n        targets: this.comboText,\n        scale: { from: 1.2, to: 1 },\n        duration: 300,\n        ease: 'Back.easeOut',\n      });\n    } else {\n      this.comboText.setText('');\n    }\n  }\n\n  /**\n   * Check if combo should expire\n   */\n  update(): void {\n    const currentTime = Date.now();\n\n    // Check for combo timeout\n    if (this.comboCount > 0 && currentTime - this.lastTrickTime > this.comboTimeout) {\n      this.comboCount = 0;\n      this.comboMultiplier = 1;\n      if (this.comboText) {\n        this.scene.tweens.add({\n          targets: this.comboText,\n          alpha: 0,\n          duration: 500,\n          onComplete: () => {\n            if (this.comboText) {\n              this.comboText.setText('');\n            }\n          }\n        });\n      }\n    }\n  }\n\n  /**\n   * Get current trick in progress\n   */\n  getCurrentTrick(): Trick | undefined {\n    return this.currentTrick;\n  }\n\n  /**\n   * Check if a trick is in progress\n   */\n  isTrickInProgress(): boolean {\n    return this.trickInProgress;\n  }\n\n  /**\n   * Get current combo multiplier\n   */\n  getComboMultiplier(): number {\n    return this.comboMultiplier;\n  }\n\n  /**\n   * Get combo count\n   */\n  getComboCount(): number {\n    return this.comboCount;\n  }\n\n  /**\n   * Destroy the trick system\n   */\n  destroy(): void {\n    if (this.feedbackText) {\n      this.feedbackText.destroy();\n    }\n    if (this.comboText) {\n      this.comboText.destroy();\n    }\n  }\n}\n","import Phaser from 'phaser';\nimport { MountainGenerator } from '../systems/MountainGenerator';\nimport { TrickSystem } from '../systems/TrickSystem';\nimport { GameStateManager } from '../utils/GameStateManager';\nimport { TerrainTile } from '../types';\n\ninterface Gate {\n  x: number;\n  y: number;\n  passed: boolean;\n  sprite?: Phaser.GameObjects.Rectangle;\n}\n\nexport class DownhillScene extends Phaser.Scene {\n  private mountainGenerator!: MountainGenerator;\n  private trickSystem!: TrickSystem;\n  private gameStateManager!: GameStateManager;\n\n  // Player\n  private player!: Phaser.GameObjects.Rectangle;\n  private playerVelocityX: number = 0;\n  private playerVelocityY: number = 0;\n  private playerSpeed: number = 0;\n  private isJumping: boolean = false;\n  private isOnGround: boolean = true;\n  private canJump: boolean = true;\n\n  // Physics constants\n  private readonly GRAVITY = 0.5;\n  private readonly MAX_SPEED = 15;\n  private readonly ACCELERATION = 0.3;\n  private readonly STEERING_SPEED = 5;\n  private readonly JUMP_POWER = -15;\n  private readonly FRICTION = 0.98;\n\n  // Terrain rendering\n  private terrainGraphics!: Phaser.GameObjects.Graphics;\n  private obstacleSprites: Phaser.GameObjects.Rectangle[] = [];\n\n  // Camera and scrolling\n  private worldStartY: number = 2000; // Start at high altitude\n  private currentLayer: number = 9; // Start at top layer\n\n  // Game state\n  private startTime: number = 0;\n  private currentTime: number = 0;\n  private moneyEarned: number = 0;\n  private tricksLanded: number = 0;\n  private collisions: number = 0;\n  private gates: Gate[] = [];\n  private gatesPassed: number = 0;\n  private runEnded: boolean = false;\n\n  // HUD elements\n  private hudGraphics!: Phaser.GameObjects.Graphics;\n  private speedText!: Phaser.GameObjects.Text;\n  private altitudeText!: Phaser.GameObjects.Text;\n  private moneyText!: Phaser.GameObjects.Text;\n  private timeText!: Phaser.GameObjects.Text;\n\n  // Input\n  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys;\n  private spaceKey!: Phaser.Input.Keyboard.Key;\n\n  // Durability (based on upgrades)\n  private currentDurability: number = 100;\n  private maxDurability: number = 100;\n\n  constructor() {\n    super({ key: 'DownhillScene' });\n  }\n\n  create(): void {\n    // Initialize managers\n    this.gameStateManager = GameStateManager.getInstance();\n    const gameState = this.gameStateManager.getState();\n\n    // Create mountain\n    this.mountainGenerator = new MountainGenerator(gameState.mountainSeed);\n\n    // Initialize trick system\n    this.trickSystem = new TrickSystem(this);\n\n    // Setup player\n    this.createPlayer();\n\n    // Setup terrain rendering\n    this.terrainGraphics = this.add.graphics();\n\n    // Setup camera\n    this.setupCamera();\n\n    // Create gates for time trial\n    this.createGates();\n\n    // Setup input\n    this.cursors = this.input.keyboard!.createCursorKeys();\n    this.spaceKey = this.input.keyboard!.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n\n    // Create HUD\n    this.createHUD();\n\n    // Calculate max durability based on upgrades\n    const durabilityLevel = this.gameStateManager.getUpgrade('personal', 'sledDurability');\n    this.maxDurability = 100 + (durabilityLevel * 50);\n    this.currentDurability = this.maxDurability;\n\n    // Start the run\n    this.startTime = Date.now();\n\n    // Fade in\n    this.cameras.main.fadeIn(500, 0, 0, 0);\n  }\n\n  private createPlayer(): void {\n    // Create a simple player representation (can be replaced with sprite later)\n    this.player = this.add.rectangle(200, this.worldStartY, 32, 32, 0x3498db);\n    this.player.setStrokeStyle(2, 0x2c3e50);\n\n    // Reset velocities\n    this.playerVelocityX = 0;\n    this.playerVelocityY = 0;\n    this.playerSpeed = 0;\n  }\n\n  private setupCamera(): void {\n    // Set camera bounds (we'll update as player descends)\n    this.cameras.main.setBounds(0, 0, 2000, 2000);\n\n    // Camera follows player with offset to show more of the descent\n    this.cameras.main.startFollow(this.player, true, 0.1, 0.1);\n    this.cameras.main.setFollowOffset(-300, 0); // Player on left side\n  }\n\n  private createGates(): void {\n    // Create time trial gates at intervals\n    for (let y = 1800; y > 200; y -= 300) {\n      this.gates.push({\n        x: 1000,\n        y: y,\n        passed: false,\n      });\n    }\n  }\n\n  private createHUD(): void {\n    // Create HUD background\n    this.hudGraphics = this.add.graphics();\n    this.hudGraphics.setScrollFactor(0);\n    this.hudGraphics.setDepth(999);\n\n    // Draw HUD background\n    this.hudGraphics.fillStyle(0x000000, 0.5);\n    this.hudGraphics.fillRect(10, 10, 300, 150);\n\n    // Create text elements\n    this.speedText = this.add.text(20, 20, 'Speed: 0 mph', {\n      fontSize: '20px',\n      color: '#ffffff',\n    }).setScrollFactor(0).setDepth(1000);\n\n    this.altitudeText = this.add.text(20, 50, 'Altitude: 2000 ft', {\n      fontSize: '20px',\n      color: '#ffffff',\n    }).setScrollFactor(0).setDepth(1000);\n\n    this.moneyText = this.add.text(20, 80, 'Earned: $0', {\n      fontSize: '20px',\n      color: '#FFD700',\n    }).setScrollFactor(0).setDepth(1000);\n\n    this.timeText = this.add.text(20, 110, 'Time: 0.0s', {\n      fontSize: '20px',\n      color: '#ffffff',\n    }).setScrollFactor(0).setDepth(1000);\n\n    // Durability bar\n    this.add.text(20, 140, 'Durability:', {\n      fontSize: '18px',\n      color: '#ffffff',\n    }).setScrollFactor(0).setDepth(1000);\n  }\n\n  update(_time: number, _delta: number): void {\n    if (this.runEnded) return;\n\n    // Update systems\n    this.trickSystem.update();\n\n    // Update current time\n    this.currentTime = Date.now() - this.startTime;\n\n    // Handle input\n    this.handleInput();\n\n    // Apply physics\n    this.applyPhysics();\n\n    // Update player position\n    this.player.x += this.playerVelocityX;\n    this.player.y += this.playerVelocityY;\n\n    // Wrap player around horizontally (cylindrical mountain)\n    const currentLayerData = this.mountainGenerator.getLayer(this.currentLayer);\n    if (currentLayerData && this.player.x > currentLayerData.circumference) {\n      this.player.x = 0;\n    } else if (this.player.x < 0) {\n      this.player.x = currentLayerData ? currentLayerData.circumference : 2000;\n    }\n\n    // Check ground collision\n    this.checkGroundCollision();\n\n    // Check obstacle collision\n    this.checkObstacleCollision();\n\n    // Check gates\n    this.checkGates();\n\n    // Update HUD\n    this.updateHUD();\n\n    // Render terrain\n    this.renderTerrain();\n\n    // Check for run end\n    if (this.player.y <= 50) {\n      this.endRun();\n    }\n\n    // Update current layer based on altitude\n    const newLayer = this.mountainGenerator.getLayerIndexForY(this.player.y);\n    if (newLayer !== this.currentLayer) {\n      this.currentLayer = newLayer;\n    }\n  }\n\n  private handleInput(): void {\n    // Steering (left/right)\n    if (this.cursors.left.isDown) {\n      if (this.isJumping) {\n        // Add trick input\n        this.trickSystem.addInput('LEFT');\n      } else {\n        // Steer left\n        this.playerVelocityX -= this.STEERING_SPEED * 0.1;\n      }\n    }\n\n    if (this.cursors.right.isDown) {\n      if (this.isJumping) {\n        // Add trick input\n        this.trickSystem.addInput('RIGHT');\n      } else {\n        // Steer right\n        this.playerVelocityX += this.STEERING_SPEED * 0.1;\n      }\n    }\n\n    // Jump\n    if (Phaser.Input.Keyboard.JustDown(this.spaceKey) && this.canJump && this.isOnGround) {\n      this.jump();\n    }\n\n    // Trick inputs (only while jumping)\n    if (this.isJumping) {\n      if (Phaser.Input.Keyboard.JustDown(this.cursors.up)) {\n        this.trickSystem.addInput('UP');\n      }\n      if (Phaser.Input.Keyboard.JustDown(this.cursors.down)) {\n        this.trickSystem.addInput('DOWN');\n      }\n    }\n  }\n\n  private applyPhysics(): void {\n    // Gravity (always pulling down)\n    this.playerVelocityY += this.GRAVITY;\n\n    // Speed increases as we descend (acceleration from gravity)\n    if (!this.isJumping && this.isOnGround) {\n      // Get slope information from terrain\n      const tile = this.getTileAtPlayer();\n\n      // Accelerate downhill\n      const slopeAcceleration = this.ACCELERATION;\n      this.playerSpeed += slopeAcceleration;\n\n      // Speed bonus from upgrades\n      const rocketLevel = this.gameStateManager.getUpgrade('personal', 'rocketSurgery');\n      const speedBonus = 1 + (rocketLevel * 0.1);\n      this.playerSpeed = Math.min(this.MAX_SPEED * speedBonus, this.playerSpeed);\n\n      // Apply speed to downward velocity\n      this.playerVelocityY = Math.max(this.playerVelocityY, this.playerSpeed * 0.5);\n\n      // Ice terrain increases speed\n      if (tile && tile.type === 'ice') {\n        this.playerSpeed *= 1.1;\n      }\n    }\n\n    // Apply friction to horizontal velocity\n    this.playerVelocityX *= this.FRICTION;\n\n    // Clamp velocities\n    this.playerVelocityX = Math.max(-this.STEERING_SPEED, Math.min(this.STEERING_SPEED, this.playerVelocityX));\n\n    // Rotation based on velocity\n    const rotation = this.playerVelocityX * 0.1;\n    this.player.setRotation(rotation);\n  }\n\n  private jump(): void {\n    this.playerVelocityY = this.JUMP_POWER;\n    this.isJumping = true;\n    this.isOnGround = false;\n    this.canJump = false;\n\n    // Leg day upgrade increases jump power\n    const legLevel = this.gameStateManager.getUpgrade('personal', 'attendLegDay');\n    this.playerVelocityY *= (1 + legLevel * 0.1);\n  }\n\n  private checkGroundCollision(): void {\n    const tile = this.getTileAtPlayer();\n    if (!tile) return;\n\n    // Simple collision: check if player is at or below terrain level\n    const tileY = Math.floor(this.player.y / 32) * 32;\n    const playerBottom = this.player.y + 16;\n\n    if (playerBottom >= tileY && this.playerVelocityY > 0) {\n      // Landing\n      if (this.isJumping) {\n        this.land(tile);\n      }\n\n      this.isOnGround = true;\n      this.canJump = true;\n      this.player.y = tileY - 16;\n      this.playerVelocityY = 0;\n    } else {\n      this.isOnGround = false;\n    }\n  }\n\n  private land(_tile: TerrainTile): void {\n    // Check if we were doing a trick\n    if (this.trickSystem.isTrickInProgress()) {\n      const trickFeedback = this.trickSystem.completeTrick();\n\n      if (trickFeedback) {\n        // Calculate earnings\n        const earnings = Math.floor(trickFeedback.value * trickFeedback.multiplier);\n\n        // Crowd hypeman upgrade increases earnings\n        const hypeLevel = this.gameStateManager.getUpgrade('personal', 'crowdHypeman');\n        const finalEarnings = Math.floor(earnings * (1 + hypeLevel * 0.15));\n\n        this.moneyEarned += finalEarnings;\n        this.tricksLanded++;\n      }\n    }\n\n    this.isJumping = false;\n    this.trickSystem.reset();\n  }\n\n  private checkObstacleCollision(): void {\n    const tile = this.getTileAtPlayer();\n\n    if (!tile) return;\n\n    // Check for collision with obstacles\n    if (tile.type === 'tree' || tile.type === 'obstacle' || tile.type === 'rock') {\n      this.crash();\n    }\n  }\n\n  private crash(): void {\n    // Calculate damage based on speed\n    const damage = Math.floor(this.playerSpeed * 5);\n    this.currentDurability -= damage;\n    this.collisions++;\n\n    // Fail any trick in progress\n    if (this.trickSystem.isTrickInProgress()) {\n      this.trickSystem.failTrick();\n    }\n\n    // Reduce speed\n    this.playerSpeed *= 0.5;\n    this.playerVelocityY *= 0.5;\n\n    // Visual feedback\n    this.cameras.main.shake(200, 0.01);\n    const originalColor = this.player.fillColor;\n    this.player.setFillStyle(0xff0000);\n    this.time.delayedCall(200, () => {\n      this.player.setFillStyle(originalColor);\n    });\n\n    // Check if sled is destroyed\n    if (this.currentDurability <= 0) {\n      this.sledDestroyed();\n    }\n  }\n\n  private sledDestroyed(): void {\n    // End run with penalty\n    this.moneyEarned = Math.floor(this.moneyEarned * 0.5); // Lose half earnings\n    this.endRun();\n  }\n\n  private checkGates(): void {\n    for (const gate of this.gates) {\n      if (!gate.passed && Math.abs(this.player.y - gate.y) < 50) {\n        if (Math.abs(this.player.x - gate.x) < 100) {\n          gate.passed = true;\n          this.gatesPassed++;\n\n          // Time bonus\n          const timeBonus = 50;\n          this.moneyEarned += timeBonus;\n\n          // Visual feedback\n          this.showGatePassedFeedback();\n        }\n      }\n    }\n  }\n\n  private showGatePassedFeedback(): void {\n    const text = this.add.text(\n      this.cameras.main.width / 2,\n      150,\n      ' Gate! +$50',\n      {\n        fontSize: '32px',\n        color: '#00ff00',\n        stroke: '#000000',\n        strokeThickness: 4,\n      }\n    ).setOrigin(0.5).setScrollFactor(0).setDepth(1000);\n\n    this.tweens.add({\n      targets: text,\n      alpha: 0,\n      duration: 1500,\n      onComplete: () => text.destroy()\n    });\n  }\n\n  private getTileAtPlayer(): TerrainTile | undefined {\n    return this.mountainGenerator.getTileAt(this.player.x, this.player.y, this.currentLayer);\n  }\n\n  private renderTerrain(): void {\n    this.terrainGraphics.clear();\n\n    // Clean up old obstacle sprites\n    this.obstacleSprites.forEach(sprite => sprite.destroy());\n    this.obstacleSprites = [];\n\n    const cam = this.cameras.main;\n    const visibleArea = {\n      x: cam.scrollX,\n      y: cam.scrollY,\n      width: cam.width,\n      height: cam.height,\n    };\n\n    // Get current layer\n    const layer = this.mountainGenerator.getLayer(this.currentLayer);\n    if (!layer) return;\n\n    // Render visible terrain tiles\n    const tileSize = 32;\n    const startX = Math.floor(visibleArea.x / tileSize);\n    const endX = Math.ceil((visibleArea.x + visibleArea.width) / tileSize);\n    const startY = Math.floor(visibleArea.y / tileSize);\n    const endY = Math.ceil((visibleArea.y + visibleArea.height) / tileSize);\n\n    for (let y = startY; y <= endY; y++) {\n      for (let x = startX; x <= endX; x++) {\n        const tile = this.mountainGenerator.getTileAt(x * tileSize, y * tileSize, this.currentLayer);\n        if (!tile) continue;\n\n        const screenX = x * tileSize;\n        const screenY = y * tileSize;\n\n        // Render based on tile type\n        let color = 0xffffff; // snow\n        switch (tile.type) {\n          case 'ice':\n            color = 0x87ceeb;\n            break;\n          case 'rock':\n            color = 0x808080;\n            break;\n          case 'tree':\n            color = 0x228b22;\n            break;\n          case 'ramp':\n            color = 0xffff00;\n            break;\n          case 'obstacle':\n            color = 0x8b4513;\n            break;\n        }\n\n        this.terrainGraphics.fillStyle(color, 1);\n        this.terrainGraphics.fillRect(screenX, screenY, tileSize, tileSize);\n\n        // Draw obstacles as sprites for better visibility\n        if (tile.type === 'tree' || tile.type === 'obstacle' || tile.type === 'rock') {\n          const obstacle = this.add.rectangle(screenX + 16, screenY + 16, tileSize, tileSize, color);\n          obstacle.setStrokeStyle(2, 0x000000);\n          this.obstacleSprites.push(obstacle);\n        }\n      }\n    }\n\n    // Render gates\n    this.gates.forEach(gate => {\n      if (Math.abs(gate.y - this.player.y) < cam.height) {\n        const color = gate.passed ? 0x00ff00 : 0xff0000;\n        this.terrainGraphics.fillStyle(color, 0.5);\n        this.terrainGraphics.fillRect(gate.x - 50, gate.y - 5, 100, 10);\n      }\n    });\n  }\n\n  private updateHUD(): void {\n    // Update speed (convert to mph for display)\n    const mph = Math.floor(this.playerSpeed * 10);\n    this.speedText.setText(`Speed: ${mph} mph`);\n\n    // Update altitude\n    const altitude = Math.floor(this.player.y);\n    this.altitudeText.setText(`Altitude: ${altitude} ft`);\n\n    // Update money\n    this.moneyText.setText(`Earned: $${this.moneyEarned}`);\n\n    // Update time\n    const seconds = (this.currentTime / 1000).toFixed(1);\n    this.timeText.setText(`Time: ${seconds}s`);\n\n    // Update durability bar\n    this.hudGraphics.clear();\n    this.hudGraphics.fillStyle(0x000000, 0.5);\n    this.hudGraphics.fillRect(10, 10, 300, 180);\n\n    // Durability bar\n    const durabilityPercent = this.currentDurability / this.maxDurability;\n    const barWidth = 280 * durabilityPercent;\n    const barColor = durabilityPercent > 0.5 ? 0x00ff00 : durabilityPercent > 0.25 ? 0xffff00 : 0xff0000;\n\n    this.hudGraphics.fillStyle(0x333333, 1);\n    this.hudGraphics.fillRect(20, 165, 280, 20);\n    this.hudGraphics.fillStyle(barColor, 1);\n    this.hudGraphics.fillRect(20, 165, barWidth, 20);\n  }\n\n  private endRun(): void {\n    if (this.runEnded) return;\n    this.runEnded = true;\n\n    // Update game state\n    this.gameStateManager.addMoney(this.moneyEarned);\n    this.gameStateManager.incrementStat('totalRuns', 1);\n    this.gameStateManager.incrementStat('totalTricks', this.tricksLanded);\n    this.gameStateManager.incrementStat('totalCollisions', this.collisions);\n\n    // Check best time\n    const stats = this.gameStateManager.getStats();\n    if (this.currentTime < stats.bestTime || stats.bestTime === 0) {\n      this.gameStateManager.incrementStat('bestTime', this.currentTime - stats.bestTime);\n    }\n\n    // Show run summary\n    this.showRunSummary();\n  }\n\n  private showRunSummary(): void {\n    const cam = this.cameras.main;\n\n    // Create semi-transparent overlay\n    this.add.rectangle(\n      cam.scrollX + cam.width / 2,\n      cam.scrollY + cam.height / 2,\n      cam.width,\n      cam.height,\n      0x000000,\n      0.8\n    ).setDepth(2000);\n\n    // Summary box\n    this.add.rectangle(\n      cam.scrollX + cam.width / 2,\n      cam.scrollY + cam.height / 2,\n      600,\n      500,\n      0x2c3e50\n    ).setDepth(2001).setStrokeStyle(4, 0xffffff);\n\n    // Title\n    this.add.text(\n      cam.scrollX + cam.width / 2,\n      cam.scrollY + cam.height / 2 - 200,\n      'RUN COMPLETE!',\n      {\n        fontSize: '48px',\n        color: '#ffffff',\n        fontStyle: 'bold',\n      }\n    ).setOrigin(0.5).setDepth(2002);\n\n    // Stats\n    const stats = [\n      `Time: ${(this.currentTime / 1000).toFixed(1)}s`,\n      `Money Earned: $${this.moneyEarned}`,\n      `Tricks Landed: ${this.tricksLanded}`,\n      `Gates Passed: ${this.gatesPassed}/${this.gates.length}`,\n      `Collisions: ${this.collisions}`,\n      `Final Speed: ${Math.floor(this.playerSpeed * 10)} mph`,\n    ];\n\n    let yOffset = -100;\n    stats.forEach(stat => {\n      this.add.text(\n        cam.scrollX + cam.width / 2,\n        cam.scrollY + cam.height / 2 + yOffset,\n        stat,\n        {\n          fontSize: '24px',\n          color: '#ecf0f1',\n        }\n      ).setOrigin(0.5).setDepth(2002);\n      yOffset += 40;\n    });\n\n    // Continue button\n    const continueText = this.add.text(\n      cam.scrollX + cam.width / 2,\n      cam.scrollY + cam.height / 2 + 200,\n      'Press SPACE to continue',\n      {\n        fontSize: '24px',\n        color: '#FFD700',\n      }\n    ).setOrigin(0.5).setDepth(2002);\n\n    // Pulse animation\n    this.tweens.add({\n      targets: continueText,\n      alpha: { from: 1, to: 0.5 },\n      duration: 800,\n      yoyo: true,\n      repeat: -1,\n    });\n\n    // Wait for space key\n    this.input.keyboard!.once('keydown-SPACE', () => {\n      this.cameras.main.fadeOut(500, 0, 0, 0);\n      this.cameras.main.once('camerafadeoutcomplete', () => {\n        // Return to house scene (or menu if house doesn't exist)\n        if (this.scene.get('HouseScene')) {\n          this.scene.start('HouseScene');\n        } else {\n          this.scene.start('MenuScene');\n        }\n      });\n    });\n  }\n\n  shutdown(): void {\n    // Cleanup\n    if (this.trickSystem) {\n      this.trickSystem.destroy();\n    }\n    this.obstacleSprites.forEach(sprite => sprite.destroy());\n    this.obstacleSprites = [];\n  }\n}\n","import Phaser from 'phaser';\nimport { GameStateManager } from '../utils/GameStateManager';\nimport { UPGRADE_COSTS } from '../types';\n\ninterface UpgradeInfo {\n  key: string;\n  label: string;\n  description: string;\n  icon: string;\n}\n\nconst PERSONAL_UPGRADES: UpgradeInfo[] = [\n  {\n    key: 'rocketSurgery',\n    label: 'Rocket Surgery',\n    description: 'Boosts top speed & acceleration for faster downhill runs.',\n    icon: '',\n  },\n  {\n    key: 'optimalOptics',\n    label: 'Optimal Optics',\n    description: 'Frees focus & boosts fan engagement for easier weaving.',\n    icon: '',\n  },\n  {\n    key: 'sledDurability',\n    label: 'Sled Durability',\n    description: 'Reinforce your sled to withstand bigger impacts.',\n    icon: '',\n  },\n  {\n    key: 'fancierFootwear',\n    label: 'Fancier Footwear',\n    description: 'Less time climbing, more time sledding.',\n    icon: '',\n  },\n  {\n    key: 'attendLegDay',\n    label: 'Attend Leg Day',\n    description: 'Increase your max stamina for longer uphill pushes.',\n    icon: '',\n  },\n  {\n    key: 'crowdHypeman',\n    label: 'Crowd Hypeman',\n    description: 'Perform tricks near fans for boosts.',\n    icon: '',\n  },\n  {\n    key: 'crowdWeaver',\n    label: 'Crowd Weaver',\n    description: 'Crowds move aside more often.',\n    icon: '',\n  },\n  {\n    key: 'weatherWarrior',\n    label: 'Weather Warrior',\n    description: 'Storms & blizzards barely slow you down.',\n    icon: '',\n  },\n];\n\nconst MOUNTAIN_UPGRADES: UpgradeInfo[] = [\n  {\n    key: 'skiLifts',\n    label: 'High-Speed Ski Lift',\n    description: 'Ride lifts faster & attract more visitors.',\n    icon: '',\n  },\n  {\n    key: 'snowmobileRentals',\n    label: 'Snowmobile Rentals',\n    description: 'Rent them out or ride them yourself.',\n    icon: '',\n  },\n  {\n    key: 'foodStalls',\n    label: 'Food Stalls',\n    description: 'Restore stamina and make money.',\n    icon: '',\n  },\n  {\n    key: 'groomedTrails',\n    label: 'Groomed Trails',\n    description: 'Smoothed paths with boosty sections.',\n    icon: '',\n  },\n  {\n    key: 'firstAidStations',\n    label: 'First-Aid Stations',\n    description: 'Heal and reduce collision penalties.',\n    icon: '',\n  },\n  {\n    key: 'scenicOverlooks',\n    label: 'Scenic Overlooks',\n    description: 'Lure tourists or use as shortcuts.',\n    icon: '',\n  },\n];\n\nexport class HouseScene extends Phaser.Scene {\n  private gameStateManager: GameStateManager;\n  private moneyText?: Phaser.GameObjects.Text;\n  private loanText?: Phaser.GameObjects.Text;\n  private staminaText?: Phaser.GameObjects.Text;\n  private tooltipBg?: Phaser.GameObjects.Graphics;\n  private tooltipText?: Phaser.GameObjects.Text;\n  private upgradeElements: Map<string, {\n    button: Phaser.GameObjects.Graphics;\n    zone: Phaser.GameObjects.Zone;\n    levelText: Phaser.GameObjects.Text;\n    costText: Phaser.GameObjects.Text;\n  }> = new Map();\n\n  constructor() {\n    super({ key: 'HouseScene' });\n    this.gameStateManager = GameStateManager.getInstance();\n  }\n\n  create(): void {\n    const { width, height } = this.cameras.main;\n\n    // Fade in\n    this.cameras.main.fadeIn(500, 0, 0, 0);\n\n    // Background\n    const bg = this.add.graphics();\n    bg.fillGradientStyle(0x34495e, 0x34495e, 0x2c3e50, 0x2c3e50, 1);\n    bg.fillRect(0, 0, width, height);\n\n    // Title\n    this.add.text(width / 2, 30, 'Lodge & Upgrades', {\n      fontSize: '42px',\n      color: '#ffffff',\n      fontStyle: 'bold',\n    }).setOrigin(0.5);\n\n    // Stats panel\n    this.createStatsPanel(30, 70);\n\n    // Upgrades sections\n    const scrollStart = 180;\n    this.createUpgradeSection(\n      30,\n      scrollStart,\n      'Personal Upgrades',\n      PERSONAL_UPGRADES,\n      'personal'\n    );\n\n    this.createUpgradeSection(\n      660,\n      scrollStart,\n      'Mountain Upgrades',\n      MOUNTAIN_UPGRADES,\n      'mountain'\n    );\n\n    // Action buttons at bottom\n    this.createActionButtons(width, height);\n\n    // Tooltip (initially hidden)\n    this.tooltipBg = this.add.graphics();\n    this.tooltipBg.setDepth(1000);\n    this.tooltipBg.setVisible(false);\n\n    this.tooltipText = this.add.text(0, 0, '', {\n      fontSize: '14px',\n      color: '#ffffff',\n      wordWrap: { width: 250 },\n      padding: { x: 10, y: 8 },\n    });\n    this.tooltipText.setDepth(1001);\n    this.tooltipText.setVisible(false);\n\n    // Game stats display\n    this.createGameStats(width / 2, height - 130);\n  }\n\n  private createStatsPanel(x: number, y: number): void {\n    const state = this.gameStateManager.getState();\n\n    // Panel background\n    const panelBg = this.add.graphics();\n    panelBg.fillStyle(0x2c3e50, 0.95);\n    panelBg.fillRoundedRect(x, y, 1220, 80, 10);\n    panelBg.lineStyle(2, 0x3498db, 0.8);\n    panelBg.strokeRoundedRect(x, y, 1220, 80, 10);\n\n    // Money\n    this.add.text(x + 20, y + 15, ' Money:', {\n      fontSize: '20px',\n      color: '#f39c12',\n      fontStyle: 'bold',\n    });\n    this.moneyText = this.add.text(x + 20, y + 45, `$${state.money.toFixed(2)}`, {\n      fontSize: '24px',\n      color: '#f1c40f',\n      fontStyle: 'bold',\n    });\n\n    // Loan\n    this.add.text(x + 320, y + 15, ' Loan:', {\n      fontSize: '20px',\n      color: '#e74c3c',\n      fontStyle: 'bold',\n    });\n    this.loanText = this.add.text(x + 320, y + 45, `$${state.loan.toFixed(2)}`, {\n      fontSize: '24px',\n      color: '#c0392b',\n      fontStyle: 'bold',\n    });\n\n    // Stamina\n    this.add.text(x + 620, y + 15, ' Stamina:', {\n      fontSize: '20px',\n      color: '#2ecc71',\n      fontStyle: 'bold',\n    });\n    this.staminaText = this.add.text(\n      x + 620,\n      y + 45,\n      `${state.stamina}/${state.maxStamina}`,\n      {\n        fontSize: '24px',\n        color: '#27ae60',\n        fontStyle: 'bold',\n      }\n    );\n\n    // Day counter\n    this.add.text(x + 920, y + 15, ' Day:', {\n      fontSize: '20px',\n      color: '#9b59b6',\n      fontStyle: 'bold',\n    });\n    this.add.text(x + 920, y + 45, `${state.currentDay}`, {\n      fontSize: '24px',\n      color: '#8e44ad',\n      fontStyle: 'bold',\n    });\n  }\n\n  private createUpgradeSection(\n    x: number,\n    y: number,\n    title: string,\n    upgrades: UpgradeInfo[],\n    category: 'personal' | 'mountain'\n  ): void {\n    // Section title\n    this.add.text(x + 300, y, title, {\n      fontSize: '26px',\n      color: '#ecf0f1',\n      fontStyle: 'bold',\n    }).setOrigin(0.5, 0);\n\n    // Section background\n    const sectionBg = this.add.graphics();\n    sectionBg.fillStyle(0x2c3e50, 0.7);\n    sectionBg.fillRoundedRect(x, y + 35, 600, 420, 10);\n    sectionBg.lineStyle(2, 0x34495e, 1);\n    sectionBg.strokeRoundedRect(x, y + 35, 600, 420, 10);\n\n    // Create upgrade items\n    upgrades.forEach((upgrade, index) => {\n      const itemY = y + 50 + index * 52;\n      this.createUpgradeItem(x + 10, itemY, upgrade, category);\n    });\n  }\n\n  private createUpgradeItem(\n    x: number,\n    y: number,\n    upgrade: UpgradeInfo,\n    category: 'personal' | 'mountain'\n  ): void {\n    const state = this.gameStateManager.getState();\n    const currentLevel = this.gameStateManager.getUpgrade(category, upgrade.key);\n    const costs = (UPGRADE_COSTS[category] as any)[upgrade.key] || [];\n    const maxLevel = costs.length;\n    const cost = currentLevel < maxLevel ? costs[currentLevel] : 0;\n    const canAfford = state.money >= cost;\n    const isMaxLevel = currentLevel >= maxLevel;\n\n    // Item background\n    const itemBg = this.add.graphics();\n    const bgColor = isMaxLevel ? 0x27ae60 : canAfford ? 0x34495e : 0x2c3e50;\n    itemBg.fillStyle(bgColor, 0.8);\n    itemBg.fillRoundedRect(x, y, 580, 45, 6);\n\n    // Icon and name\n    this.add.text(x + 10, y + 12, upgrade.icon, {\n      fontSize: '24px',\n    });\n\n    this.add.text(x + 50, y + 12, upgrade.label, {\n      fontSize: '16px',\n      color: '#ecf0f1',\n      fontStyle: 'bold',\n    });\n\n    // Level indicator\n    const levelText = this.add.text(\n      x + 300,\n      y + 12,\n      `Lv ${currentLevel}/${maxLevel}`,\n      {\n        fontSize: '16px',\n        color: '#95a5a6',\n      }\n    );\n\n    // Cost or Max label\n    const costText = this.add.text(\n      x + 410,\n      y + 12,\n      isMaxLevel ? 'MAX' : `$${cost}`,\n      {\n        fontSize: '16px',\n        color: isMaxLevel ? '#2ecc71' : canAfford ? '#f1c40f' : '#e74c3c',\n        fontStyle: 'bold',\n      }\n    );\n\n    // Buy button\n    if (!isMaxLevel) {\n      const buttonWidth = 80;\n      const buttonHeight = 35;\n      const buttonX = x + 490;\n      const buttonY = y + 5;\n\n      const button = this.add.graphics();\n      const buttonColor = canAfford ? 0x27ae60 : 0x7f8c8d;\n      button.fillStyle(buttonColor, 1);\n      button.fillRoundedRect(buttonX, buttonY, buttonWidth, buttonHeight, 5);\n\n      const buttonText = this.add.text(buttonX + buttonWidth / 2, buttonY + buttonHeight / 2, 'BUY', {\n        fontSize: '14px',\n        color: '#ffffff',\n        fontStyle: 'bold',\n      }).setOrigin(0.5);\n\n      // Make interactive\n      const zone = this.add.zone(buttonX, buttonY, buttonWidth, buttonHeight).setOrigin(0, 0);\n      zone.setInteractive({ useHandCursor: canAfford });\n\n      // Store for updating later\n      this.upgradeElements.set(`${category}_${upgrade.key}`, {\n        button,\n        zone,\n        levelText,\n        costText,\n      });\n\n      if (canAfford) {\n        zone.on('pointerover', () => {\n          button.clear();\n          button.fillStyle(0x2ecc71, 1);\n          button.fillRoundedRect(buttonX, buttonY, buttonWidth, buttonHeight, 5);\n          buttonText.setScale(1.1);\n        });\n\n        zone.on('pointerout', () => {\n          button.clear();\n          button.fillStyle(0x27ae60, 1);\n          button.fillRoundedRect(buttonX, buttonY, buttonWidth, buttonHeight, 5);\n          buttonText.setScale(1);\n        });\n\n        zone.on('pointerdown', () => {\n          this.purchaseUpgrade(category, upgrade.key);\n        });\n      }\n    }\n\n    // Tooltip on hover\n    const tooltipZone = this.add.zone(x, y, 400, 45).setOrigin(0, 0);\n    tooltipZone.setInteractive();\n\n    tooltipZone.on('pointerover', () => {\n      this.showTooltip(upgrade.description, tooltipZone.x + 10, tooltipZone.y + 50);\n    });\n\n    tooltipZone.on('pointerout', () => {\n      this.hideTooltip();\n    });\n  }\n\n  private purchaseUpgrade(category: 'personal' | 'mountain', upgradeKey: string): void {\n    const currentLevel = this.gameStateManager.getUpgrade(category, upgradeKey);\n    const costs = (UPGRADE_COSTS[category] as any)[upgradeKey] || [];\n    const cost = costs[currentLevel];\n\n    if (this.gameStateManager.spendMoney(cost)) {\n      this.gameStateManager.upgradeItem(category, upgradeKey);\n\n      // Update UI\n      this.updateStatsDisplay();\n      this.refreshUpgradeButtons();\n\n      // Flash effect\n      this.cameras.main.flash(200, 46, 204, 113, false);\n    }\n  }\n\n  private updateStatsDisplay(): void {\n    const state = this.gameStateManager.getState();\n    this.moneyText?.setText(`$${state.money.toFixed(2)}`);\n    this.loanText?.setText(`$${state.loan.toFixed(2)}`);\n    this.staminaText?.setText(`${state.stamina}/${state.maxStamina}`);\n  }\n\n  private refreshUpgradeButtons(): void {\n    // Recreate the entire scene to refresh all upgrade buttons\n    // In a production app, you'd want to update individual elements\n    this.scene.restart();\n  }\n\n  private createActionButtons(width: number, height: number): void {\n    const buttonY = height - 55;\n    const state = this.gameStateManager.getState();\n\n    // Pay Loan button\n    const canPayLoan = state.money >= 1000 && state.loan > 0;\n    this.createActionButton(\n      200,\n      buttonY,\n      'Pay Loan ($1000)',\n      canPayLoan ? 0xe74c3c : 0x7f8c8d,\n      canPayLoan,\n      () => this.payLoan()\n    );\n\n    // Start Run button\n    this.createActionButton(\n      width / 2,\n      buttonY,\n      'Start Run ',\n      0x2ecc71,\n      true,\n      () => this.startRun()\n    );\n\n    // Back to Menu button\n    this.createActionButton(\n      width - 200,\n      buttonY,\n      'Back to Menu',\n      0x95a5a6,\n      true,\n      () => this.backToMenu()\n    );\n  }\n\n  private createActionButton(\n    x: number,\n    y: number,\n    text: string,\n    color: number,\n    enabled: boolean,\n    callback: () => void\n  ): void {\n    const buttonWidth = 200;\n    const buttonHeight = 45;\n\n    const button = this.add.graphics();\n    button.fillStyle(color, 1);\n    button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n\n    const buttonText = this.add.text(x, y, text, {\n      fontSize: '18px',\n      color: '#ffffff',\n      fontStyle: 'bold',\n    }).setOrigin(0.5);\n\n    if (enabled) {\n      const zone = this.add.zone(x, y, buttonWidth, buttonHeight);\n      zone.setInteractive({ useHandCursor: true });\n\n      zone.on('pointerover', () => {\n        button.clear();\n        button.fillStyle(color, 0.8);\n        button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n        button.lineStyle(3, 0xffffff, 0.5);\n        button.strokeRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n        buttonText.setScale(1.05);\n      });\n\n      zone.on('pointerout', () => {\n        button.clear();\n        button.fillStyle(color, 1);\n        button.fillRoundedRect(x - buttonWidth / 2, y - buttonHeight / 2, buttonWidth, buttonHeight, 8);\n        buttonText.setScale(1);\n      });\n\n      zone.on('pointerdown', () => {\n        buttonText.setScale(0.95);\n      });\n\n      zone.on('pointerup', () => {\n        buttonText.setScale(1.05);\n        callback();\n      });\n    }\n  }\n\n  private payLoan(): void {\n    if (this.gameStateManager.spendMoney(1000)) {\n      this.gameStateManager.payLoan(1000);\n      this.updateStatsDisplay();\n      this.cameras.main.flash(200, 46, 204, 113, false);\n\n      // Refresh to update button state\n      this.scene.restart();\n    }\n  }\n\n  private startRun(): void {\n    this.cameras.main.fadeOut(300, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('UphillScene');\n    });\n  }\n\n  private backToMenu(): void {\n    this.cameras.main.fadeOut(300, 0, 0, 0);\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('MenuScene');\n    });\n  }\n\n  private createGameStats(x: number, y: number): void {\n    const stats = this.gameStateManager.getStats();\n\n    const statsBg = this.add.graphics();\n    statsBg.fillStyle(0x2c3e50, 0.9);\n    statsBg.fillRoundedRect(x - 350, y, 700, 50, 8);\n\n    const statsText = [\n      `Runs: ${stats.totalRuns}`,\n      `Tricks: ${stats.totalTricks}`,\n      `Photos: ${stats.totalPhotos}`,\n      `Best Time: ${stats.bestTime > 0 ? stats.bestTime.toFixed(1) + 's' : 'N/A'}`,\n      `Peak Alt: ${stats.highestAltitude.toFixed(0)}m`,\n    ].join('  |  ');\n\n    this.add.text(x, y + 25, statsText, {\n      fontSize: '16px',\n      color: '#bdc3c7',\n    }).setOrigin(0.5);\n  }\n\n  private showTooltip(text: string, x: number, y: number): void {\n    if (!this.tooltipBg || !this.tooltipText) return;\n\n    this.tooltipText.setText(text);\n    const bounds = this.tooltipText.getBounds();\n\n    this.tooltipBg.clear();\n    this.tooltipBg.fillStyle(0x2c3e50, 0.95);\n    this.tooltipBg.fillRoundedRect(x - 5, y - 5, bounds.width + 20, bounds.height + 16, 6);\n    this.tooltipBg.lineStyle(2, 0x3498db, 1);\n    this.tooltipBg.strokeRoundedRect(x - 5, y - 5, bounds.width + 20, bounds.height + 16, 6);\n\n    this.tooltipText.setPosition(x + 5, y + 3);\n    this.tooltipBg.setVisible(true);\n    this.tooltipText.setVisible(true);\n  }\n\n  private hideTooltip(): void {\n    this.tooltipBg?.setVisible(false);\n    this.tooltipText?.setVisible(false);\n  }\n}\n","import Phaser from 'phaser';\nimport { BootScene } from './scenes/BootScene';\nimport { MenuScene } from './scenes/MenuScene';\nimport { TutorialScene } from './scenes/TutorialScene';\nimport { UphillScene } from './scenes/UphillScene';\nimport { DownhillScene } from './scenes/DownhillScene';\nimport { HouseScene } from './scenes/HouseScene';\n\nconst config: Phaser.Types.Core.GameConfig = {\n  type: Phaser.AUTO,\n  width: 1280,\n  height: 720,\n  parent: 'game-container',\n  backgroundColor: '#2d3436',\n  physics: {\n    default: 'arcade',\n    arcade: {\n      gravity: { x: 0, y: 0 },\n      debug: false,\n    },\n  },\n  scene: [\n    BootScene,\n    MenuScene,\n    TutorialScene,\n    UphillScene,\n    DownhillScene,\n    HouseScene,\n  ],\n  pixelArt: true,\n  antialias: false,\n  scale: {\n    mode: Phaser.Scale.FIT,\n    autoCenter: Phaser.Scale.CENTER_BOTH,\n  },\n};\n\nconst game = new Phaser.Game(config);\n\nexport default game;\n"],"names":["ProceduralArt","scene","key","graphics","i","angle","sledOffset","shade","brightness","snowColor","Phaser","x","y","sparkleColor","iceGraphics","iceColor","rockGraphics","rampGraphics","variant","layers","size","bearGraphics","birdGraphics","lionGraphics","deerGraphics","foxGraphics","staminaBgGraphics","staminaFillGraphics","reticleGraphics","grandpaGraphics","jakeGraphics","steveGraphics","BootScene","loadingText","progressBar","progressBox","value","title","_GameStateManager","__publicField","newState","amount","category","name","current","stat","seed","ngpBonuses","v","bonusChoice","e","saved","loaded","GameStateManager","MenuScene","width","height","state","bg","seedBox","seedText","inputBoxBg","inputHint","inputZone","_a","event","_b","_c","buttonY","buttonSpacing","hasSavedGame","text","color","callback","button","buttonText","zone","TutorialScene","percent","localPercent","colorObj","yellowColor","white","hillPoints","centerDistance","hillHeight","point","nextPoint","minY","pos","tree","nameLabel","message","velocityX","velocityY","MountainGenerator","layer","seedNum","n","str","hash","circumference","layerIndex","terrain","row","tile","rand","altitude","iceChance","rockChance","type","colorVariant","j","treeCount","rockCount","index","currentLayer","tileSize","tileX","tileY","wrappedX","currentX","currentY","newLayer","oldLayer","targetLayer","scaleFactor","newX","newY","UphillScene","staminaBg","obs","ty","tx","worldX","worldY","tileKey","tileSprite","centerX","centerY","targetX","targetY","_delta","moving","dx","dy","staminaMultiplier","ngpBonus","finalDrain","delay","types","rarities","rarity","distance","offsetX","offsetY","animal","sprite","moveAngle","reticleRadius","bestMatch","screenX","screenY","centeringScore","targetAltitude","altitudeDiff","altitudeScore","movementBonus","rarityBonus","totalScore","baseValue","rarityMultiplier","scoreMultiplier","timesPhotographed","repeatPenalty","earnings","quality","barWidth","barHeight","barX","barY","fillWidth","penalty","messageText","stats","time","delta","TRICKS","UPGRADE_COSTS","TrickSystem","direction","currentTime","trick","trickInput","queueInput","feedback","completed","DownhillScene","gameState","durabilityLevel","_time","currentLayerData","slopeAcceleration","speedBonus","rotation","legLevel","_tile","trickFeedback","hypeLevel","finalEarnings","damage","originalColor","gate","timeBonus","cam","visibleArea","startX","endX","startY","endY","obstacle","mph","seconds","durabilityPercent","barColor","yOffset","continueText","PERSONAL_UPGRADES","MOUNTAIN_UPGRADES","HouseScene","scrollStart","panelBg","upgrades","sectionBg","upgrade","itemY","currentLevel","costs","maxLevel","cost","canAfford","isMaxLevel","itemBg","bgColor","levelText","costText","buttonX","buttonColor","tooltipZone","upgradeKey","canPayLoan","enabled","statsBg","statsText","bounds","config"],"mappings":"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"}